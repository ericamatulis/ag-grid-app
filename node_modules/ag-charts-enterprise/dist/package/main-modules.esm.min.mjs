var PS=Object.defineProperty,ES=Object.getOwnPropertyDescriptor,h=(e,t,i,o)=>{for(var s=o>1?void 0:o?ES(t,i):t,a=e.length-1,n;a>=0;a--)(n=e[a])&&(s=(o?n(t,i,s):n(s))||s);return o&&s&&PS(t,i,s),s};import{_ModuleSupport as wS}from"ag-charts-community";import{_ModuleSupport as _S}from"ag-charts-community";import{arrayOfDefs as Qs,boolean as Tp,callback as Ip,constant as Qo,date as BS,fontOptionsDef as Mp,number as Et,or as GS,positiveNumber as Lp,ratio as wt,required as es,string as cr,union as ea}from"ag-charts-core";import{_ModuleSupport as FS}from"ag-charts-community";import{isNumberEqual as Cp}from"ag-charts-core";function pr(e,t,i){const o=(a,n,r,l)=>{let c=e[0];for(let p=a;r>0?p<=n:p>n;p+=r){const d=e[p];if(l(c,d))return!0;c=d}return!1},s=Math.floor(e.length/2);return o(t,s,t,i)?!0:o(e.length-t,s,-t,i)}import{_ModuleSupport as VS}from"ag-charts-community";var{OR:WS,POSITIVE_NUMBER:KS,NAN:zS,AxisInterval:$S,TempValidate:HS}=VS,hr=class extends $S{};h([HS(WS(KS,zS))],hr.prototype,"minSpacing",2);import{_ModuleSupport as dr}from"ag-charts-community";import{countFractionDigits as YS,isNumberEqual as vo}from"ag-charts-core";import{_ModuleSupport as Pp}from"ag-charts-community";import{isArray as XS,isNumberEqual as Ep}from"ag-charts-core";import{_ModuleSupport as US}from"ag-charts-community";var{BaseProperties:wp,ChartAxisDirection:qS,ARRAY:jS,BOOLEAN:ur,COLOR_STRING:fr,FONT_STYLE:JS,FONT_WEIGHT:ZS,LINE_DASH:QS,NUMBER:_p,OBJECT:eb,POSITIVE_NUMBER:tb,RATIO:Bp,STRING:Gp,UNION:Fp,AND:ib,COLOR_STRING_ARRAY:ob,TempValidate:Re,MATCHING_CROSSLINE_TYPE:Vp,createId:sb,Group:gr}=US,_t=class extends wp{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};h([Re(ur,{optional:!0})],_t.prototype,"enabled",2),h([Re(Gp,{optional:!0})],_t.prototype,"text",2),h([Re(JS,{optional:!0})],_t.prototype,"fontStyle",2),h([Re(ZS,{optional:!0})],_t.prototype,"fontWeight",2),h([Re(tb)],_t.prototype,"fontSize",2),h([Re(Gp)],_t.prototype,"fontFamily",2),h([Re(_p)],_t.prototype,"padding",2),h([Re(fr,{optional:!0})],_t.prototype,"color",2),h([Re(ur,{optional:!0})],_t.prototype,"parallel",2);var et=class extends wp{constructor(){super(...arguments),this.id=sb(this),this.defaultColorRange=[],this.shape="polygon",this.label=new _t,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction=qS.X,this.axisInnerRadius=0,this.axisOuterRadius=0,this.lineGroup=new gr({name:this.id}),this.rangeGroup=new gr({name:this.id}),this.labelGroup=new gr({name:this.id}),this._isRange=void 0}assignCrossLineGroup(e,t){e!==this._isRange&&(e?this.rangeGroup.appendChild(t):this.lineGroup.appendChild(t)),this._isRange=e}setSectorNodeProps(e){e.fill=this.fill,e.fillOpacity=this.fillOpacity??1,e.stroke=this.stroke,e.strokeOpacity=this.strokeOpacity??1,e.strokeWidth=this.strokeWidth??1,e.lineDash=this.lineDash}setLabelNodeProps(e,t,i,o,s){const{label:a}=this;e.x=t,e.y=i,e.text=a.text,e.textAlign="center",e.textBaseline=o,e.rotation=s,e.rotationCenterX=t,e.rotationCenterY=i,e.fill=a.color,e.fontFamily=a.fontFamily,e.fontSize=a.fontSize,e.fontStyle=a.fontStyle,e.visible=!0}};h([Re(ur,{optional:!0})],et.prototype,"enabled",2),h([Re(Fp(["range","line"],"a crossLine type"))],et.prototype,"type",2),h([Re(ib(Vp("range"),jS.restrict({length:2})),{optional:!0})],et.prototype,"range",2),h([Re(Vp("value"),{optional:!0})],et.prototype,"value",2),h([Re(ob)],et.prototype,"defaultColorRange",2),h([Re(fr,{optional:!0})],et.prototype,"fill",2),h([Re(Bp,{optional:!0})],et.prototype,"fillOpacity",2),h([Re(fr,{optional:!0})],et.prototype,"stroke",2),h([Re(_p,{optional:!0})],et.prototype,"strokeWidth",2),h([Re(Bp,{optional:!0})],et.prototype,"strokeOpacity",2),h([Re(QS,{optional:!0})],et.prototype,"lineDash",2),h([Re(Fp(["polygon","circle"],"a shape"))],et.prototype,"shape",2),h([Re(eb)],et.prototype,"label",2);var{ChartAxisDirection:ab,getCrossLineValue:Wp,validateCrossLineValue:nb,normalizeAngle360:yr,Group:rb,Path:Kp,Sector:lb,RotatableText:cb,ContinuousScale:pb}=Pp,mr=class extends et{constructor(){super(),this.direction=ab.X,this.polygonNode=new Kp,this.sectorNode=new lb,this.lineNode=new Kp,this.crossLineRange=new rb,this.labelNode=new cb,this.ticks=[],this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.crossLineRange.append(this.lineNode),this.labelGroup.append(this.labelNode)}visibilityCheck(){if(!pb.is(this.scale))return!0;const[e,t]=this.scale.domain,i=Wp(this);if(XS(i)){const[o,s]=i;return o>=e&&o<=t&&s>=o&&s<=t}else return i>=e&&i<=t}update(e){const{scale:t}=this;if(!t||!this.isValid()||!nb(Wp(this),t)||!this.visibilityCheck()){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updateLineNode(e),this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e)}updateLineNode(e){const{scale:t,type:i,value:o,lineNode:s}=this;if(!e||i!=="line"||!t){s.visible=!1;return}const a=t.convert(o);if(isNaN(a)){s.visible=!1;return}const{axisInnerRadius:n,axisOuterRadius:r}=this;s.visible=!0,s.stroke=this.stroke,s.strokeOpacity=this.strokeOpacity??1,s.strokeWidth=this.strokeWidth??1,s.fill=void 0,s.lineDash=this.lineDash;const l=r*Math.cos(a),c=r*Math.sin(a),p=n*Math.cos(a),d=n*Math.sin(a);s.path.clear(!0),s.path.moveTo(p,d),s.path.lineTo(l,c),this.assignCrossLineGroup(!1,this.crossLineRange)}updatePolygonNode(e){const{polygonNode:t,range:i,scale:o,shape:s,type:a,ticks:n}=this;if(!e||a!=="range"||s!=="polygon"||!o||!i){t.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:l}=this,c=n.indexOf(i[0]),p=n.indexOf(i[1]),u=(c<=p?n.slice(c,p+1):n.slice(c).concat(n.slice(0,p+1))).map(y=>o.convert(y));t.visible=!0,this.setSectorNodeProps(t);const{path:f}=t;f.clear(!0),u.forEach((y,g)=>{const m=l*Math.cos(y),S=l*Math.sin(y);g===0?f.moveTo(m,S):f.lineTo(m,S)}),r===0?f.lineTo(0,0):u.slice().reverse().forEach(y=>{const g=r*Math.cos(y),m=r*Math.sin(y);f.lineTo(g,m)}),t.path.closePath(),this.assignCrossLineGroup(!0,this.crossLineRange)}updateSectorNode(e){const{sectorNode:t,range:i,scale:o,shape:s,type:a}=this;if(!e||a!=="range"||s!=="circle"||!o||!i){t.visible=!1;return}const{axisInnerRadius:n,axisOuterRadius:r}=this,l=i.map(d=>o.convert(d)),c=o.step??0,p=o instanceof Pp.BandScale?c/2:0;t.visible=!0,this.setSectorNodeProps(t),t.centerX=0,t.centerY=0,t.innerRadius=n,t.outerRadius=r,t.startAngle=l[0]-p,t.endAngle=l[1]+p,this.assignCrossLineGroup(!0,this.crossLineRange)}updateLabelNode(e){const{label:t,labelNode:i,range:o,scale:s,type:a,ticks:n}=this;if(!e||t.enabled===!1||!t.text||!s||a==="range"&&!o){i.visible=!1;return}i.visible=!0;const{axisInnerRadius:r,axisOuterRadius:l}=this;let c,p,d,u;if(a==="line"){const f=yr(s.convert(this.value)),y=1.5*Math.PI,g=Ep(f,y)||f>y||f<Math.PI/2,m=(r+l)/2*Math.cos(f),S=(r+l)/2*Math.sin(f);c=m+t.padding*Math.cos(f+Math.PI/2),p=S+t.padding*Math.sin(f+Math.PI/2),u=g?"top":"bottom",d=g?f:f-Math.PI}else{const[f,y]=o.map(D=>yr(s.convert(D)));let g=(f+y)/2;f>y&&(g-=Math.PI),g=yr(g);const m=(Ep(g,0)||g>0)&&g<Math.PI;let S;this.shape==="circle"||n.length<3?S=l-t.padding:S=l*Math.cos(Math.PI/n.length)-t.padding,c=S*Math.cos(g),p=S*Math.sin(g),u=m?"bottom":"top",d=m?g-Math.PI/2:g+Math.PI/2}this.setLabelNodeProps(i,c,p,u,d)}};mr.className="AngleCrossLine";var{ChartAxisDirection:hb,NUMBER:zp,UNION:db,ProxyOnWrite:ub,TextWrapper:fb,TextUtils:gb,TempValidate:Sr,toRadians:ta,normalizeAngle360:Oo,normalizeAngle360Inclusive:yb,Path:mb,RotatableText:Sb,Transformable:bb,BBox:Db}=dr,br=class extends dr.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};h([Sr(db(["fixed","parallel","perpendicular"],"a label orientation"))],br.prototype,"orientation",2);var ts=class extends dr.PolarAxis{constructor(e,t){super(e,t),this.startAngle=0,this.endAngle=void 0,this.labelData=[],this.tickData=[],this.radiusLine=this.axisGroup.appendChild(new mb),this.includeInvisibleDomains=!0}get direction(){return hb.X}createLabel(){return new br}calculateTickLayout(e){const{nice:t,scale:i}=this,o={nice:t,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0},s=t?i.niceDomain(o,e):e,a=this.generateAngleTicks(s);this.tickData=a;const n=a.map(l=>l.value),r=n.reduce((l,c)=>Math.max(typeof c=="number"?YS(c):0,l),0);return{niceDomain:s,primaryTickCount:void 0,tickDomain:s,ticks:n,fractionDigits:r,bbox:this.getBBox()}}update(){super.update(),this.updateRadiusLine()}normalizedAngles(){const e=Oo(-Math.PI/2+ta(this.startAngle)),t=this.endAngle!=null?yb(ta(this.endAngle)-ta(this.startAngle)):2*Math.PI,i=e+t;return[e,i]}computeRange(){this.range=this.normalizedAngles()}updateSelections(){const e=this.tickData;this.gridLineGroupSelection.update(this.gridLength&&this.gridLine.enabled?e:[]),this.tickLineGroupSelection.update(this.tick.enabled?e:[]),this.tickLabelGroupSelection.update(this.label.enabled?e:[]),this.gridLineGroupSelection.cleanup(),this.tickLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup()}updatePosition(){const{translation:e,axisGroup:t,gridGroup:i,crossLineRangeGroup:o,crossLineLineGroup:s,crossLineLabelGroup:a}=this,n=Math.floor(e.x),r=Math.floor(e.y);t.translationX=n,t.translationY=r,i.translationX=n,i.translationY=r,o.translationX=n,o.translationY=r,s.translationX=n,s.translationY=r,a.translationX=n,a.translationY=r}updateRadiusLine(){const e=this.radiusLine,{path:t}=e;t.clear(!0);const{points:i,closePath:o}=this.getAxisLinePoints();i.forEach(({x:s,y:a,moveTo:n,arc:r,radius:l=0,startAngle:c=0,endAngle:p=0})=>{r?t.arc(s,a,l,c,p):n?t.moveTo(s,a):t.lineTo(s,a)}),o&&t.closePath(),e.visible=this.line.enabled,e.stroke=this.line.stroke,e.strokeWidth=this.line.width,e.fill=void 0}getAxisLinePoints(){const{scale:e,shape:t,gridLength:i}=this,[o,s]=this.range,a=vo(s-o,2*Math.PI),n=[];if(t==="circle")a?n.push({x:i,y:0,moveTo:!0},{x:0,y:0,radius:i,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1}):n.push({x:i*Math.cos(o),y:i*Math.sin(o),moveTo:!0},{x:0,y:0,radius:i,startAngle:Oo(o),endAngle:Oo(s),arc:!0,moveTo:!1});else if(t==="polygon"){const r=e.ticks({nice:this.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.map(l=>e.convert(l));r&&r.length>2&&r.forEach((l,c)=>{const p=i*Math.cos(l),d=i*Math.sin(l),u=c===0;n.push({x:p,y:d,moveTo:u})})}return{points:n,closePath:a}}updateGridLines(){const{scale:e,gridLength:t,gridLine:{style:i,width:o},innerRadiusRatio:s}=this;if(!(i&&t>0))return;const a=t*s,n=i.length;this.gridLineGroupSelection.each((r,l,c)=>{const{value:p}=l,{stroke:d,lineDash:u}=i[c%n],f=e.convert(p);r.x1=a*Math.cos(f),r.y1=a*Math.sin(f),r.x2=t*Math.cos(f),r.y2=t*Math.sin(f),r.stroke=d,r.strokeWidth=o,r.lineDash=u,r.fill=void 0}),this.gridLineGroupSelection.cleanup()}updateLabels(){const{label:e,tickLabelGroupSelection:t}=this;t.each((i,o,s)=>{const a=this.labelData[s];if(!a||a.hidden){i.visible=!1;return}i.text=a.text,i.setFont(e),i.fill=e.color,i.x=a.x,i.y=a.y,i.textAlign=a.textAlign,i.textBaseline=a.textBaseline,i.visible=!0,a.rotation?(i.rotation=a.rotation,i.rotationCenterX=a.x,i.rotationCenterY=a.y):i.rotation=0})}updateTickLines(){const{scale:e,gridLength:t,tick:i,tickLineGroupSelection:o}=this;o.each((s,a)=>{const{value:n}=a,r=e.convert(n),l=Math.cos(r),c=Math.sin(r);s.x1=t*l,s.y1=t*c,s.x2=(t+i.size)*l,s.y2=(t+i.size)*c,s.stroke=i.stroke,s.strokeWidth=i.width})}createLabelNodeData(e,t,i){const{label:o,gridLength:s,scale:a,tick:n}=this;if(!o.enabled)return[];const r=new Sb,l=i.x-this.translation.x,c=i.x+i.width-this.translation.x,p=e.map((d,u)=>{const{value:f}=d,y=s+o.spacing+n.size,g=a.convert(f),m=Math.cos(g),S=Math.sin(g),D=y*m,b=y*S,{textAlign:v,textBaseline:R}=this.getLabelAlign(g),T=u===e.length-1&&f!==e[0]&&vo(Oo(g),Oo(a.convert(e[0]))),O=this.getLabelRotation(g);let x=this.formatTick(f,u,a.domain);r.text=x,r.x=D,r.y=b,r.setFont(o),r.textAlign=v,r.textBaseline=R,r.rotation=O,O&&(r.rotationCenterX=D,r.rotationCenterY=b);let A=O?bb.toCanvas(r):r.getBBox();if(A&&t.hideWhenNecessary&&!O){const k=l-A.x,I=A.x+A.width-c,N=1;if(k>N||I>N){const L=A.width-Math.max(k,I);x=fb.wrapText(x,{maxWidth:L,font:o,textWrap:"never"}),x===gb.EllipsisChar&&(x=""),r.text=x,A=r.getBBox()}}return{text:x,x:D,y:b,textAlign:v,textBaseline:R,hidden:x===""||d.hidden||T,rotation:O,box:A}});return o.avoidCollisions&&this.avoidLabelCollisions(p),p}computeLabelsBBox(e,t){this.labelData=this.createLabelNodeData(this.tickData,e,t);const i=this.labelData.map(({box:o})=>o).filter(o=>o!=null);return!this.label.enabled||i.length===0?null:Db.merge(i)}getLabelOrientation(){const{label:e}=this;return e instanceof br?e.orientation:"fixed"}getLabelRotation(e){let t=ta(this.label.rotation??0);e=Oo(e);const i=this.getLabelOrientation();return i==="parallel"?(t+=e,e>=0&&e<Math.PI?t-=Math.PI/2:t+=Math.PI/2):i==="perpendicular"&&(t+=e,e>=Math.PI/2&&e<1.5*Math.PI&&(t+=Math.PI)),t}getLabelAlign(e){const t=Math.cos(e),i=Math.sin(e);let o,s;const a=this.getLabelOrientation(),n=vo(t,0),r=vo(i,0),l=vo(t,1),c=vo(i,-1),p=t>0&&!n,d=i>0&&!r;return a==="parallel"?(o="center",s=l&&r||d?"top":"bottom"):a==="perpendicular"?(o=c||p?"left":"right",s="middle"):(o="right",n?o="center":p&&(o="left"),s="bottom",r?s="middle":d&&(s="top")),{textAlign:o,textBaseline:s}}updateCrossLines(){const{shape:e,gridLength:t,innerRadiusRatio:i}=this;this.crossLines.forEach(o=>{o instanceof mr&&(o.ticks=this.tickData.map(s=>s.value),o.shape=e,o.axisOuterRadius=t,o.axisInnerRadius=t*i)}),super.updateCrossLines()}};ts.CrossLineConstructor=mr,h([ub("rotation"),Sr(zp)],ts.prototype,"startAngle",2),h([Sr(zp,{optional:!0})],ts.prototype,"endAngle",2);var{RATIO:$p,OBJECT:xb,TempValidate:Dr,CategoryScale:vb}=FS,Wi=class extends ts{constructor(e){super(e,new vb),this.groupPaddingInner=0,this.paddingInner=0,this.interval=new hr}generateAngleTicks(){const{scale:e,gridLength:t}=this,{values:i,minSpacing:o}=this.interval,s=i??e.ticks({nice:this.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})??[];if(s.length<2||o==null)return s.map(c=>({value:c,visible:!0}));const a=s[0],n=e.convert(a),r=t*Math.cos(n),l=t*Math.sin(n);for(let c=1;c<s.length-1;c++){const p=s[c],d=e.convert(p);if(d-n>Math.PI)break;const u=t*Math.cos(d),f=t*Math.sin(d);if(Math.sqrt((u-r)**2+(f-l)**2)>o){const g=new Set([a]);return pr(s,c,(m,S)=>{g.add(S)}),s.map(m=>{const S=g.has(m);return{value:m,visible:S}})}}return[{value:a,visible:!0}]}avoidLabelCollisions(e){const{minSpacing:t}=this.label;if(e.length<3)return;const i=(l,c)=>{if(l.hidden||c.hidden)return!1;if(t==null)return l.box.collidesBBox(c.box);const p=l.box.clone().grow(t/2),d=c.box.clone().grow(t/2);return p.collidesBBox(d)},o=e[0],s=e.at(-1),a=new Set([o]),n=Cp(o.x,s.x)&&Cp(o.y,s.y),r=Math.floor(e.length/2);for(let l=1;l<=r;l++){const c=n?e.slice(0,-1):e;if(!pr(c,l,i)){pr(c,l,(d,u)=>{a.add(u)});break}}e.forEach(l=>{a.has(l)||(l.hidden=!0,l.box=void 0)})}};Wi.className="AngleCategoryAxis",Wi.type="angle-category",h([Dr($p)],Wi.prototype,"groupPaddingInner",2),h([Dr($p)],Wi.prototype,"paddingInner",2),h([Dr(xb)],Wi.prototype,"interval",2);import{_ModuleSupport as Ob}from"ag-charts-community";import{isNumberEqual as Hp}from"ag-charts-core";import{_ModuleSupport as kb}from"ag-charts-community";import{isNumberEqual as Rb}from"ag-charts-core";var{range:Yp,isDenseInterval:Nb,LinearScale:xr}=kb,Xp=class Ap extends xr{constructor(){super(...arguments),this.arcLength=0}static getNiceStepAndTickCount(t,i){const[o,s]=i;let a=xr.getTickStep(o,s,t);const n=isNaN(t.maxTickCount)?1/0:t.maxTickCount,r=Math.abs(s-o)/a;let l=Math.pow(2,Math.ceil(Math.log(r)/Math.log(2)));return l>n&&(l/=2,a*=2),{count:l,step:a}}ticks(t,i=this.domain){const{arcLength:o}=this;if(!i||i.length<2||i.some(c=>!isFinite(c))||o<=0)return[];const{nice:s,interval:a}=t,[n,r]=i;if(a){const c=Math.abs(a),p=this.getPixelRange();if(!Nb((r-n)/c,p))return Yp(n,r,c)}let l;if(s&&this.hasNiceRange()){const c=super.niceDomain(t,i);l=Ap.getNiceStepAndTickCount(t,c).step}else l=xr.getTickStep(n,r,t);return Yp(n,r,l)}hasNiceRange(){const t=this.range.slice().sort((o,s)=>o-s);return[Math.PI,2*Math.PI].some(o=>Rb(o,t[1]-t[0]))}niceDomain(t,i=this.domain){const o=super.niceDomain(t,i);if(!this.hasNiceRange())return o;const s=o[0]>o[1],a=s?o[1]:o[0],{step:n,count:r}=Ap.getNiceStepAndTickCount(t,o),l=1/n,c=n>=1?Math.ceil(a/n+r)*n:Math.ceil((a+r*n)*l)/l;return s?[c,a]:[a,c]}getPixelRange(){return this.arcLength}},{AND:Up,GREATER_THAN:Ab,LESS_THAN:Tb,NUMBER_OR_NAN:qp,OBJECT:Ib,TempValidate:vr,angleBetween:Mb,normalisedExtentWithMetadata:Lb,findMinMax:Cb}=Ob,ko=class extends ts{constructor(e){super(e,new Xp),this.shape="circle",this.interval=new hr}normaliseDataDomain(e){const{min:t,max:i}=this,{extent:o,clipped:s}=Lb(e,t,i);return{domain:o,clipped:s}}updateScale(){super.updateScale(),this.scale.arcLength=this.getRangeArcLength()}getRangeArcLength(){const{range:e}=this,t=Math.min(...e),i=Math.max(...e),o=Mb(t,i)||2*Math.PI,s=this.gridLength;return o*s}generateAngleTicks(e){const{scale:t,range:i,nice:o}=this,{values:s,step:a,minSpacing:n,maxSpacing:r}=this.interval;let l;if(s==null){const{arcLength:c}=t,p=r?Math.floor(c/r):1,d=n?Math.floor(c/n):1/0,u=Math.floor(4/Math.PI*Math.abs(i[0]-i[1])),f=Math.max(p,Math.min(d,u)),y={nice:o,interval:a,tickCount:f,minTickCount:p,maxTickCount:d};l=t.ticks(y,e)}else{const[c,p]=Cb(e.map(Number));l=s.filter(d=>d>=c&&d<=p).sort((d,u)=>d-u)}return l.map(c=>({value:c,visible:!0}))}avoidLabelCollisions(e){const{minSpacing:t}=this.label,i=(a,n)=>{if(a.hidden||n.hidden)return!1;if(t==null)return a.box.collidesBBox(n.box);const r=a.box.clone().grow(t/2),l=n.box.clone().grow(t/2);return r.collidesBBox(l)},o=e[0],s=e.at(-1);o!==s&&Hp(o.x,s.x)&&Hp(o.y,s.y)&&(s.hidden=!0);for(let a=1;a<e.length;a*=2){let n=!1;for(let r=a;r<e.length;r+=a){const l=e[r],c=e[r-a];if(i(c,l)){n=!0;break}}if(!n){e.forEach((r,l)=>{l%a>0&&(r.hidden=!0,r.box=void 0)});return}}e.forEach((a,n)=>{n>0&&(a.hidden=!0,a.box=void 0)})}};ko.className="AngleNumberAxis",ko.type="angle-number",h([vr(Up(qp,Tb("max")),{optional:!0})],ko.prototype,"min",2),h([vr(Up(qp,Ab("min")),{optional:!0})],ko.prototype,"max",2),h([vr(Ib)],ko.prototype,"interval",2);import{_ModuleSupport as jp}from"ag-charts-community";var{OrdinalTimeScale:Pb}=jp,Or=class extends jp.CategoryAxis{constructor(e){super(e,new Pb)}};Or.className="OrdinalTimeAxis",Or.type="ordinal-time";import{_ModuleSupport as Eb}from"ag-charts-community";import{_ModuleSupport as ia}from"ag-charts-community";import{isNumberEqual as wb}from"ag-charts-core";import{_ModuleSupport as Jp}from"ag-charts-community";import{clamp as Zp,isNumberEqual as _b}from"ag-charts-core";var{ChartAxisDirection:Bb,TempValidate:Gb,NUMBER:Fb,getCrossLineValue:Vb,validateCrossLineValue:Wb,normalizeAngle360:Kb,toRadians:zb,Group:$b,Path:Hb,Sector:Yb,RotatableText:Xb}=Jp,Qp=class extends _t{constructor(){super(...arguments),this.positionAngle=void 0}};h([Gb(Fb,{optional:!0})],Qp.prototype,"positionAngle",2);var kr=class extends et{constructor(){super(),this.direction=Bb.Y,this.label=new Qp,this.polygonNode=new Hb,this.sectorNode=new Yb,this.crossLineRange=new $b,this.labelNode=new Xb,this.outerRadius=0,this.innerRadius=0,this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(e){const{scale:t}=this;if(!t||!this.isValid()||!Wb(Vb(this),t)){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.updateRadii();const{innerRadius:i,outerRadius:o}=this;e&&(e=i>=this.axisInnerRadius&&o<=this.axisOuterRadius),this.rangeGroup.visible=e,this.lineGroup.visible=e,this.labelGroup.visible=e,this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e),this.assignCrossLineGroup(this.type==="range",this.crossLineRange)}updateRadii(){const{range:e,scale:t,type:i,axisInnerRadius:o,axisOuterRadius:s}=this;if(!t)return{innerRadius:0,outerRadius:0};const a=l=>s+o-l;let n,r;if(i==="line")n=a(t.convert(this.value)),r=n;else{const l=Math.abs(t?.bandwidth??0),c=e.map(p=>t.convert(p));n=a(Math.max(...c)),r=a(Math.min(...c))+l}this.outerRadius=n,this.innerRadius=r}drawPolygon(e,t,i){t.forEach((o,s)=>{const a=e*Math.cos(o),n=e*Math.sin(o);s===0?i.path.moveTo(a,n):i.path.lineTo(a,n)}),i.path.closePath()}updatePolygonNode(e){const{gridAngles:t,polygonNode:i,scale:o,shape:s,type:a,innerRadius:n,outerRadius:r}=this;if(!e||s!=="polygon"||!o||!t){i.visible=!1;return}i.visible=!0;const l=this.getPadding();i.path.clear(!0),this.drawPolygon(r-l,t,i);const c=t.slice().reverse(),p=a==="line"?r-l:n+l;this.drawPolygon(p,c,i),this.setSectorNodeProps(i)}updateSectorNode(e){const{axisInnerRadius:t,axisOuterRadius:i,scale:o,sectorNode:s,shape:a,innerRadius:n,outerRadius:r}=this;if(!e||a!=="circle"||!o){s.visible=!1;return}s.visible=!0,s.startAngle=0,s.endAngle=2*Math.PI;const l=this.getPadding(),c=Zp(t,n+l,i),p=Zp(t,r-l,i);s.innerRadius=Math.min(c,p),s.outerRadius=Math.max(c,p),this.setSectorNodeProps(s)}updateLabelNode(e){const{innerRadius:t,label:i,labelNode:o,scale:s,shape:a,type:n}=this;if(!e||i.enabled===!1||!i.text||!s){o.visible=!1;return}const r=Kb(zb((i.positionAngle??0)-90)),l=(_b(r,0)||r>0)&&r<Math.PI,c=l?r-Math.PI/2:r+Math.PI/2;let p;const d=this.gridAngles??[];n==="line"?p=t+i.padding:a==="circle"||d.length<3?p=t-i.padding:p=t*Math.cos(Math.PI/d.length)-i.padding;const u=p*Math.cos(r),f=p*Math.sin(r);let y;n==="line"?y=l?"top":"bottom":y=l?"bottom":"top",this.setLabelNodeProps(o,u,f,y,c)}getPadding(){const{scale:e}=this;if(!e)return 0;const t=Math.abs(e.bandwidth??0),i=Math.abs(e.step??0);return e instanceof Jp.BandScale?(i-t)/2:0}};kr.className="RadiusCrossLine";var{ChartAxisDirection:Ub,ZIndexMap:qb,NUMBER:eh,BOOLEAN:jb,TempValidate:Rr,normalizeAngle360:th,toRadians:Jb,Caption:Zb,Group:Qb,Path:eD,Line:tD,Selection:iD,AxisTickGenerator:oD,AxisGroupZIndexMap:sD}=ia,Nr=class extends ia.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};h([Rr(jb,{optional:!0})],Nr.prototype,"autoRotate",2),h([Rr(eh)],Nr.prototype,"autoRotateAngle",2);var oa=class extends ia.PolarAxis{constructor(e,t){super(e,t),this.positionAngle=0,this.tickGenerator=new oD(this),this.generatedTicks=void 0,this.lineNode=this.axisGroup.appendChild(new tD({name:`${this.id}-Axis-line`,zIndex:sD.AxisLine})),this.gridPathGroup=this.gridGroup.appendChild(new Qb({name:`${this.id}-gridPaths`,zIndex:qb.AXIS_GRID})),this.gridPathSelection=iD.select(this.gridPathGroup,eD),this.axisGroup.appendChild(this.title.caption.node),this.destroyFns.push(this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}get direction(){return Ub.Y}getAxisTransform(){const e=this.scale.range[0],{translation:t,positionAngle:i,innerRadiusRatio:o}=this,s=e*o,a=Jb(i);return{translationX:t.x,translationY:t.y-e-s,rotation:a,rotationCenterX:0,rotationCenterY:e+s}}update(){super.update(),this.updateTitle();const{enabled:e,stroke:t,width:i}=this.line;this.lineNode.setProperties({stroke:t,strokeWidth:e?i:0,x1:0,y1:this.range[0],x2:0,y2:this.range[1]})}calculateTickLayout(e,t,i,o){const{parallelFlipRotation:s,regularFlipRotation:a}=this.calculateRotations(),n=[0,1],r=this.label.getSideFlag(),l=r*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding),c=this.tickGenerator.generateTicks({domain:e,niceMode:t,visibleRange:n,primaryTickCount:o,parallelFlipRotation:s,regularFlipRotation:a,labelX:l,sideFlag:r}),{tickData:p,primaryTickCount:d=o}=c,{ticks:u,rawTicks:f,tickDomain:y,fractionDigits:g,niceDomain:m=e}=p,S=u.map(D=>this.getTickLabelProps(D,c));return this.generatedTicks={ticks:u,labels:S},{ticks:f,tickDomain:y,niceDomain:m,primaryTickCount:d,fractionDigits:g}}updateSelections(){const{generatedTicks:e}=this;if(!e)return;const{ticks:t,labels:i}=e;this.gridLineGroupSelection.update(this.gridLength?t:[]),this.tickLineGroupSelection.update(t),this.tickLabelGroupSelection.update(i),this.gridPathSelection.update(this.gridLine.enabled?this.prepareGridPathTickData(t):[]),this.gridLineGroupSelection.cleanup(),this.tickLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup(),this.gridPathSelection.cleanup()}updateLabels(){if(!this.label.enabled)return;const e=ia.resetAxisLabelSelectionFn();this.tickLabelGroupSelection.each((t,i)=>{t.fill=i.fill,t.fontFamily=i.fontFamily,t.fontSize=i.fontSize,t.fontStyle=i.fontStyle,t.fontWeight=i.fontWeight,t.text=i.text,t.textBaseline=i.textBaseline,t.textAlign=i.textAlign??"center",t.setProperties(e(t,i))})}updateGridLines(){super.updateGridLines();const{gridLine:{style:e,width:t},shape:i,generatedTicks:o}=this;if(!e||!o)return;const s=e.length,a=(u,f)=>{const{stroke:y,lineDash:g}=e[f%s];u.stroke=y,u.strokeWidth=t,u.lineDash=g,u.fill=void 0},[n,r]=this.gridRange??[0,2*Math.PI],l=wb(r-n,2*Math.PI),d=i==="circle"?(u,f)=>{const{path:y}=u;y.clear(!0);const g=this.getTickRadius(f);l?(y.moveTo(g,0),y.arc(0,0,g,0,2*Math.PI)):(y.moveTo(g*Math.cos(n),g*Math.sin(n)),y.arc(0,0,g,th(n),th(r))),l&&y.closePath()}:(u,f)=>{const{path:y}=u,g=this.gridAngles;if(y.clear(!0),!g||g.length<3)return;const m=this.getTickRadius(f);g.forEach((S,D)=>{const b=m*Math.cos(S),v=m*Math.sin(S);D===0?y.moveTo(b,v):y.lineTo(b,v),g.forEach((R,T)=>{const O=m*Math.cos(R),x=m*Math.sin(R);T===0?y.moveTo(O,x):y.lineTo(O,x)}),y.closePath()}),y.closePath()};this.gridPathSelection.each((u,f,y)=>{a(u,y),d(u,f)})}updateTitle(){const e=r=>r.defaultValue,{title:t,range:i,moduleCtx:{callbackCache:o}}=this,{formatter:s=e}=this.title;t.caption.enabled=t.enabled,t.caption.fontFamily=t.fontFamily,t.caption.fontSize=t.fontSize,t.caption.fontStyle=t.fontStyle,t.caption.fontWeight=t.fontWeight,t.caption.color=t.color,t.caption.wrapping=t.wrapping;let a=!1;const n=t.caption.node;t.enabled&&(a=!0,n.rotation=Math.PI/2,n.x=Math.floor((i[0]+i[1])/2),n.y=-Zb.SMALL_PADDING,n.textAlign="center",n.textBaseline="bottom",n.text=o.call(this,s,this.getTitleFormatterParams(this.scale.domain))),n.visible=a}updateCrossLines(){this.crossLines.forEach(e=>{if(e instanceof kr){const{shape:t,gridAngles:i,range:o,innerRadiusRatio:s}=this,a=o[0];e.shape=t,e.gridAngles=i,e.axisOuterRadius=a,e.axisInnerRadius=a*s}}),super.updateCrossLines()}createLabel(){return new Nr}getTickLabelProps(e,t){const{label:i}=this,{combinedRotation:o,textBaseline:s,textAlign:a}=t,n=this.scale.range,r=e.tickLabel,c=i.getSideFlag()*(this.getTickSize()+i.spacing+this.seriesAreaPadding),p=r!==""&&r!=null;return{...this.getLabelStyles({value:e.tickLabel}),tickId:e.tickId,rotation:o,rotationCenterX:c,translationY:e.translationY,text:r,textAlign:a,textBaseline:s,visible:p,x:c,y:0,range:n}}};oa.CrossLineConstructor=kr,h([Rr(eh)],oa.prototype,"positionAngle",2);var{RATIO:Ar,ProxyPropertyOnWrite:ih,TempValidate:Tr,CategoryScale:oh}=Eb,Ki=class extends oa{constructor(e){super(e,new oh),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}normaliseDataDomain(e){return{domain:e,clipped:!1}}prepareGridPathTickData(e){return e.slice().reverse()}getTickRadius(e){const{scale:t,innerRadiusRatio:i}=this,o=t.range[0],s=o*i;if(oh.is(t)){const a=t.domain,n=a.length-1-a.indexOf(e.tick);return n===0?s:t.inset+t.step*(n-.5)+t.bandwidth/2}else{const a=(o-s)/t.domain.length;return o-e.translationY+s-a/2}}};Ki.className="RadiusCategoryAxis",Ki.type="radius-category",h([Tr(Ar)],Ki.prototype,"groupPaddingInner",2),h([ih("scale","paddingInner"),Tr(Ar)],Ki.prototype,"paddingInner",2),h([ih("scale","paddingOuter"),Tr(Ar)],Ki.prototype,"paddingOuter",2);import{_ModuleSupport as aD}from"ag-charts-community";var{AND:sh,GREATER_THAN:nD,LESS_THAN:rD,NUMBER_OR_NAN:ah,TempValidate:nh,normalisedExtentWithMetadata:lD,LinearScale:cD}=aD,is=class extends oa{constructor(e){super(e,new cD),this.shape="polygon"}prepareGridPathTickData(e){const{scale:t}=this,i=t.domain[1];return e.filter(({tick:o})=>o!==i).sort((o,s)=>s.tick-o.tick)}getTickRadius(e){const{scale:t}=this,i=t.range[0],o=i*this.innerRadiusRatio;return i-e.translationY+o}normaliseDataDomain(e){const{min:t,max:i}=this,{extent:o,clipped:s}=lD(e,t,i);return{domain:o,clipped:s}}};is.className="RadiusNumberAxis",is.type="radius-number",h([nh(sh(ah,rD("max")),{optional:!0})],is.prototype,"min",2),h([nh(sh(ah,nD("min")),{optional:!0})],is.prototype,"max",2);var{cartesianAxisLabelOptionsDefs:pD,cartesianAxisOptionsDefs:hD,cartesianAxisCrosshairOptions:dD,continuousAxisOptions:Ir,commonAxisLabelOptionsDefs:sa,commonAxisOptionsDefs:aa,commonCrossLineOptionsDefs:na,commonCrossLineLabelOptionsDefs:rh,numberFormatValidator:lh}=_S,uD={...hD,type:es(Qo("ordinal-time")),paddingInner:wt,paddingOuter:wt,groupPaddingInner:wt,label:{...pD,format:cr},interval:Ir(GS(Et,BS),!0).interval,crosshair:dD(!0)},fD={...aa,...Ir(Et),type:es(Qo("angle-number")),crossLines:Qs(na),startAngle:Et,endAngle:Et,label:{...sa,orientation:ea("fixed","parallel","perpendicular"),format:lh}},gD={innerRadiusRatio:wt},yD={...aa,...gD,type:es(Qo("angle-category")),shape:ea("polygon","circle"),crossLines:Qs(na),startAngle:Et,endAngle:Et,paddingInner:wt,groupPaddingInner:wt,label:{...sa,orientation:ea("fixed","parallel","perpendicular")}},mD={...aa,...Ir(Et),type:es(Qo("radius-number")),shape:ea("polygon","circle"),positionAngle:Et,innerRadiusRatio:wt,crossLines:Qs({...na,label:{...rh,positionAngle:Et}},"cross-line options"),title:{enabled:Tp,text:cr,spacing:Lp,formatter:Ip,...Mp},label:{...sa,format:lh}},SD={...aa,type:es(Qo("radius-category")),positionAngle:Et,innerRadiusRatio:wt,paddingInner:wt,paddingOuter:wt,groupPaddingInner:wt,label:sa,crossLines:Qs({...na,label:{...rh,positionAngle:Et}},"cross-line options"),title:{enabled:Tp,text:cr,spacing:Lp,formatter:Ip,...Mp}},ch={type:"axis",name:"ordinal-time",chartType:"cartesian",enterprise:!0,options:uD,create:e=>new Or(e)},ph={type:"axis",name:"angle-number",chartType:"polar",enterprise:!0,options:fD,create:e=>new ko(e)},hh={type:"axis",name:"angle-category",chartType:"polar",enterprise:!0,options:yD,create:e=>new Wi(e)},dh={type:"axis",name:"radius-number",chartType:"polar",enterprise:!0,options:mD,create:e=>new is(e)},uh={type:"axis",name:"radius-category",chartType:"polar",enterprise:!0,options:SD,create:e=>new Ki(e)};import{_ModuleSupport as bD}from"ag-charts-community";import{_ModuleSupport as DD}from"ag-charts-community";var{Chart:xD,TempValidate:vD,ARRAY:OD}=DD;function kD(e){return e.type==="sankey"||e.type==="chord"}var ra=class extends xD{getChartType(){return"flow-proportion"}async updateData(){await super.updateData();const e=this.getOptions();this.nodes!==e.nodes&&(this.nodes=e.nodes);const{nodes:t}=this;this.series.forEach(i=>{kD(i)&&i.setChartNodes(t)})}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,{layoutBox:o}=e;o.shrink(this.seriesArea.padding.toJson());const s=o.clone();this.seriesRect=s,this.animationRect=s,t.visible=this.series.some(a=>a.visible);for(const a of[t,i])a.translationX=Math.floor(s.x),a.translationY=Math.floor(s.y);this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:t.visible,rect:s,paddedRect:s}})}};ra.className="FlowProportionChart",ra.type="flow-proportion",h([vD(OD,{optional:!0})],ra.prototype,"nodes",2);var{isAgFlowProportionChartOptions:RD,flowProportionChartOptionsDefs:ND}=bD,fh={type:"chart",name:"flow-proportion",enterprise:!0,options:ND,detect:RD,create(e,t){return new ra(e,t)}};import{_ModuleSupport as AD}from"ag-charts-community";import{_ModuleSupport as TD}from"ag-charts-community";var{Chart:ID}=TD,Mr=class extends ID{getChartType(){return"gauge"}performLayout(e){const{seriesRoot:t,annotationRoot:i,series:o,seriesArea:s}=this,{layoutBox:a}=e,n=a.clone();a.shrink(s.padding.toJson()),this.seriesRect=n.clone().translate(n.x-a.x,n.y-a.y),this.animationRect=a,t.visible=o.some(r=>r.visible);for(const r of[t,i])r.translationX=Math.floor(a.x),r.translationY=Math.floor(a.y);this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:t.visible,rect:n,paddedRect:a}})}getAriaLabel(){const e=[],t=this.getCaptionText();t.length!==0&&e.push(t);for(const o of this.series)e.push(o.getCaptionText());const i=e.join(". ");return this.ctx.localeManager.t("ariaAnnounceGaugeChart",{caption:i})}};Mr.className="GaugeChart",Mr.type="gauge";var{isAgGaugeChartOptions:MD,gaugeChartOptionsDefs:LD}=AD,gh={type:"chart",name:"gauge",enterprise:!0,options:LD,detect:MD,create(e,t){return new Mr(e,t)}};import{_ModuleSupport as CD}from"ag-charts-community";import{_ModuleSupport as PD}from"ag-charts-community";var{Chart:ED}=PD,Lr=class extends ED{getChartType(){return"hierarchy"}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,{layoutBox:o}=e;o.shrink(this.seriesArea.padding.toJson());const s=o.clone();this.seriesRect=s,this.animationRect=s;for(const a of[t,i])a.translationX=Math.floor(s.x),a.translationY=Math.floor(s.y);t.visible=this.series[0].visible,t.setClipRect(s.clone()),this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:!0,rect:s,paddedRect:s}})}getAriaLabel(){const e=this.getCaptionText();return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption:e})}};Lr.className="HierarchyChart",Lr.type="hierarchy";var{isAgHierarchyChartOptions:wD,hierarchyChartOptionsDefs:_D}=CD,yh={type:"chart",name:"hierarchy",enterprise:!0,options:_D,detect:wD,create(e,t){return new Lr(e,t)}};import{_ModuleSupport as BD}from"ag-charts-community";import{_ModuleSupport as GD}from"ag-charts-community";var{Chart:FD}=GD,Cr=class extends FD{getChartType(){return"standalone"}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,{layoutBox:o}=e;o.shrink(this.seriesArea.padding.toJson());const s=o.clone();this.seriesRect=s,this.animationRect=s;for(const a of[t,i])a.translationX=Math.floor(o.x),a.translationY=Math.floor(o.y);t.visible=this.series[0].visible,this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:!0,rect:s,paddedRect:o}})}getAriaLabel(){const e=this.getCaptionText();return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption:e})}};Cr.className="StandaloneChart",Cr.type="standalone";var{isAgStandaloneChartOptions:VD,standaloneChartOptionsDefs:WD}=BD,mh={type:"chart",name:"standalone",enterprise:!0,options:WD,detect:VD,create(e,t){return new Cr(e,t)}};import{_ModuleSupport as KD}from"ag-charts-community";import{_ModuleSupport as zD}from"ag-charts-community";import{_ModuleSupport as $D}from"ag-charts-community";import{isFiniteNumber as HD}from"ag-charts-core";function Sh(e){return Array.isArray(e)&&e.length>=2&&e.every(HD)}function la(e){return Array.isArray(e)&&e.length>=2&&e.every(Sh)}var bh=.001;function YD(e){return Math.abs(e[0][0]-e[e.length-1][0])<bh&&Math.abs(e[0][1]-e[e.length-1][1])<bh}function Dh(e){return Array.isArray(e)&&e.every(la)&&e.every(YD)}function xh(e){if(e===null)return!0;if(typeof e!="object"||e.type==null)return!1;const{type:t,coordinates:i}=e;switch(t){case"GeometryCollection":return Array.isArray(e.geometries)&&e.geometries.every(xh);case"MultiPolygon":return Array.isArray(i)&&i.every(Dh);case"Polygon":return Dh(i);case"MultiLineString":return Array.isArray(i)&&i.every(la);case"LineString":return la(i);case"MultiPoint":return la(i);case"Point":return Sh(i)}}function XD(e){return e!==null&&typeof e=="object"&&e.type==="Feature"&&xh(e.geometry)}function UD(e){return e!==null&&typeof e=="object"&&e.type==="FeatureCollection"&&Array.isArray(e.features)&&e.features.every(XD)}var Ro=$D.predicateWithMessage(UD,"a GeoJSON object"),{Chart:qD,MercatorScale:vh,NumberAxis:Oh,TempValidate:jD}=zD;function kh(e){return e.type==="map-shape"||e.type==="map-line"||e.type==="map-marker"||e.type==="map-shape-background"||e.type==="map-line-background"}var ca=class extends qD{constructor(e,t){super(e,t),this.xAxis=new Oh(this.getModuleContext()),this.xAxis.position="bottom",this.yAxis=new Oh(this.getModuleContext()),this.yAxis.position="left",this.ctx.zoomManager.updateAxes([this.xAxis,this.yAxis])}getChartType(){return"topology"}async updateData(){await super.updateData();const e=this.getOptions();this.topology!==e.topology&&(this.topology=e.topology);const{topology:t}=this;this.series.forEach(i=>{kh(i)&&i.setChartTopology(t)})}performLayout(e){const{seriesRoot:t,annotationRoot:i}=this,{layoutBox:o}=e;o.shrink(this.seriesArea.padding.toJson());const s=o.clone();this.seriesRect=s,this.animationRect=s;const a=this.series.filter(kh),n=a.reduce((c,p)=>{if(!p.visible)return c;const d=p.topologyBounds;return d==null?c:c==null?d:(c.merge(d),c)},void 0);let r;if(n!=null){const{lon0:c,lat0:p,lon1:d,lat1:u}=n,f=[[c,p],[d,u]],y=vh.bounds(f),{width:g,height:m}=s,S=Math.min(g/y.width,m/y.height),D=y.width*S,b=y.height*S,v=(g-D)/2,R=(m-b)/2,T=v,O=R,x=v+D,A=R+b,k=this.ctx.zoomManager.getAxisZoom(this.xAxis.id),I=this.ctx.zoomManager.getAxisZoom(this.yAxis.id),N=(x-T)/(k.max-k.min),L=T-N*k.min,M=(A-O)/(1-I.min-(1-I.max)),E=O-M*(1-I.max);r=new vh(f,[[L,E],[L+N,E+M]])}a.forEach(c=>{c.scale=r});const l=this.series.some(c=>c.visible);t.visible=l;for(const c of[t,i])c.translationX=Math.floor(s.x),c.translationY=Math.floor(s.y),c.setClipRect(s.clone());this.ctx.layoutManager.emitLayoutComplete(e,{series:{visible:l,rect:s,paddedRect:s}})}};ca.className="TopologyChart",ca.type="topology",h([jD(Ro,{optional:!0})],ca.prototype,"topology",2);var{isAgTopologyChartOptions:JD,topologyChartOptionsDefs:ZD}=KD,Rh={type:"chart",name:"topology",enterprise:!0,options:ZD,detect:JD,create(e,t){return new ca(e,t)}};import{_ModuleSupport as QD}from"ag-charts-community";import{array as ex,arrayOf as pa,arrayOfDefs as Nh,boolean as Y,callback as tx,color as Ah,constant as Th,fillOptionsDef as nt,fontOptionsDef as Bt,lineDashOptionsDef as Pr,number as vi,optionsDefs as ha,or as Oi,positiveNumber as os,ratio as da,required as ix,string as ut,strokeOptionsDef as Ne,typeUnion as ox,union as Gt}from"ag-charts-core";var{toolbarButtonOptionsDefs:ua}=QD,ss={enabled:Y,axesButtons:{enabled:Y,axes:Gt("x","y","xy")},toolbar:{enabled:Y,padding:os,buttons:Nh({...ua,value:Gt("line-menu","fibonacci-menu","text-menu","shape-menu","measurer-menu","line","horizontal-line","vertical-line","parallel-channel","disjoint-channel","fibonacci-retracement","fibonacci-retracement-trend-based","text","comment","callout","note","clear")},"annotation toolbar buttons array")},optionsToolbar:{enabled:Y,buttons:pa(Oi(ha({...ua,value:Gt("line-stroke-width","line-style-type","line-color","fill-color","text-color","text-size","delete","settings")}),ha({...ua,value:Gt("lock"),checkedOverrides:ua})))}};ss.data=ex,ss.xKey=ut,ss.volumeKey=ut,ss.snap=Y;var as=ha({__type:ix(Th("date")),value:Oi(ut,vi)},"a serializable date object"),Ih=Oi(ut,vi,as),Er=Oi(Ih,ha({value:Ih,groupPercentage:vi})),Mh={enabled:Y,cornerRadius:os,formatter:tx,...Bt,...nt,...Ne,...Pr},ki={label:ut,position:Gt("top","center","bottom"),alignment:Gt("left","center","right"),...Bt},Lh={label:ut,position:Gt("top","inside","bottom"),alignment:Gt("left","center","right"),...Bt},qe={...nt,...Ne,...Pr},ue={x:Er,y:vi},Ft={lineStyle:Gt("solid","dashed","dotted"),...Pr},Ch={visible:Y,extendStart:Y,extendEnd:Y,locked:Y,text:ki,handle:qe,label:Bt,showFill:Y,isMultiColor:Y,strokes:pa(Ah),rangeStroke:Ah,bands:Gt(4,6,10),...Ne,...Ft},sx=ox({line:{visible:Y,extendStart:Y,extendEnd:Y,locked:Y,text:ki,handle:qe,start:ue,end:ue,...Ne,...Ft},"horizontal-line":{visible:Y,locked:Y,value:Er,axisLabel:Mh,text:ki,handle:qe,...Ne,...Ft},"vertical-line":{visible:Y,locked:Y,value:Er,axisLabel:Mh,text:ki,handle:qe,...Ne,...Ft},"disjoint-channel":{visible:Y,extendStart:Y,extendEnd:Y,locked:Y,startHeight:os,endHeight:os,text:Lh,handle:qe,start:ue,end:ue,background:nt,...Ne,...Ft},"parallel-channel":{visible:Y,extendStart:Y,extendEnd:Y,locked:Y,height:os,text:Lh,handle:qe,start:ue,end:ue,background:nt,middle:{visible:Y,...Ne,...Ft},...Ne,...Ft},"fibonacci-retracement":{reverse:Y,start:ue,end:ue,...Ch},"fibonacci-retracement-trend-based":{reverse:Y,start:ue,end:ue,endRetracement:ue,...Ch},callout:{visible:Y,locked:Y,text:ut,handle:qe,start:ue,end:ue,...Bt,...nt,...Ne},comment:{visible:Y,locked:Y,text:ut,handle:qe,...ue,...Bt,...nt},note:{visible:Y,locked:Y,text:ut,handle:qe,background:{...nt,...Ne},...ue,...Bt,...nt,...Ne},text:{visible:Y,locked:Y,text:ut,handle:qe,...ue,...Bt,...nt},arrow:{visible:Y,extendStart:Y,extendEnd:Y,locked:Y,text:ki,handle:qe,start:ue,end:ue,...Ne,...Ft},"arrow-up":{visible:Y,locked:Y,handle:qe,...ue,...nt},"arrow-down":{visible:Y,locked:Y,handle:qe,...ue,...nt},"date-range":{visible:Y,extendAbove:Y,extendBelow:Y,locked:Y,text:ki,handle:qe,start:ue,end:ue,statistics:{divider:Ne,...Bt,...nt,...Ne},...Ne,...Ft},"price-range":{visible:Y,extendLeft:Y,extendRight:Y,locked:Y,text:ki,handle:qe,start:ue,end:ue,statistics:{divider:Ne,...Bt,...nt,...Ne},...Ne,...Ft},"date-price-range":{visible:Y,locked:Y,text:ki,handle:qe,start:ue,end:ue,statistics:{divider:Ne,...Bt,...nt,...Ne},...Ne,...Ft}}),ax={chartType:Gt("candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"),annotations:pa(sx),legend:Nh({visible:Y,seriesId:ut,itemId:ut,legendItemName:ut},"legend state array"),zoom:{rangeX:{start:Oi(vi,as),end:Oi(vi,as)},rangeY:{start:Oi(vi,as),end:Oi(vi,as)},ratioX:{start:da,end:da},ratioY:{start:da,end:da},autoScaledAxes:pa(Th("y"))}};import{_ModuleSupport as nx}from"ag-charts-community";import{array as rx,arrayOf as lx,boolean as ns,callback as cx,color as fa,fontOptionsDef as px,number as Ph,positiveNumber as xt,ratio as hx,typeUnion as dx}from"ag-charts-core";import{_ModuleSupport as ux}from"ag-charts-community";import{_ModuleSupport as wr}from"ag-charts-community";function fx(e){return{from:e?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}}}function gx(e){return(t,i)=>e?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}}import{_ModuleSupport as Eh}from"ag-charts-community";import{Logger as yx}from"ag-charts-core";var{ScalableGroup:mx,Rect:rs,Line:ls,BBox:Sx,Selection:wh,applyShapeFillBBox:bx}=Eh,Dx=class extends mx{constructor(){super(),this.append([new rs({tag:0}),new rs({tag:2}),new rs({tag:1}),new ls({tag:3}),new ls({tag:3}),new ls({tag:4}),new ls({tag:4})])}updateDatumStyles(e,t,i,o,s){const{bandwidth:a,scaledValues:{xValue:n,medianValue:r}}=e;let{minValue:l,q1Value:c,q3Value:p,maxValue:d}=e.scaledValues;(i&&!o||!i&&o)&&([d,p,c,l]=[l,c,p,d]);const u=(_,F,V,W)=>i?{y:_,x:F,width:W,height:V}:{x:_,y:F,width:V,height:W},f=(_,F,V)=>i?{y1:_,y2:F,x:V}:{x1:_,x2:F,y:V},y=(_,F,V)=>i?{x1:F,x2:V,y:_}:{x:_,y1:F,y2:V},g=(_,F,V,W)=>({x:_,y:F,width:V,height:W}=u(_,F,V,W),new Sx(_,F,V,W)),{fill:m,fillOpacity:S,stroke:D,strokeWidth:b,strokeOpacity:v,lineDash:R,lineDashOffset:T,cornerRadius:O,cap:x,whisker:A}=t,k=wh.select(this,rs),[I]=k.selectByTag(0),[N]=k.selectByTag(2),[L]=k.selectByTag(1),M=k.selectByTag(3),E=k.selectByTag(4);A.strokeWidth>a&&(A.strokeWidth=a);const C=u(c,n,p-c,a);N.setProperties(C),I.setProperties(C),I.setProperties({cornerRadius:O});const w=Math.max(Math.round(r-b/2),c+b),G=Math.min(Math.round(r+b/2),p-b);L.setProperties(C),L.setProperties({visible:w<G,cornerRadius:O,clipBBox:g(w,n+b,G-w,Math.max(0,a-b*2))});const P=Math.floor(n+a*(1-x.lengthRatio)/2),B=Math.ceil(n+a*(1+x.lengthRatio)/2);E[0].setProperties(y(l,P,B)),E[1].setProperties(y(d,P,B)),M[0].setProperties(f(Math.round(l+A.strokeWidth/2),c,Math.floor(n+a/2))),M[1].setProperties(f(p,Math.round(d-A.strokeWidth/2),Math.floor(n+a/2))),bx(I,m,s),I.setProperties({fill:m,fillOpacity:S,strokeWidth:b*2,strokeOpacity:0}),L.setProperties({fill:D,fillOpacity:v,strokeWidth:0});for(const _ of[...M,...E])_.setProperties(A);N.setProperties({stroke:D,strokeWidth:b,strokeOpacity:v,lineDash:R,lineDashOffset:T,cornerRadius:O,fillOpacity:0})}distanceSquared(e,t){const i=wh.selectByClass(this,rs,ls);return Eh.nearestSquared(e,t,i).distanceSquared}get midPoint(){const e=this.datum;return e.midPoint===void 0?(yx.error("BoxPlotGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):e.midPoint}};import{_ModuleSupport as xx}from"ag-charts-community";var{BaseProperties:_h,FillGradientDefaults:vx,FillPatternDefaults:Ox,AbstractBarSeriesProperties:kx,SeriesTooltip:Rx,TempValidate:ne,COLOR_STRING:_r,FUNCTION:Nx,LINE_DASH:Bh,OBJECT:cs,POSITIVE_NUMBER:ps,RATIO:ga,STRING:ft,mergeDefaults:Ax,COLOR_GRADIENT:Tx,COLOR_PATTERN:Ix,OR:Mx}=xx,Gh=class extends _h{constructor(){super(...arguments),this.lengthRatio=.5}};h([ne(ga)],Gh.prototype,"lengthRatio",2);var No=class extends _h{};h([ne(_r,{optional:!0})],No.prototype,"stroke",2),h([ne(ps)],No.prototype,"strokeWidth",2),h([ne(ga)],No.prototype,"strokeOpacity",2),h([ne(Bh,{optional:!0})],No.prototype,"lineDash",2),h([ne(ps)],No.prototype,"lineDashOffset",2);var he=class extends kx{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new vx,this.fillPatternDefaults=new Ox,this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new Gh,this.whisker=new No,this.tooltip=new Rx}toJson(){const{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:o,lineDashOffset:s}=this,a=super.toJson();return a.whisker=Ax(a.whisker,{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:o,lineDashOffset:s}),a}};h([ne(ft)],he.prototype,"xKey",2),h([ne(ft)],he.prototype,"minKey",2),h([ne(ft)],he.prototype,"q1Key",2),h([ne(ft)],he.prototype,"medianKey",2),h([ne(ft)],he.prototype,"q3Key",2),h([ne(ft)],he.prototype,"maxKey",2),h([ne(ft,{optional:!0})],he.prototype,"xName",2),h([ne(ft,{optional:!0})],he.prototype,"yName",2),h([ne(ft,{optional:!0})],he.prototype,"minName",2),h([ne(ft,{optional:!0})],he.prototype,"q1Name",2),h([ne(ft,{optional:!0})],he.prototype,"medianName",2),h([ne(ft,{optional:!0})],he.prototype,"q3Name",2),h([ne(ft,{optional:!0})],he.prototype,"maxName",2),h([ne(Mx(Tx,Ix,_r))],he.prototype,"fill",2),h([ne(cs)],he.prototype,"fillGradientDefaults",2),h([ne(cs)],he.prototype,"fillPatternDefaults",2),h([ne(ga)],he.prototype,"fillOpacity",2),h([ne(_r)],he.prototype,"stroke",2),h([ne(ps)],he.prototype,"strokeWidth",2),h([ne(ga)],he.prototype,"strokeOpacity",2),h([ne(Bh)],he.prototype,"lineDash",2),h([ne(ps)],he.prototype,"lineDashOffset",2),h([ne(ps)],he.prototype,"cornerRadius",2),h([ne(Nx,{optional:!0})],he.prototype,"itemStyler",2),h([ne(cs)],he.prototype,"cap",2),h([ne(cs)],he.prototype,"whisker",2),h([ne(cs)],he.prototype,"tooltip",2);var{extractDecoratedProperties:Fh,fixNumericExtent:Lx,keyProperty:Cx,mergeDefaults:Br,SeriesNodePickMode:Vh,SMALLEST_KEY_INTERVAL:Px,valueProperty:hs,diff:Ex,animationValidation:wx,computeBarFocusBounds:_x,createDatumId:Wh,ContinuousScale:Bx,ChartAxisDirection:Kh,motion:zh,isGradientFill:Gx,getShapeStyle:ds}=wr,Fx=class extends wr.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.minKey=o.properties.minKey,this.q1Key=o.properties.q1Key,this.medianKey=o.properties.medianKey,this.q3Key=o.properties.q3Key,this.maxKey=o.properties.maxKey}},ya=class extends wr.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[Vh.NEAREST_NODE,Vh.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},directionNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},categoryKey:"xValue",pathsPerSeries:[],hasHighlightedLabels:!0}),this.properties=new he,this.NodeEvent=Fx}async processData(e){if(!this.properties.isValid()||!this.visible)return;const{xKey:t,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n}=this.properties,r=!this.ctx.animationManager.isSkipped(),l=this.getCategoryAxis()?.scale,c=this.getValueAxis()?.scale,{isContinuousX:p,xScaleType:d,yScaleType:u}=this.getScaleInformation({xScale:l,yScale:c}),f=[];r&&this.processedData&&f.push(Ex(this.id,this.processedData)),r&&f.push(wx());const{processedData:y}=await this.requestDataModel(e,this.data,{props:[Cx(t,d,{id:"xValue"}),hs(i,u,{id:"minValue"}),hs(o,u,{id:"q1Value"}),hs(s,u,{id:"medianValue"}),hs(a,u,{id:"q3Value"}),hs(n,u,{id:"maxValue"}),...p?[Px]:[],...f]});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return[];if(e!==this.getBarDirection()){const{index:s,def:a}=i.resolveProcessedDataDefById(this,"xValue"),n=t.domain.keys[s];return a.type==="key"&&a.valueType==="category"?n:this.padBandExtent(n)}const o=this.domainForClippedRange(Kh.Y,["minValue","maxValue"],"xValue",!0);return Lx(o)}getSeriesRange(e,t){return this.domainForVisibleRange(Kh.Y,["maxValue","minValue"],"xValue",t,!0)}createNodeData(){const{visible:e,dataModel:t,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!(t&&i&&o&&s))return;const{xKey:a,fill:n,fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:p,lineDash:d,lineDashOffset:u,cap:f,whisker:y}=this.properties,g=[],m=t.resolveKeysById(this,"xValue",i),S=t.resolveColumnById(this,"minValue",i),D=t.resolveColumnById(this,"q1Value",i),b=t.resolveColumnById(this,"medianValue",i),v=t.resolveColumnById(this,"q3Value",i),R=t.resolveColumnById(this,"maxValue",i),{barWidth:T,groupIndex:O}=this.updateGroupScale(o),x=Bx.is(o.scale)?T*-.5:0,{groupScale:A}=this,k=this.isVertical(),I={itemId:a,nodeData:g,labelData:[],scales:this.calculateScaling(),visible:this.visible};return e&&(i.dataSources.get(this.id)??[]).forEach((L,M)=>{const E=m[M];if(E==null)return;const C=S[M],w=D[M],G=b[M],P=v[M],B=R[M];if([C,w,G,P,B].some(Z=>typeof Z!="number")||C>w||w>G||G>P||P>B)return;const _={xValue:Math.round(o.scale.convert(E)),minValue:Math.round(s.scale.convert(C)),q1Value:Math.round(s.scale.convert(w)),medianValue:Math.round(s.scale.convert(G)),q3Value:Math.round(s.scale.convert(P)),maxValue:Math.round(s.scale.convert(B))};_.xValue+=Math.round(A.convert(String(O)))+x;const F=Math.round(T),V=Math.abs(_.q3Value-_.q1Value),W=_.xValue+F/2,K=Math.min(_.q3Value,_.q1Value)+V/2,$={x:k?W:K,y:k?K:W};let U;k?U={x:$.x-F/2,y:_.minValue,width:F,height:_.maxValue-_.minValue}:U={x:_.minValue,y:$.y-F/2,width:_.maxValue-_.minValue,height:F},g.push({series:this,itemId:E,datum:L,datumIndex:M,xKey:a,bandwidth:F,scaledValues:_,cap:f,whisker:y,fill:n,fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:p,lineDash:d,lineDashOffset:u,midPoint:$,focusRect:U})}),I}legendItemSymbol(){const{fill:e,fillOpacity:t,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,fillGradientDefaults:r,fillPatternDefaults:l}=this.properties;return{marker:ds({fill:e,fillOpacity:t,stroke:i,strokeOpacity:s,strokeWidth:o,lineDash:a,lineDashOffset:n},r,l)}}getLegendData(e){const{id:t,ctx:{legendManager:i},visible:o}=this,{xKey:s,yName:a,showInLegend:n,legendItemName:r}=this.properties;return!s||e!=="category"?[]:[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:o&&i.getItemEnabled({seriesId:t,itemId:t}),label:{text:r??a??t},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!n}]}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,medianKey:l,medianName:c,q1Key:p,q1Name:d,q3Key:u,q3Name:f,minKey:y,minName:g,maxKey:m,maxName:S,legendItemName:D,tooltip:b}=s,v=this.getCategoryAxis(),R=this.getValueAxis();if(!i||!o||!v||!R)return;const T=o.dataSources.get(this.id)?.[e],O=i.resolveKeysById(this,"xValue",o)[e],x=i.resolveColumnById(this,"minValue",o)[e],A=i.resolveColumnById(this,"q1Value",o)[e],k=i.resolveColumnById(this,"medianValue",o)[e],I=i.resolveColumnById(this,"q3Value",o)[e],N=i.resolveColumnById(this,"maxValue",o)[e];if(O==null)return;const L=this.getItemBaseStyle(!1);return Object.assign(L,this.getItemStyleOverrides(String(e),T,L,!1)),b.formatTooltip(this.properties,{heading:v.formatDatum(O),title:D??r,symbol:this.legendItemSymbol(),data:[{label:g,fallbackLabel:y,value:R.formatDatum(x)},{label:d,fallbackLabel:p,value:R.formatDatum(A)},{label:c,fallbackLabel:l,value:R.formatDatum(k)},{label:f,fallbackLabel:u,value:R.formatDatum(I)},{label:S,fallbackLabel:m,value:R.formatDatum(N)}]},{seriesId:t,datum:T,title:r,xKey:a,xName:n,yName:r,medianKey:l,medianName:c,q1Key:p,q1Name:d,q3Key:u,q3Name:f,minKey:y,minName:g,maxKey:m,maxName:S,...L})}animateEmptyUpdateReady({datumSelection:e}){const t=this.isVertical(),{from:i,to:o}=fx(t);zh.resetMotion([e],gx(t)),zh.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[e],i,o,{phase:"initial"})}isLabelEnabled(){return!1}updateDatumSelection(e){const t=e.nodeData??[];return e.datumSelection.update(t)}getItemBaseStyle(e){const{properties:t}=this,{cornerRadius:i,cap:o,whisker:s,fillGradientDefaults:a,fillPatternDefaults:n}=t,r=e?t.highlightStyle.item:void 0,l=this.getStrokeWidth(t.strokeWidth);return ds({fill:r?.fill??t.fill,fillOpacity:r?.fillOpacity??t.fillOpacity,stroke:r?.stroke??t.stroke,strokeWidth:r?.strokeWidth??l,strokeOpacity:r?.strokeOpacity??t.strokeOpacity,lineDash:r?.lineDash??t.lineDash??[],lineDashOffset:r?.lineDashOffset??t.lineDashOffset,cornerRadius:i,cap:o,whisker:s},a,n)}getItemStyleOverrides(e,t,i,o){const{id:s,properties:a}=this,{xKey:n,minKey:r,q1Key:l,medianKey:c,q3Key:p,maxKey:d,fillGradientDefaults:u,fillPatternDefaults:f,itemStyler:y}=a;if(y==null)return;const g=this.cachedDatumCallback(Wh(e,o?"highlight":"node"),()=>this.callWithContext(y,{seriesId:s,datum:t,xKey:n,minKey:r,q1Key:l,medianKey:c,q3Key:p,maxKey:d,highlighted:o,...i}));return ds(g,u,f)}updateDatumNodes({datumSelection:e,isHighlight:t}){const i=this.isVertical(),o=this.getValueAxis()?.isReversed(),{highlightStyle:s}=this.properties;e.each((a,n)=>{let r=this.getFormattedStyles(n,t?"highlight":"node");t&&(r=Br(s.item,r));const{stroke:l,strokeWidth:c,strokeOpacity:p,lineDash:d,lineDashOffset:u}=r;r.whisker=Br(r.whisker,{stroke:l,strokeWidth:c,strokeOpacity:p,lineDash:d,lineDashOffset:u});const f=this.getShapeFillBBox();a.updateDatumStyles(n,r,i,o,f)})}updateLabelNodes(){}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t)}nodeFactory(){return new Dx}getFormattedStyles(e,t){const{id:i,properties:o}=this,{xKey:s,minKey:a,q1Key:n,medianKey:r,q3Key:l,maxKey:c,itemStyler:p,cornerRadius:d,fillGradientDefaults:u,fillPatternDefaults:f}=o,{datum:y,stroke:g,strokeWidth:m,strokeOpacity:S,lineDash:D,lineDashOffset:b,cap:v,whisker:R}=e;let T,O=1;Gx(e.fill)?T=e.fill:(T=e.fill,O=o.fillOpacity);let x=ds({fill:T,fillOpacity:O,stroke:g,strokeWidth:m,strokeOpacity:S,lineDash:D,lineDashOffset:b,cornerRadius:d,cap:Fh(v),whisker:Fh(R)},u,f);if(p){const A=this.cachedDatumCallback(Wh(y.index,t),()=>this.callWithContext(p,{datum:y,seriesId:i,highlighted:t==="highlight",...x,xKey:s,minKey:a,q1Key:n,medianKey:r,q3Key:l,maxKey:c}));A&&(x=ds(Br(A,x),u,f))}return x}computeFocusBounds({datumIndex:e}){return _x(this,this.contextNodeData?.nodeData[e].focusRect)}};ya.className="BoxPlotSeries",ya.type="box-plot";import{_ModuleSupport as Vx}from"ag-charts-community";import{boolean as $h,callback as Wx,constant as Kx,fillOptionsDef as zx,lineDashOptionsDef as Hh,positiveNumber as $x,ratio as Hx,required as zi,string as rt,strokeOptionsDef as Yh,union as Yx}from"ag-charts-core";var{commonSeriesOptionsDefs:Xx,tooltipOptionsDefs:Ux}=Vx,qx={type:zi(Kx("box-plot")),xKey:zi(rt),minKey:zi(rt),q1Key:zi(rt),medianKey:zi(rt),q3Key:zi(rt),maxKey:zi(rt),xName:rt,yName:rt,minName:rt,q1Name:rt,medianName:rt,q3Name:rt,maxName:rt,direction:Yx("horizontal","vertical"),grouped:$h,legendItemName:rt,showInMiniChart:$h,cornerRadius:$x,itemStyler:Wx,whisker:{...Yh,...Hh},cap:{lengthRatio:Hx},tooltip:Ux,...Xx,...zx,...Yh,...Hh};import{_ModuleSupport as Gr}from"ag-charts-community";var{CARTESIAN_AXIS_TYPE:Xh}=Gr.ThemeConstants,jx={series:{direction:"vertical",fill:{$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isPattern:[{$palette:"fill"}]}]},{$palette:"fill"},{$mix:[Gr.SAFE_FILL_OPERATION,{$ref:"backgroundColor"},.7]}]},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:Gr.FILL_PATTERN_DEFAULTS,strokeWidth:2},axes:{[Xh.NUMBER]:{crosshair:{snap:!1}},[Xh.CATEGORY]:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},iG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"box-plot",moduleFactory:e=>new ya(e),tooltipDefaults:{range:"exact"},defaultAxes:ux.DIRECTION_SWAP_AXES,themeTemplate:jx,groupable:!0},Fr={type:"series",name:"box-plot",chartType:"cartesian",enterprise:!0,options:qx,create:e=>new ya(e)};import{_ModuleSupport as Jx}from"ag-charts-community";import{_ModuleSupport as Zx}from"ag-charts-community";import{_ModuleSupport as Vr}from"ag-charts-community";import{Logger as Uh}from"ag-charts-core";import{_ModuleSupport as Qx}from"ag-charts-community";var{findMinMax:ev}=Qx,lt=0,vt=1,Ot=2,kt=3,Vt=4;function Wr(e,t=1){let i=Math.ceil(Math.log2(e.length/t))-1;return i=Math.min(Math.max(i,0),16),2**i|0}function Kr(e){return ev(e.map(t=>Number(t)))}function zr(e,t,i){return(e.valueOf()-t)/(i-t)}function $r(e,t){return Math.min(Math.floor(e*t),t-1)*Vt|0}function Hr(e,t,i,o,s,a){const n=new Int32Array(a*Vt).fill(-1),r=new Float64Array(a*Vt).fill(NaN);for(let l=0;l<e.length;l+=1){const c=e[l],p=t[l],d=i[l];if(c==null||p==null||d==null)continue;const u=zr(c,o,s),f=p.valueOf(),y=d.valueOf(),g=$r(u,a),m=n[g+lt]===-1;(m||u<r[g+lt])&&(n[g+lt]=l,r[g+lt]=u),(m||u>r[g+vt])&&(n[g+vt]=l,r[g+vt]=u),(m||y<r[g+Ot])&&(n[g+Ot]=l,r[g+Ot]=y),(m||f>r[g+kt])&&(n[g+kt]=l,r[g+kt]=f)}return{indexData:n,valueData:r}}function Yr(e,t,i,{inPlace:o=!1}={}){const s=i/2|0,a=o?e:new Int32Array(s*Vt),n=o?t:new Float64Array(s*Vt);for(let r=0;r<s;r+=1){const l=r*Vt|0,c=l*2|0,p=c+Vt|0,d=e[p+lt]===-1,u=d||t[c+lt]<t[p+lt]?c:p;a[l+lt]=e[u+lt],n[l+lt]=t[u+lt];const f=d||t[c+vt]>t[p+vt]?c:p;a[l+vt]=e[f+vt],n[l+vt]=t[f+vt];const y=d||t[c+Ot]<t[p+Ot]?c:p;a[l+Ot]=e[y+Ot],n[l+Ot]=t[y+Ot];const g=d||t[c+kt]>t[p+kt]?c:p;a[l+kt]=e[g+kt],n[l+kt]=t[g+kt]}return{maxRange:s,indexData:a,valueData:n}}var tv=1e3,qh=lt,iv=kt,ov=Ot,jh=vt;function sv(e,t,i,o){if(e.length<tv)return;const[s,a]=Kr(o);let n=Wr(e),{indexData:r,valueData:l}=Hr(e,t,i,s,a,n);const c=[{maxRange:n,indexData:r}];for(;n>64;)({indexData:r,valueData:l,maxRange:n}=Yr(r,l,n)),c.push({maxRange:n,indexData:r});return c.reverse(),c}var{fixNumericExtent:av,keyProperty:nv,createDatumId:Jh,SeriesNodePickMode:Zh,ChartAxisDirection:Xr,SMALLEST_KEY_INTERVAL:rv,valueProperty:ma,diff:lv,animationValidation:cv,computeBarFocusBounds:pv,visibleRangeIndices:Qh,ContinuousScale:hv,OrdinalTimeScale:dv,BandScale:uv,getShapeStyle:Ur}=Vr,fv=class extends Vr.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.openKey=o.properties.openKey,this.closeKey=o.properties.closeKey,this.highKey=o.properties.highKey,this.lowKey=o.properties.lowKey}},ed=class extends Vr.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[Zh.AXIS_ALIGNED,Zh.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},directionNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},categoryKey:"xValue",pathsPerSeries:[]}),this.NodeEvent=fv,this.dataAggregationFilters=void 0}async processData(e){if(!this.properties.isValid()||!this.visible)return;const{xKey:t,openKey:i,closeKey:o,highKey:s,lowKey:a}=this.properties,n=!this.ctx.animationManager.isSkipped(),r=this.getCategoryAxis()?.scale,l=this.getValueAxis()?.scale,{isContinuousX:c,xScaleType:p,yScaleType:d}=this.getScaleInformation({xScale:r,yScale:l}),u=[];n&&(this.processedData&&u.push(lv(this.id,this.processedData)),u.push(cv())),i&&u.push(ma(i,d,{id:"openValue",invalidValue:void 0,missingValue:void 0}));const{dataModel:f,processedData:y}=await this.requestDataModel(e,this.data,{props:[nv(t,p,{id:"xValue"}),ma(o,d,{id:"closeValue"}),ma(s,d,{id:"highValue"}),ma(a,d,{id:"lowValue"}),...c?[rv]:[],...u]});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.dataAggregationFilters=this.aggregateData(f,y),this.animationState.transition("updateData")}aggregateData(e,t){const i=this.axes[Xr.X];if(i==null||!(hv.is(i.scale)||dv.is(i.scale)))return;const o=e.resolveKeysById(this,"xValue",t),s=e.resolveColumnById(this,"highValue",t),a=e.resolveColumnById(this,"lowValue",t),{index:n}=e.resolveProcessedDataDefById(this,"xValue"),r=t.domain.keys[n];return sv(o,s,a,r)}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return[];if(e!==this.getBarDirection()){const{index:s,def:a}=i.resolveProcessedDataDefById(this,"xValue"),n=t.domain.keys[s];return a.type==="key"&&a.valueType==="category"?n:this.padBandExtent(n)}const o=this.domainForClippedRange(Xr.Y,["highValue","lowValue"],"xValue",!0);return av(o)}getSeriesRange(e,t){return this.domainForVisibleRange(Xr.Y,["highValue","lowValue"],"xValue",t,!0)}getVisibleItems(e,t,i){return this.countVisibleItems("xValue",["highValue","lowValue"],e,t,i)}createNodeData(){const{visible:e,dataModel:t,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!(t&&i&&o&&s))return;const a=[],{xKey:n,highKey:r,lowKey:l}=this.properties,c=i.dataSources.get(this.id)??[],p=t.resolveKeysById(this,"xValue",i),d=t.resolveColumnById(this,"openValue",i),u=t.resolveColumnById(this,"closeValue",i),f=t.resolveColumnById(this,"highValue",i),y=t.resolveColumnById(this,"lowValue",i),{groupScale:g}=this,{barWidth:m,groupIndex:S}=this.updateGroupScale(o),D=g.convert(String(S)),b=m>=1?m:g.rawBandwidth,v=uv.is(o.scale),R={itemId:n,nodeData:a,labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!e)return R;const T=(M,E,C,w,G,P,B,_)=>{const F=c[M],V=v?B/2:0,W=o.scale.convert(E)+D+V,K=s.scale.convert(C),$=s.scale.convert(w),U=s.scale.convert(G),Z=s.scale.convert(P),Q=w>C,ee=Q?"up":"down",J=Math.min(U,Z),j=Math.max(U,Z)-J,re={x:W,y:J+j/2};a.push({series:this,itemId:ee,datum:F,datumIndex:M,xKey:n,xValue:E,openValue:C,closeValue:w,highValue:G,lowValue:P,midPoint:re,aggregatedValue:w,isRising:Q,centerX:W,width:B,y:J,height:j,yOpen:K,yClose:$,crisp:_})},{dataAggregationFilters:O}=this,x=o.scale,[A,k]=x.range,I=k-A,N=M=>x.convert(p[M])+D,L=O?.find(M=>M.maxRange>I);if(L==null){let[M,E]=Qh(c.length,o.range,C=>{const w=N(C);return[w,w+b]});i.input.count<1e3&&(M=0,E=i.input.count);for(let C=M;C<E;C+=1){const w=p[C];if(w==null)continue;const G=d[C],P=u[C],B=f[C],_=y[C],F=_!=null&&_<=G&&_<=P,V=B!=null&&B>=G&&B>=P;if(!F){Uh.warnOnce(`invalid low value for key [${l}] in data element, low value cannot be higher than datum open or close values`);continue}if(!V){Uh.warnOnce(`invalid high value for key [${r}] in data element, high value cannot be lower than datum open or close values.`);continue}T(C,w,G,P,B,_,b,!0)}}else{const{maxRange:M,indexData:E}=L,[C,w]=Qh(M,o.range,G=>{const P=G*Vt,B=E[P+qh],_=E[P+jh];if(B!==-1)return[N(B),N(_)+b]});for(let G=C;G<w;G+=1){const P=G*Vt,B=E[P+qh],_=E[P+jh],F=E[P+iv],V=E[P+ov];if(B===-1)continue;const W=(B+_)/2|0,K=p[W];if(K==null)continue;const $=d[B],U=u[_],Z=f[F],Q=y[V],ee=Math.abs(N(_)-N(B))+b;T(W,K,$,U,Z,Q,ee,!1)}}return R}isVertical(){return!0}isLabelEnabled(){return!1}updateDatumSelection(e){const t=e.nodeData??[];return e.datumSelection.update(t)}updateLabelNodes(e){}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t)}getItemBaseStyle(e,t){const{properties:i}=this,o=i.item[e],s=t?i.highlightStyle.item:void 0,a={fill:s?.fill??o.fill,fillOpacity:s?.fillOpacity??o.fillOpacity,stroke:s?.stroke??o.stroke,strokeWidth:s?.strokeWidth??o.strokeWidth,strokeOpacity:s?.strokeOpacity??o.strokeOpacity,lineDash:s?.lineDash??o.lineDash,lineDashOffset:s?.lineDashOffset??o.lineDashOffset};return o.fillGradientDefaults&&o.fillPatternDefaults?Ur(a,o.fillGradientDefaults,o.fillPatternDefaults):a}getItemStyleOverrides(e,t,i,o,s){const{id:a,properties:n}=this,r=n.item[i],{itemStyler:l}=n;if(l==null)return;const{xKey:c,openKey:p,closeKey:d,highKey:u,lowKey:f}=n,y=this.cachedDatumCallback(Jh(e,s?"highlight":"node"),()=>this.callWithContext(l,{seriesId:a,datum:t,itemId:i,xKey:c,openKey:p,closeKey:d,highKey:u,lowKey:f,highlighted:s,...o}));return r.fillGradientDefaults&&r.fillPatternDefaults?Ur(y,r.fillGradientDefaults,r.fillPatternDefaults):y}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,openKey:l,openName:c,highKey:p,highName:d,lowKey:u,lowName:f,closeKey:y,closeName:g,legendItemName:m,tooltip:S}=s,D=this.getCategoryAxis(),b=this.getValueAxis();if(!i||!o||!D||!b)return;const v=o.dataSources.get(this.id)?.[e],R=i.resolveKeysById(this,"xValue",o)[e],T=i.resolveColumnById(this,"openValue",o)[e],O=i.resolveColumnById(this,"highValue",o)[e],x=i.resolveColumnById(this,"lowValue",o)[e],A=i.resolveColumnById(this,"closeValue",o)[e];if(R==null)return;const k=A>=T?"up":"down",I=this.properties.item[k],N=this.getItemBaseStyle(k,!1);Object.assign(N,this.getItemStyleOverrides(String(e),v,k,N,!1));let L={fill:I.fill??I.stroke,fillOpacity:I.fillOpacity??I.strokeOpacity??1,stroke:I.stroke,strokeWidth:I.strokeWidth??1,strokeOpacity:I.strokeOpacity??1,lineDash:I.lineDash??[0],lineDashOffset:I.lineDashOffset??0};return I.fillGradientDefaults&&I.fillPatternDefaults&&(L=Ur(L,I.fillGradientDefaults,I.fillPatternDefaults)),S.formatTooltip(this.properties,{heading:D.formatDatum(R),title:m,symbol:{marker:L},data:[{label:c,fallbackLabel:l,value:b.formatDatum(T)},{label:d,fallbackLabel:p,value:b.formatDatum(O)},{label:f,fallbackLabel:u,value:b.formatDatum(x)},{label:g,fallbackLabel:y,value:b.formatDatum(A)}]},{seriesId:t,datum:v,title:r,itemId:k,xKey:a,xName:n,yName:r,openKey:l,openName:c,highKey:p,highName:d,lowKey:u,lowName:f,closeKey:y,closeName:g,...N})}getDatumId(e){return Jh(e.xValue)}computeFocusBounds(e){const t=this.getNodeData()?.at(e.datumIndex);if(t==null)return;const{centerX:i,y:o,width:s,height:a}=t,n={x:i-s/2,y:o,width:s,height:a};return pv(this,n)}};import{_ModuleSupport as gv}from"ag-charts-community";import{_ModuleSupport as yv}from"ag-charts-community";var{Path:mv,ScenePathChangeDetection:Ri,BBox:Sv}=yv,ii=class extends mv{constructor(){super(...arguments),this.centerX=0,this.y=0,this.width=0,this.height=0,this.yOpen=0,this.yClose=0,this.crisp=!1,this.strokeAlignment=0}computeBBox(){const{centerX:e,y:t,width:i,height:o}=this;return new Sv(e-i/2,t,i,o)}isPointInPath(e,t){return this.getBBox().containsPoint(e,t)}distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}get midPoint(){return{x:this.centerX,y:this.y+this.height/2}}alignedCoordinates(){const{y:e,width:t,height:i,crisp:o,strokeAlignment:s}=this;let{centerX:a,yOpen:n,yClose:r}=this,l=a-t/2,c=a+t/2,p=e,d=e+i;if(o&&t>1){a=this.align(a),n=this.align(n),r=this.align(r);const f=this.align(t/2);l=a-f,c=a+f,p=this.align(e),d=p+this.align(p,i)}const u=(p+d)/2;return a+=s,l+=s,c+=s,p-=s,d+=s,n+=n<u?s:-s,r+=r<u?s:-s,{centerX:a,x0:l,x1:c,y0:p,y1:d,yOpen:n,yClose:r}}executeStroke(e,t){const{width:i,strokeWidth:o}=this;i<o&&(e.lineWidth=i),super.executeStroke(e,t)}};h([Ri()],ii.prototype,"centerX",2),h([Ri()],ii.prototype,"y",2),h([Ri()],ii.prototype,"width",2),h([Ri()],ii.prototype,"height",2),h([Ri()],ii.prototype,"yOpen",2),h([Ri()],ii.prototype,"yClose",2),h([Ri()],ii.prototype,"crisp",2),h([Ri()],ii.prototype,"strokeAlignment",2);var bv=class extends ii{updatePath(){const{path:e}=this,{centerX:t,x0:i,x1:o,y0:s,y1:a,yOpen:n,yClose:r}=this.alignedCoordinates();e.clear(),e.moveTo(t,s),e.lineTo(t,a),Math.abs(o-i)>1&&(e.moveTo(i,n),e.lineTo(t,n),e.moveTo(t,r),e.lineTo(o,r))}},{ScenePathChangeDetection:us,ExtendedPath2D:Dv,BBox:xv}=gv,Ao=class extends ii{constructor(){super(...arguments),this.wickPath=new Dv,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0}computeDefaultGradientFillBBox(){const{width:e,centerX:t,yOpen:i,yClose:o}=this,s=Math.min(i,o),n=Math.max(i,o)-s,r=t-e/2,l=t+e/2;return new xv(r,s,l-r,n)}updatePath(){const{path:e,stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,wickStroke:n,wickStrokeWidth:r,wickStrokeOpacity:l,wickLineDash:c,wickLineDashOffset:p,strokeAlignment:d}=this,{centerX:u,x0:f,x1:y,y0:g,y1:m,yOpen:S,yClose:D}=this.alignedCoordinates();this.path.clear(),this.wickPath.clear();const v=n!=null&&n!==t||r!=null&&r!==i||l!=null&&l!==o||c!=null&&c!==s||p!=null&&p!==a?this.wickPath:e;if(Math.abs(y-f)<=3){v.moveTo(u,g),v.lineTo(u,m);return}const R=Math.min(S,D),T=Math.max(S,D);v.moveTo(u,g),v.lineTo(u,R+i/2),v.moveTo(u,m),v.lineTo(u,T-i/2);const O=d+i/2,x=T-R-2*O;if(x>0)e.rect(f+O,R+O,y-f-2*O,x);else{const A=(R+T)/2;e.moveTo(f,A),e.lineTo(y,A)}}drawPath(e){super.drawPath(e);const{wickPath:t}=this;if(t.isEmpty())return;const{stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,wickStroke:r=i,wickStrokeWidth:l=o,wickStrokeOpacity:c=s,wickLineDash:p=a,wickLineDashOffset:d=n}=this;l!==0&&(e.globalAlpha*=c,typeof r=="string"&&(e.strokeStyle=r),e.lineWidth=l,p!=null&&e.setLineDash(p),e.lineDashOffset=d,e.stroke(t.getPath2D()))}};h([us()],Ao.prototype,"wickStroke",2),h([us()],Ao.prototype,"wickStrokeWidth",2),h([us()],Ao.prototype,"wickStrokeOpacity",2),h([us()],Ao.prototype,"wickLineDash",2),h([us()],Ao.prototype,"wickLineDashOffset",2);import{_ModuleSupport as vv}from"ag-charts-community";import{_ModuleSupport as Ov}from"ag-charts-community";var{BaseProperties:td,TempValidate:Me,AbstractBarSeriesProperties:kv,SeriesTooltip:Rv,STRING:Wt,COLOR_STRING:Nv,FUNCTION:Av,LINE_DASH:Tv,OBJECT:Sa,POSITIVE_NUMBER:id,RATIO:Iv}=Ov,$i=class extends td{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};h([Me(Nv)],$i.prototype,"stroke",2),h([Me(id)],$i.prototype,"strokeWidth",2),h([Me(Iv)],$i.prototype,"strokeOpacity",2),h([Me(Tv)],$i.prototype,"lineDash",2),h([Me(id)],$i.prototype,"lineDashOffset",2);var qr=class extends td{constructor(){super(...arguments),this.up=new $i,this.down=new $i}};h([Me(Sa)],qr.prototype,"up",2),h([Me(Sa)],qr.prototype,"down",2);var gt=class extends kv{};h([Me(Wt)],gt.prototype,"xKey",2),h([Me(Wt)],gt.prototype,"openKey",2),h([Me(Wt)],gt.prototype,"closeKey",2),h([Me(Wt)],gt.prototype,"highKey",2),h([Me(Wt)],gt.prototype,"lowKey",2),h([Me(Wt,{optional:!0})],gt.prototype,"xName",2),h([Me(Wt,{optional:!0})],gt.prototype,"yName",2),h([Me(Wt,{optional:!0})],gt.prototype,"openName",2),h([Me(Wt,{optional:!0})],gt.prototype,"closeName",2),h([Me(Wt,{optional:!0})],gt.prototype,"highName",2),h([Me(Wt,{optional:!0})],gt.prototype,"lowName",2);var ba=class extends gt{constructor(){super(...arguments),this.tooltip=new Rv,this.item=new qr}};h([Me(Sa)],ba.prototype,"tooltip",2),h([Me(Sa)],ba.prototype,"item",2),h([Me(Av,{optional:!0})],ba.prototype,"itemStyler",2);var{FillGradientDefaults:Mv,FillPatternDefaults:Lv,BaseProperties:jr,SeriesTooltip:Cv,TempValidate:Le,COLOR_STRING:Jr,FUNCTION:Pv,LINE_DASH:od,OBJECT:Hi,POSITIVE_NUMBER:fs,RATIO:Zr,COLOR_GRADIENT:Ev,COLOR_PATTERN:wv,OR:_v}=vv,To=class extends jr{};h([Le(Jr,{optional:!0})],To.prototype,"stroke",2),h([Le(fs)],To.prototype,"strokeWidth",2),h([Le(Zr)],To.prototype,"strokeOpacity",2),h([Le(od,{optional:!0})],To.prototype,"lineDash",2),h([Le(fs)],To.prototype,"lineDashOffset",2);var yt=class extends jr{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new Mv,this.fillPatternDefaults=new Lv,this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new To}};h([Le(_v(Ev,wv,Jr))],yt.prototype,"fill",2),h([Le(Hi)],yt.prototype,"fillGradientDefaults",2),h([Le(Hi)],yt.prototype,"fillPatternDefaults",2),h([Le(Zr)],yt.prototype,"fillOpacity",2),h([Le(Jr)],yt.prototype,"stroke",2),h([Le(fs)],yt.prototype,"strokeWidth",2),h([Le(Zr)],yt.prototype,"strokeOpacity",2),h([Le(od)],yt.prototype,"lineDash",2),h([Le(fs)],yt.prototype,"lineDashOffset",2),h([Le(fs)],yt.prototype,"cornerRadius",2),h([Le(Hi)],yt.prototype,"wick",2);var Qr=class extends jr{constructor(){super(...arguments),this.up=new yt,this.down=new yt}};h([Le(Hi)],Qr.prototype,"up",2),h([Le(Hi)],Qr.prototype,"down",2);var Da=class extends gt{constructor(){super(...arguments),this.item=new Qr,this.tooltip=new Cv}};h([Le(Hi)],Da.prototype,"item",2),h([Le(Hi)],Da.prototype,"tooltip",2),h([Le(Pv,{optional:!0})],Da.prototype,"itemStyler",2);var{createDatumId:Bv,isGradientFill:sd,isPatternFill:el,applyShapeFillBBox:Gv,getShapeFill:ad,getShapeStyle:tl}=Zx,xa=class extends ed{constructor(){super(...arguments),this.properties=new Da}nodeFactory(){return new Ao}updateDatumNodes({datumSelection:e,isHighlight:t}){const{id:i,properties:o}=this,{xKey:s,highKey:a,lowKey:n,openKey:r,closeKey:l,item:c,itemStyler:p}=o,{up:d,down:u}=c,f=tl({fill:d.fill,fillOpacity:d.fillOpacity,stroke:d.stroke,strokeWidth:d.strokeWidth,strokeOpacity:d.strokeOpacity,lineDash:d.lineDash,lineDashOffset:d.lineDashOffset},d.fillGradientDefaults,d.fillPatternDefaults),y=tl({fill:u.fill,fillOpacity:u.fillOpacity,stroke:u.stroke,strokeWidth:u.strokeWidth,strokeOpacity:u.strokeOpacity,lineDash:u.lineDash,lineDashOffset:u.lineDashOffset},u.fillGradientDefaults,u.fillPatternDefaults),g=t?o.highlightStyle.item:void 0;e.each((m,S)=>{const{isRising:D,centerX:b,width:v,y:R,height:T,yOpen:O,yClose:x,crisp:A}=S;let k;if(p!=null){const{fill:E,fillOpacity:C,stroke:w,strokeWidth:G,strokeOpacity:P,lineDash:B,lineDashOffset:_}=D?f:y;k=tl(this.cachedDatumCallback(Bv(this.getDatumId(S),t?"highlight":"node"),()=>this.callWithContext(p,{seriesId:i,itemId:S.itemId,xKey:s,highKey:a,lowKey:n,openKey:r,closeKey:l,datum:S.datum,fill:E,fillOpacity:C,strokeOpacity:P,stroke:w,strokeWidth:G,lineDash:B,lineDashOffset:_,highlighted:t})),D?d.fillGradientDefaults:u.fillGradientDefaults,D?d.fillPatternDefaults:u.fillPatternDefaults)}m.centerX=b,m.width=v,m.y=R,m.height=T,m.yOpen=O,m.yClose=x,m.crisp=A;const I=D?f:y,N=D?d.wick:u.wick,L=g?.fill??k?.fill??I.fill;Gv(m,L,this.getShapeFillBBox()),m.fill=g?.fill??k?.fill??I.fill,m.fillOpacity=g?.fillOpacity??k?.fillOpacity??I.fillOpacity,m.stroke=g?.stroke??k?.stroke??I.stroke,m.strokeWidth=g?.strokeWidth??k?.strokeWidth??I.strokeWidth,m.strokeOpacity=g?.strokeOpacity??k?.strokeOpacity??I.strokeOpacity,m.lineDash=g?.lineDash??k?.lineDash??I.lineDash,m.lineDashOffset=g?.lineDashOffset??k?.lineDashOffset??I.lineDashOffset;const M=k?.wick;m.wickStroke=g?.stroke??M?.stroke??N.stroke,m.wickStrokeWidth=g?.strokeWidth??M?.strokeWidth??N.strokeWidth,m.wickStrokeOpacity=g?.strokeOpacity??M?.strokeOpacity??N.strokeOpacity,m.wickLineDash=g?.lineDash??M?.lineDash??N.lineDash,m.wickLineDashOffset=g?.lineDashOffset??M?.lineDashOffset??N.lineDashOffset,m.strokeAlignment=(k?.strokeWidth??I.strokeWidth)/2})}legendItemSymbol(){const{up:e,down:t}=this.properties.item,i=ad(e.fill,e.fillGradientDefaults,e.fillPatternDefaults),o=sd(i)?i.colorStops.map(l=>typeof l=="string"?l:{color:l.color,stop:l.stop!=null?l.stop*.5:void 0}):[{color:el(i)?e.stroke:i,stop:0},{color:el(i)?e.stroke:i,stop:.5}],s=ad(t.fill,t.fillGradientDefaults,t.fillPatternDefaults),a=sd(s)?s.colorStops.map(l=>typeof l=="string"?l:{color:l.color,stop:l.stop!=null?l.stop*.5:void 0}):[{color:el(s)?t.stroke:s,stop:.5}],n={type:"gradient",gradient:"linear",rotation:90,colorStops:[...o,...a],reverse:!1},r={type:"gradient",gradient:"linear",rotation:90,colorStops:[{color:e.stroke,stop:0},{color:e.stroke,stop:.5},{color:t.stroke,stop:.5}],reverse:!1};return{marker:{fill:n,fillOpacity:e.fillOpacity,stroke:r,strokeWidth:e.strokeWidth??1,strokeOpacity:e.strokeOpacity??1,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset}}}getLegendData(e){const{id:t,data:i,visible:o,ctx:{legendManager:s}}=this,{xKey:a,yName:n,showInLegend:r,legendItemName:l}=this.properties;return!i?.length||!a||e!=="category"?[]:[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:o&&s.getItemEnabled({seriesId:t,itemId:t}),label:{text:l??n??t},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!r}]}};xa.className="CandleStickSeries",xa.type="candlestick";import{_ModuleSupport as Fv}from"ag-charts-community";import{boolean as nd,callback as Vv,constant as Wv,fillOptionsDef as Kv,lineDashOptionsDef as rd,number as zv,positiveNumber as $v,required as Io,string as Kt,strokeOptionsDef as ld}from"ag-charts-core";var{commonSeriesOptionsDefs:Hv,tooltipOptionsDefs:Yv}=Fv,cd={cornerRadius:$v,wick:{...ld,...rd},...Kv,...ld,...rd},il={type:Io(Wv("candlestick")),xKey:Io(Kt),openKey:Io(Kt),highKey:Io(Kt),lowKey:Io(Kt),closeKey:Io(Kt),xName:Kt,yName:Kt,openName:Kt,highName:Kt,lowName:Kt,closeName:Kt,item:{up:cd,down:cd},itemStyler:Vv,showInMiniChart:nd,tooltip:Yv,...Hv};il.pickOutsideVisibleMinorAxis=nd,il.focusPriority=zv;import{_ModuleSupport as pd}from"ag-charts-community";var{CARTESIAN_AXIS_TYPE:hd}=pd.ThemeConstants;function dd(e){return{fill:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},e==="up"?"transparent":{$palette:"fill"},{$palette:`${e}.fill`}]},stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:`${e}.stroke`}]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$if:[{$or:[{$isGradient:[{$palette:`${e}.fill`}]},{$isPattern:[{$palette:`${e}.fill`}]}]},{$map:[{$path:["./color",void 0,{$value:"$1"}]},{$path:["./colorStops",void 0,{$palette:`${e}.fill`}]}]},[{$mix:[{$palette:`${e}.fill`},"black",.15]},{$mix:[{$palette:`${e}.fill`},"white",.15]}]]},rotation:0,reverse:!1},fillPatternDefaults:pd.FILL_PATTERN_DEFAULTS}}var Xv={series:{item:{up:dd("up"),down:dd("down")},highlightStyle:{item:{strokeWidth:3}}},animation:{enabled:!1},axes:{[hd.NUMBER]:{crosshair:{snap:!1}},[hd.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},{CARTESIAN_AXIS_TYPE:ud,CARTESIAN_POSITION:fd}=Jx.ThemeConstants,gG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"candlestick",moduleFactory:e=>new xa(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:ud.NUMBER,position:fd.LEFT},{type:ud.ORDINAL_TIME,position:fd.BOTTOM}],themeTemplate:Xv,groupable:!1},ol={type:"series",name:"candlestick",chartType:"cartesian",enterprise:!0,options:il,create:e=>new xa(e)};import{_ModuleSupport as Uv}from"ag-charts-community";import{_ModuleSupport as sl}from"ag-charts-community";import{Logger as qv}from"ag-charts-core";import{_ModuleSupport as jv}from"ag-charts-community";import{Logger as Jv,findMaxValue as gd}from"ag-charts-core";var{CachedTextMeasurerPool:yd,TextUtils:md,TextWrapper:va}=jv;function Zv(e,t){const{fontSize:i,minimumFontSize:o=i}=e,{fontSize:s,minimumFontSize:a=s}=t,n=i-o,r=s-a;let l=e.fontSize,c=t.fontSize;const p=[{labelFontSize:i,secondaryLabelFontSize:s}];for(;l>o||c>a;){const d=n>0?(l-o)/n:-1,u=r>0?(c-a)/r:-1;d>u?l--:c--,p.push({labelFontSize:l,secondaryLabelFontSize:c})}return p.reverse(),p}function Mo(e,t){return e.lineHeight!=null&&e.fontSize!=null?e.lineHeight*t/e.fontSize:md.getLineHeight(t)}function Sd(e,t,i,o,{padding:s},a){const{spacing:n=0}=t,r=2*s,l=2*s+n,c=(t.minimumFontSize??t.fontSize)+(o.minimumFontSize??o.fontSize);if(c>a(c+l,!1).height-l)return;const p=Zv(t,o),d={fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight},u={fontFamily:o.fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight};let f,y;return gd(0,p.length-1,g=>{const{labelFontSize:m,secondaryLabelFontSize:S}=p[g],D=g===0,b=Mo(t,m),v=Mo(o,S),R=a(b+v+l,D),T=R.width-r,O=R.height-l;if(b+v>O||((f==null||f.fontSize!==m)&&(d.fontSize=m,f=Dd(t,e,T,O,d,t.wrapping,D?t.overflowStrategy:"hide")),f==null||f.width>T||f.height>O)||((y==null||y.fontSize!==S)&&(u.fontSize=S,y=Dd(o,i,T,O,u,o.wrapping,D?o.overflowStrategy:"hide")),y==null))return;const x=f.height+y.height;if(!(y.width>T||x>O))return{width:Math.max(f.width,y.width),height:x+n,meta:R.meta,label:f,secondaryLabel:y}})}function gs(e,t,{padding:i},o){const s=2*i,a=Math.min(t.minimumFontSize??t.fontSize,t.fontSize),n={fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight};return gd(a,t.fontSize,r=>{const l=Mo(t,r),c=r===a,p=o(l+s,c),d=p.width-s,u=p.height-s;if(l>u)return;n.fontSize=r;const f=va.wrapLines(e,{maxWidth:d,maxHeight:u,font:n,textWrap:t.wrapping,overflow:(c?t.overflowStrategy:void 0)??"hide"});if(!f.length)return;const y=Qv(f,{lineHeight:l,font:n,maxWidth:d,maxHeight:u});if(y)return[{fontSize:r,lineHeight:l,...y},p.meta]})}function bd(e){return e?.minimumFontSize!=null&&e?.fontSize!=null&&e?.minimumFontSize>e?.fontSize}function al(e,t,i,o,s,a){const n=t.enabled?e:void 0,r=o.enabled?i:void 0;(bd(t)||bd(o))&&Jv.warnOnce("minimumFontSize should be set to a value less than or equal to the font size");let l;n!=null&&r!=null&&(l=Sd(n,t,r,o,s,a));let c;if(l==null&&n!=null&&(c=gs(n,t,s,a)),c!=null){const[d,u]=c;l={width:d.width,height:d.height,meta:u,label:d,secondaryLabel:void 0}}let p;if(l==null&&n==null&&r!=null&&(p=gs(r,o,s,a)),p!=null){const[d,u]=p;l={width:d.width,height:d.height,meta:u,label:void 0,secondaryLabel:d}}return l}function Dd(e,t,i,o,s,a,n){const r=va.wrapLines(t,{maxWidth:i,maxHeight:o,font:s,textWrap:a,overflow:n});if(!r.length)return;const l=Mo(e,s.fontSize),{width:c}=yd.measureLines(r,{font:s});return{width:c,lineHeight:l,text:r.join(`
`),height:r.length*l,fontSize:s.fontSize}}function Qv(e,{font:t,lineHeight:i=md.defaultLineHeight,maxWidth:o,maxHeight:s=1/0}){let a=i*e.length;for(;a>s;){if(e.length===1)return;e.pop(),e[e.length-1]=va.appendEllipsis(e.at(-1)),a=i*e.length}const n=yd.measureLines(e,{font:t});let r,l;if(n.width>o){const c=[];l=0;for(const p of n.lineMetrics){if(p.width>o){if(!c.length)return;break}c.push(p.text),l=Math.max(l,p.width)}r=va.appendEllipsis(c.join(`
`))}else r=e.join(`
`),l=n.width;return{text:r,width:l,height:a}}import{_ModuleSupport as eO}from"ag-charts-community";import{_ModuleSupport as xd}from"ag-charts-community";var{TempValidate:ys,NUMBER:tO,POSITIVE_NUMBER:vd,TEXT_WRAP:iO,OVERFLOW_STRATEGY:oO}=xd,Lo=class extends xd.Label{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}};h([ys(iO)],Lo.prototype,"wrapping",2),h([ys(oO)],Lo.prototype,"overflowStrategy",2),h([ys(vd,{optional:!0})],Lo.prototype,"lineHeight",2),h([ys(vd,{optional:!0})],Lo.prototype,"minimumFontSize",2);var oi=class extends Lo{constructor(){super(...arguments),this.spacing=0}};h([ys(tO)],oi.prototype,"spacing",2);var ms=class extends Lo{},{CartesianSeriesProperties:sO,SeriesTooltip:aO,TempValidate:$e,AND:nO,ARRAY:rO,COLOR_STRING:lO,COLOR_STRING_ARRAY:cO,FUNCTION:pO,OBJECT:Od,POSITIVE_NUMBER:kd,RATIO:hO,STRING:Yi,TEXT_ALIGN:dO,VERTICAL_ALIGN:uO}=eO,We=class extends sO{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new oi,this.tooltip=new aO}};h([$e(Yi,{optional:!0})],We.prototype,"title",2),h([$e(Yi)],We.prototype,"xKey",2),h([$e(Yi)],We.prototype,"yKey",2),h([$e(Yi,{optional:!0})],We.prototype,"colorKey",2),h([$e(Yi,{optional:!0})],We.prototype,"xName",2),h([$e(Yi,{optional:!0})],We.prototype,"yName",2),h([$e(Yi,{optional:!0})],We.prototype,"colorName",2),h([$e(nO(cO,rO.restrict({minLength:1})))],We.prototype,"colorRange",2),h([$e(lO,{optional:!0})],We.prototype,"stroke",2),h([$e(hO)],We.prototype,"strokeOpacity",2),h([$e(kd,{optional:!0})],We.prototype,"strokeWidth",2),h([$e(dO)],We.prototype,"textAlign",2),h([$e(uO)],We.prototype,"verticalAlign",2),h([$e(kd)],We.prototype,"itemPadding",2),h([$e(pO,{optional:!0})],We.prototype,"itemStyler",2),h([$e(Od)],We.prototype,"label",2),h([$e(Od)],We.prototype,"tooltip",2);var{SeriesNodePickMode:Rd,computeBarFocusBounds:fO,getMissCount:gO,valueProperty:nl,ChartAxisDirection:Rt,DEFAULT_CARTESIAN_DIRECTION_KEYS:yO,DEFAULT_CARTESIAN_DIRECTION_NAMES:mO,createDatumId:SO,ColorScale:bO,Rect:DO,PointerEvents:xO,applyShapeStyle:vO}=sl,OO=class extends sl.CartesianSeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.colorKey=o.properties.colorKey}},kO={left:-.5,center:0,right:-.5},RO={top:-.5,middle:0,bottom:-.5},Oa=class extends sl.CartesianSeries{constructor(e){super({moduleCtx:e,directionKeys:yO,directionNames:mO,categoryKey:void 0,pickModes:[Rd.NEAREST_NODE,Rd.EXACT_SHAPE_MATCH],pathsPerSeries:[],hasMarkers:!1,hasHighlightedLabels:!0}),this.properties=new We,this.NodeEvent=OO,this.colorScale=new bO}async processData(e){const t=this.axes[Rt.X],i=this.axes[Rt.Y];if(!t||!i||!this.properties.isValid()||!this.data?.length)return;const{xKey:o,yKey:s,colorRange:a,colorKey:n}=this.properties,r=this.axes[Rt.X]?.scale,l=this.axes[Rt.Y]?.scale,{xScaleType:c,yScaleType:p}=this.getScaleInformation({xScale:r,yScale:l}),d=this.colorScale.type,{dataModel:u,processedData:f}=await this.requestDataModel(e,this.data,{props:[nl(o,c,{id:"xValue"}),nl(s,p,{id:"yValue"}),...n?[nl(n,d,{id:"colorValue"})]:[]]});if(this.isColorScaleValid()){const y=u.resolveProcessedDataIndexById(this,"colorValue");this.colorScale.domain=f.domain.values[y],this.colorScale.range=a,this.colorScale.update()}}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=gO(this,i.defs.values[o].missing);return!(s===0||s===a)}xCoordinateRange(e,t){const i=this.axes[Rt.X].scale,o=t*(i.bandwidth??0)/2,s=i.convert(e)+o,a=t*(i.bandwidth??10);return[s,s+a]}yCoordinateRange(e,t){const i=this.axes[Rt.Y].scale,o=t*(i.bandwidth??0)/2,s=i.convert(e[0])+o,a=t*(i.bandwidth??10);return[s,s+a]}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;return!t||!i?[]:e===Rt.X?t.getDomain(this,"xValue","value",i):t.getDomain(this,"yValue","value",i)}getSeriesRange(e,t){return[NaN,NaN]}createNodeData(){const{data:e,visible:t,axes:i,dataModel:o,processedData:s}=this,a=i[Rt.X],n=i[Rt.Y];if(!(e&&o&&s&&t&&a&&n))return;if(a.type!=="category"||n.type!=="category"){qv.warnOnce(`Heatmap series expected axes to have "category" type, but received "${a.type}" and "${n.type}" instead.`);return}const{xKey:r,xName:l,yKey:c,yName:p,colorKey:d,colorName:u,textAlign:f,verticalAlign:y,itemPadding:g,label:m}=this.properties,S=o.resolveColumnById(this,"xValue",s),D=o.resolveColumnById(this,"yValue",s),b=d?o.resolveColumnById(this,"colorValue",s):void 0,v=a.scale,R=n.scale,T=(v.bandwidth??0)/2,O=(R.bandwidth??0)/2,x=[],A=[],k=v.bandwidth??10,I=R.bandwidth??10,N=(k-2*g)*kO[f],L=(I-2*g)*RO[y],M=()=>({width:k,height:I,meta:null});return(s.dataSources.get(this.id)??[]).forEach((C,w)=>{const G=S[w],P=D[w],B=v.convert(G)+T,_=R.convert(P)+O,F=b?.[w],V=F==null?void 0:this.getLabelText(m,{value:F,datum:C,colorKey:d,colorName:u,xKey:r,yKey:c,xName:l,yName:p}),W=al(V,this.properties.label,void 0,this.properties.label,{padding:g},M),K={x:B,y:_,size:0};if(x.push({series:this,itemId:c,datumIndex:w,yKey:c,xKey:r,xValue:G,yValue:P,colorValue:F,datum:C,point:K,width:k,height:I,midPoint:{x:B,y:_},missing:b!=null&&F==null}),W?.label!=null){const{text:$,fontSize:U,lineHeight:Z,height:Q}=W.label,{fontStyle:ee,fontFamily:J,fontWeight:j,color:re}=this.properties.label,ce=K.x+N*(k-2*g),X=K.y+L*(I-2*g)-(W.height-Q)*.5;A.push({series:this,itemId:c,datum:C,datumIndex:w,text:$,fontSize:U,lineHeight:Z,fontStyle:ee,fontFamily:J,fontWeight:j,color:re,textAlign:f,verticalAlign:y,x:ce,y:X})}}),{itemId:this.properties.yKey??this.id,nodeData:x,labelData:A,scales:this.calculateScaling(),visible:this.visible}}nodeFactory(){return new DO}update(e){return this.ctx.animationManager.skipCurrentBatch(),super.update(e)}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,o=t??[];return i.update(o)}getItemBaseStyle(e){const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return{fill:i?.fill,fillOpacity:i?.fillOpacity??1,stroke:i?.stroke??t.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:i?.strokeOpacity??t.strokeOpacity}}getItemStyleOverrides(e,t,i,o,s){const{id:a,properties:n}=this,{xKey:r,yKey:l,colorRange:c,itemStyler:p}=n,d=this.isColorScaleValid()&&i!=null?this.colorScale.convert(i):c[0];let u=o.fill==null?{fill:d}:void 0;if(p!=null){u??(u={});const f=this.cachedDatumCallback(SO(e,s?"highlight":"node"),()=>this.callWithContext(p,{seriesId:a,datum:t,xKey:r,yKey:l,highlighted:s,...o,fill:d}));Object.assign(u,f)}return u}updateDatumNodes(e){const{isHighlight:t}=e,i=this.axes[Rt.X],[o,s]=i?.visibleRange??[],n=!(o!==0||s!==1),r=this.getItemBaseStyle(t);e.datumSelection.each((l,c)=>{const{datumIndex:p,colorValue:d,datum:u,point:f,width:y,height:g}=c,m=this.getItemStyleOverrides(String(p),u,d,r,t);l.crisp=n,l.x=Math.floor(f.x-y/2),l.y=Math.floor(f.y-g/2),l.width=Math.ceil(y),l.height=Math.ceil(g),vO(l,r,m)})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e,{enabled:o}=this.properties.label,s=o?t:[];return i.update(s)}updateLabelNodes(e){e.labelSelection.each((t,i)=>{t.text=i.text,t.fontSize=i.fontSize,t.lineHeight=i.lineHeight,t.fontStyle=i.fontStyle,t.fontFamily=i.fontFamily,t.fontWeight=i.fontWeight,t.fill=i.color,t.textAlign=i.textAlign,t.textBaseline=i.verticalAlign,t.x=i.x,t.y=i.y,t.pointerEvents=xO.None})}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,axes:s,properties:a,colorScale:n}=this,{xKey:r,xName:l,yKey:c,yName:p,colorKey:d,colorName:u,colorRange:f,title:y,legendItemName:g,tooltip:m}=a,S=s[Rt.X],D=s[Rt.Y];if(!i||!o||!S||!D)return;const b=o.dataSources.get(this.id)?.[e],v=i.resolveColumnById(this,"xValue",o)[e],R=i.resolveColumnById(this,"yValue",o)[e],T=d!=null&&this.isColorScaleValid()?i.resolveColumnById(this,"colorValue",o)[e]:void 0;if(v==null)return;const O=[];let x;T==null?x=f[0]:(x=n.convert(T),O.push({label:u,fallbackLabel:d,value:String(T)})),O.push({label:l,fallbackLabel:r,value:S.formatDatum(v)},{label:p,fallbackLabel:c,value:D.formatDatum(R)});const A=this.getItemBaseStyle(!1);Object.assign(A,this.getItemStyleOverrides(String(e),b,T,A,!1)),A.fill!=null&&(x=A.fill);const k=x!=null?{marker:{shape:"square",fill:x,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}}:void 0;return m.formatTooltip(this.properties,{title:y??g,symbol:k,data:O},{seriesId:t,datum:b,title:y,xKey:r,xName:l,yKey:c,yName:p,colorKey:d,colorName:u,...A})}getLegendData(e){return e!=="gradient"||!this.properties.isValid()||!this.isColorScaleValid()||!this.dataModel?[]:[{legendType:"gradient",enabled:this.visible,seriesId:this.id,colorName:this.properties.colorName,colorDomain:this.processedData.domain.values[this.dataModel.resolveProcessedDataIndexById(this,"colorValue")],colorRange:this.properties.colorRange}]}isLabelEnabled(){return this.properties.label.enabled&&!!this.properties.colorKey}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds({datumIndex:e}){const t=this.contextNodeData?.nodeData[e];if(t===void 0)return;const{width:i,height:o,midPoint:s}=t,a={x:s.x-i/2,y:s.y-o/2,width:i,height:o};return fO(this,a)}};Oa.className="HeatmapSeries",Oa.type="heatmap";import{_ModuleSupport as NO}from"ag-charts-community";import{arrayOf as AO,boolean as TO,callback as IO,color as MO,constant as LO,positiveNumber as CO,required as rl,string as Xi,strokeOptionsDef as PO,union as Nd}from"ag-charts-core";var{commonSeriesOptionsDefs:EO,autoSizedLabelOptionsDefs:wO,tooltipOptionsDefs:_O}=NO,BO={type:rl(LO("heatmap")),xKey:rl(Xi),yKey:rl(Xi),colorKey:Xi,xName:Xi,yName:Xi,colorName:Xi,colorRange:AO(MO),title:Xi,textAlign:Nd("left","center","right"),verticalAlign:Nd("top","middle","bottom"),itemPadding:CO,itemStyler:IO,showInMiniChart:TO,label:wO,tooltip:_O,...EO,...PO};import{_ModuleSupport as GO}from"ag-charts-community";var FO={series:{stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"backgroundColor"},{$path:["./0",{$palette:"stroke"},{$palette:"strokes"}]}]},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},GO.SAFE_RANGE2_OPERATION]},label:{enabled:!1,color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3},gradientLegend:{enabled:!0}},{ThemeConstants:{CARTESIAN_AXIS_TYPE:Ad,CARTESIAN_POSITION:Td}}=Uv,NG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"heatmap",moduleFactory:e=>new Oa(e),tooltipDefaults:{range:"exact"},defaultAxes:[{type:Ad.CATEGORY,position:Td.LEFT},{type:Ad.CATEGORY,position:Td.BOTTOM}],themeTemplate:FO},ll={type:"series",name:"heatmap",chartType:"cartesian",enterprise:!0,options:BO,create:e=>new Oa(e)};import{_ModuleSupport as VO}from"ag-charts-community";import{_ModuleSupport as WO}from"ag-charts-community";var{createDatumId:KO}=WO,ka=class extends ed{constructor(){super(...arguments),this.properties=new ba}nodeFactory(){return new bv}updateDatumNodes({datumSelection:e,isHighlight:t}){const{id:i,properties:o}=this,{xKey:s,highKey:a,lowKey:n,openKey:r,closeKey:l,item:c,itemStyler:p}=o,{up:d,down:u}=c,{stroke:f,strokeWidth:y,strokeOpacity:g,lineDash:m,lineDashOffset:S}=d,{stroke:D,strokeWidth:b,strokeOpacity:v,lineDash:R,lineDashOffset:T}=u,O=t?o.highlightStyle.item:void 0;e.each((x,A)=>{const{isRising:k,centerX:I,width:N,y:L,height:M,yOpen:E,yClose:C,crisp:w}=A;let G;if(p!=null){const{stroke:P,strokeWidth:B,strokeOpacity:_,lineDash:F,lineDashOffset:V}=k?d:u;G=this.cachedDatumCallback(KO(this.getDatumId(A),t?"highlight":"node"),()=>this.callWithContext(p,{seriesId:i,itemId:A.itemId,xKey:s,highKey:a,lowKey:n,openKey:r,closeKey:l,datum:A.datum,strokeOpacity:_,stroke:P,strokeWidth:B,lineDash:F,lineDashOffset:V,highlighted:t}))}x.centerX=I,x.width=N,x.y=L,x.height=M,x.yOpen=E,x.yClose=C,x.crisp=w,x.stroke=O?.stroke??G?.stroke??(k?f:D),x.strokeWidth=O?.strokeWidth??G?.strokeWidth??(k?y:b),x.strokeOpacity=O?.strokeOpacity??G?.strokeOpacity??(k?g:v),x.lineDash=O?.lineDash??G?.lineDash??(k?m:R),x.lineDashOffset=O?.lineDashOffset??G?.lineDashOffset??(k?S:T),x.strokeAlignment=(G?.strokeWidth??(k?y:b))/2})}getLegendData(e){const{id:t,data:i,ctx:{legendManager:o},visible:s}=this,{xKey:a,yName:n,item:{up:r,down:l},showInLegend:c,legendItemName:p}=this.properties;if(!i?.length||!a||e!=="category")return[];const d={type:"gradient",gradient:"linear",colorSpace:"rgb",colorStops:[{color:r.stroke,stop:0},{color:r.stroke,stop:.5},{color:l.stroke,stop:.5}],rotation:90};return[{legendType:"category",id:t,itemId:t,seriesId:t,enabled:s&&o.getItemEnabled({seriesId:t,itemId:t}),label:{text:p??n??t},symbol:{marker:{fill:d,fillOpacity:r.strokeOpacity,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}},legendItemName:p,hideInLegend:!c}]}};ka.className="ohlc",ka.type="ohlc";import{_ModuleSupport as zO}from"ag-charts-community";import{boolean as Id,callback as $O,constant as HO,lineDashOptionsDef as YO,number as XO,required as Co,string as zt,strokeOptionsDef as UO}from"ag-charts-core";var{commonSeriesOptionsDefs:qO,tooltipOptionsDefs:jO}=zO,Md={...UO,...YO},cl={type:Co(HO("ohlc")),xKey:Co(zt),openKey:Co(zt),highKey:Co(zt),lowKey:Co(zt),closeKey:Co(zt),xName:zt,yName:zt,openName:zt,highName:zt,lowName:zt,closeName:zt,showInMiniChart:Id,itemStyler:$O,item:{up:Md,down:Md},tooltip:jO,...qO};cl.pickOutsideVisibleMinorAxis=Id,cl.focusPriority=XO;var{CARTESIAN_AXIS_TYPE:Ra,CARTESIAN_POSITION:Ld}=VO.ThemeConstants,LG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ohlc",moduleFactory:e=>new ka(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Ra.NUMBER,position:Ld.LEFT},{type:Ra.ORDINAL_TIME,position:Ld.BOTTOM}],themeTemplate:{animation:{enabled:!1},series:{item:{up:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"up.stroke"}]}},down:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"down.stroke"}]}}}},axes:{[Ra.NUMBER]:{crosshair:{snap:!1}},[Ra.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},groupable:!1},pl={type:"series",name:"ohlc",chartType:"cartesian",enterprise:!0,options:cl,create:e=>new ka(e)};import{_ModuleSupport as JO}from"ag-charts-community";import{_ModuleSupport as Na}from"ag-charts-community";var ZO=1e3;function Cd(e,t,i,o,s,a){const n=e[a];if(n==null)return!1;const r=zr(n,t,i),l=$r(r,s);return a===o[l+kt]}function Pd(e,t,i,o,s,a){const n=e[a];if(n==null)return!1;const r=zr(n,t,i),l=$r(r,s);return a===o[l+Ot]}function QO(e,t,i,o){if(e.length<ZO)return;const[s,a]=Kr(o);let n=Wr(e);const{indexData:r,valueData:l}=Hr(e,t,i,s,a,n);let c=[],p=[];for(let u=0;u<e.length;u+=1)Cd(e,s,a,r,n,u)&&c.push(u),Pd(e,s,a,r,n,u)&&p.push(u);const d=[{maxRange:n,topIndices:c,bottomIndices:p}];for(;n>64;)({maxRange:n}=Yr(r,l,n,{inPlace:!0})),c=c.filter(Cd.bind(null,e,s,a,r,n)),p=p.filter(Pd.bind(null,e,s,a,r,n)),d.push({maxRange:n,topIndices:c,bottomIndices:p});return d.reverse(),d}import{_ModuleSupport as ek}from"ag-charts-community";var{CartesianSeriesProperties:tk,FillGradientDefaults:ik,FillPatternDefaults:ok,InterpolationProperties:sk,SeriesMarker:ak,SeriesTooltip:nk,TempValidate:ye,BOOLEAN:rk,COLOR_STRING:Ed,LINE_DASH:lk,OBJECT:Ui,PLACEMENT:ck,POSITIVE_NUMBER:hl,COLOR_GRADIENT:pk,COLOR_PATTERN:hk,OR:dk,RATIO:wd,STRING:qi,DropShadow:uk,Label:fk}=ek,dl=class extends fk{constructor(){super(...arguments),this.placement="outside",this.padding=6}};h([ye(ck)],dl.prototype,"placement",2),h([ye(hl)],dl.prototype,"padding",2);var De=class extends tk{constructor(){super(...arguments),this.fill="#99CCFF",this.fillGradientDefaults=new ik,this.fillPatternDefaults=new ok,this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new sk,this.shadow=new uk().set({enabled:!1}),this.marker=new ak,this.label=new dl,this.tooltip=new nk,this.connectMissingData=!1}};h([ye(qi)],De.prototype,"xKey",2),h([ye(qi)],De.prototype,"yLowKey",2),h([ye(qi)],De.prototype,"yHighKey",2),h([ye(qi,{optional:!0})],De.prototype,"xName",2),h([ye(qi,{optional:!0})],De.prototype,"yName",2),h([ye(qi,{optional:!0})],De.prototype,"yLowName",2),h([ye(qi,{optional:!0})],De.prototype,"yHighName",2),h([ye(dk(pk,hk,Ed))],De.prototype,"fill",2),h([ye(Ui)],De.prototype,"fillGradientDefaults",2),h([ye(Ui)],De.prototype,"fillPatternDefaults",2),h([ye(wd)],De.prototype,"fillOpacity",2),h([ye(Ed)],De.prototype,"stroke",2),h([ye(hl)],De.prototype,"strokeWidth",2),h([ye(wd)],De.prototype,"strokeOpacity",2),h([ye(lk)],De.prototype,"lineDash",2),h([ye(hl)],De.prototype,"lineDashOffset",2),h([ye(Ui)],De.prototype,"interpolation",2),h([ye(Ui)],De.prototype,"shadow",2),h([ye(Ui)],De.prototype,"marker",2),h([ye(Ui)],De.prototype,"label",2),h([ye(Ui)],De.prototype,"tooltip",2),h([ye(rk)],De.prototype,"connectMissingData",2);import{_ModuleSupport as gk}from"ag-charts-community";var{CollapseMode:Aa,isScaleValid:_d,pairUpSpans:Ta,prepareAreaFillAnimationFns:yk,plotInterpolatedLinePathStroke:Po,prepareLinePathPropertyAnimation:mk,areScalingEqual:Bd}=gk;function Sk(e,t,i,o){const s=(l,c)=>{Po(l,c,t.removed),Po(l,c,i.removed)},a=(l,c)=>{Po(l,c,t.moved),Po(l,c,i.moved)},n=(l,c)=>{Po(l,c,t.added),Po(l,c,i.added)},r=mk(e,o);return{status:e,path:{addPhaseFn:n,updatePhaseFn:a,removePhaseFn:s},pathProperties:r}}function bk(e,t,i){const o=e.scales.x?.type==="category",s=t.scales.x?.type==="category";if(o!==s||!_d(e.scales.x)||!_d(t.scales.x))return;let a="updated";t.visible&&!e.visible?a="removed":!t.visible&&e.visible&&(a="added");const n=Ta({scales:e.scales,data:e.fillData.spans},{scales:t.scales,data:t.fillData.spans},Aa.Split);if(n==null)return;const r=Ta({scales:e.scales,data:e.fillData.phantomSpans},{scales:t.scales,data:t.fillData.phantomSpans},Aa.Split);if(r==null)return;const l=Ta({scales:e.scales,data:e.highStrokeData.spans},{scales:t.scales,data:t.highStrokeData.spans},Aa.Split);if(l==null)return;const c=Ta({scales:e.scales,data:e.lowStrokeData.spans},{scales:t.scales,data:t.lowStrokeData.spans},Aa.Split);if(c==null)return;const p="fade",d=yk(a,n,r,p),u=Sk(a,l,c,p),f=(i?.changed??!0)||!Bd(e.scales.x,t.scales.x)||!Bd(e.scales.y,t.scales.y)||a!=="updated";return{status:a,fill:d,stroke:u,hasMotion:f}}var{valueProperty:Gd,keyProperty:Dk,ChartAxisDirection:je,mergeDefaults:xk,updateLabelNode:vk,fixNumericExtent:Fd,buildResetPathFn:Ok,resetLabelFn:kk,resetMarkerFn:Rk,resetMarkerPositionFn:Vd,pathSwipeInAnimation:Nk,resetMotion:Ak,markerSwipeScaleInAnimation:Tk,seriesLabelFadeInAnimation:ul,animationValidation:Ik,diff:Mk,updateClipPath:Wd,computeMarkerFocusBounds:Kd,plotAreaPathFill:Lk,plotLinePathStroke:zd,interpolatePoints:$d,pathFadeInAnimation:Hd,markerFadeInAnimation:Yd,fromToMotion:Xd,pathMotion:Ud,extent:Ck,createDatumId:Pk,applyShapeFillBBox:Ek,PointerEvents:fl,Group:wk,BBox:_k,ContinuousScale:Bk,OrdinalTimeScale:Gk,findMinMax:Fk,getShapeStyle:Vk,getShapeFill:Wk}=Na,Kk=class extends Na.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Ia=class extends Na.CartesianSeries{constructor(e){super({moduleCtx:e,hasMarkers:!0,pathsPerSeries:["fill","stroke"],pickModes:[Na.SeriesNodePickMode.AXIS_ALIGNED],directionKeys:{[je.X]:["xKey"],[je.Y]:["yLowKey","yHighKey"]},directionNames:{[je.X]:["xName"],[je.Y]:["yLowName","yHighName","yName"]},categoryKey:"xValue",animationResetFns:{path:Ok({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:kk,marker:(t,i)=>({...Rk(t),...Vd(t,i)})},clipFocusBox:!1}),this.properties=new De,this.NodeEvent=Kk,this.dataAggregationFilters=void 0}async processData(e){if(!this.properties.isValid())return;const{xKey:t,yLowKey:i,yHighKey:o}=this.properties,s=this.axes[je.X]?.scale,a=this.axes[je.Y]?.scale,{xScaleType:n,yScaleType:r}=this.getScaleInformation({xScale:s,yScale:a}),l=[],c=!this.ctx.animationManager.isSkipped();!this.ctx.animationManager.isSkipped()&&this.processedData&&l.push(Mk(this.id,this.processedData)),c&&l.push(Ik());const{dataModel:p,processedData:d}=await this.requestDataModel(e,this.data,{props:[Dk(t,n,{id:"xValue"}),Gd(i,r,{id:"yLowValue"}),Gd(o,r,{id:"yHighValue"}),...l]});this.dataAggregationFilters=this.aggregateData(p,d),this.animationState.transition("updateData")}aggregateData(e,t){const i=this.axes[je.X];if(i==null||!(Bk.is(i.scale)||Gk.is(i.scale)))return;const o=e.resolveKeysById(this,"xValue",t),s=e.resolveColumnById(this,"yHighValue",t),a=e.resolveColumnById(this,"yLowValue",t),{index:n}=e.resolveProcessedDataDefById(this,"xValue"),r=t.domain.keys[n];return QO(o,s,a,r)}xCoordinateRange(e){const t=this.axes[je.X].scale.convert(e);return[t,t]}yCoordinateRange(e){const t=this.axes[je.Y].scale.convert(e[0]);return[t,t]}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!(t&&i))return[];const{domain:{keys:[o]}}=t;if(e===je.X){const s=i.resolveProcessedDataDefById(this,"xValue");return s?.def.type==="key"&&s.def.valueType==="category"?o:Fd(Ck(o))}else{const s=this.domainForClippedRange(je.Y,["yHighValue","yLowValue"],"xValue",!0),a=Fk(s);return Fd(a)}}getSeriesRange(e,t){return this.domainForVisibleRange(je.Y,["yHighValue","yLowValue"],"xValue",t,!0)}createNodeData(){const{data:e,dataModel:t,processedData:i,axes:o}=this,s=o[je.X],a=o[je.Y];if(!(e&&s&&a&&t&&i))return;const n=s.scale,r=a.scale,{xKey:l,yLowKey:c,yHighKey:p,connectMissingData:d,marker:u,interpolation:f}=this.properties,y=i.dataSources.get(this.id)??[],g=(n.bandwidth??0)/2,m=t.resolveKeysById(this,"xValue",i),S=t.resolveColumnById(this,"yHighValue",i),D=t.resolveColumnById(this,"yLowValue",i),b=B=>n.convert(m[B])+g,v=[],R=[],T=[],O=(B,_,F)=>{const V=y[B],W=m[B];if(W==null)return;const K=T[T.length-1];if(Number.isFinite(_)&&Number.isFinite(F)){const $=(re,ce,X)=>{R.push({index:B,series:this,itemId:re,datum:V,datumIndex:B,midPoint:{x:Z,y:X},yHighValue:_,yLowValue:F,xValue:W,xKey:l,yLowKey:c,yHighKey:p,point:{x:Z,y:X,size:J},enabled:!0});const Ge=this.createLabelData({datumIndex:B,point:{x:Z,y:X},value:ce,yLowValue:F,yHighValue:_,itemId:re,inverted:U,datum:V,series:this});v.push(Ge)},U=F>_,Z=b(B),Q=r.convert(_),ee=r.convert(F),{size:J}=u;$("high",_,Q),$("low",F,ee);const j={high:{point:{x:Z,y:Q},xDatum:W,yDatum:_},low:{point:{x:Z,y:ee},xDatum:W,yDatum:F}};Array.isArray(K)?K.push(j):K!=null?(K.skip+=1,T.push([j])):T.push([j])}else d||(Array.isArray(K)||K==null?T.push({skip:0}):K.skip+=1)},{dataAggregationFilters:x}=this,[A,k]=n.range,I=k-A,N=x?.find(B=>B.maxRange>I),L=N?.topIndices,M=N?.bottomIndices;let[E,C]=this.visibleRange("xValue",s.range,L);E=Math.max(E-1,0),C=Math.min(C+1,L?.length??m.length),i.input.count<1e3&&(E=0,C=i.input.count);for(let B=E;B<C;B+=1){const _=L?.[B]??B,F=M?.[B]??B;O(_,S[_],D[F])}const w=T.flatMap(B=>{if(!Array.isArray(B))return[];const _=B.map(F=>F.high);return $d(_,f)}),G=T.flatMap(B=>{if(!Array.isArray(B))return[];const _=B.map(F=>F.low);return $d(_,f)});return{itemId:`${c}-${p}`,labelData:v,nodeData:R,fillData:{itemId:"high",spans:w,phantomSpans:G},highStrokeData:{itemId:"high",spans:w},lowStrokeData:{itemId:"low",spans:G},scales:this.calculateScaling(),visible:this.visible}}createLabelData({datumIndex:e,point:t,value:i,itemId:o,inverted:s,datum:a,series:n}){const{xKey:r,yLowKey:l,yHighKey:c,xName:p,yName:d,yLowName:u,yHighName:f,label:y}=this.properties,{placement:g,padding:m=10}=y;let S=o;s&&(S=o==="low"?"high":"low");const D=g==="outside"&&S==="high"||g==="inside"&&S==="low"?-1:1;return{x:t.x,y:t.y+m*D,series:n,itemId:o,datum:a,datumIndex:e,text:this.getLabelText(y,{value:i,datum:a,itemId:o,xKey:r,yLowKey:l,yHighKey:c,xName:p,yLowName:u,yHighName:f,yName:d}),textAlign:"center",textBaseline:D===-1?"bottom":"top"}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(e){const{opacity:t,visible:i,animationEnabled:o}=e,[s,a]=e.paths,n=this.getStrokeWidth(this.properties.strokeWidth);a.setProperties({fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:fl.None,stroke:this.properties.stroke,strokeWidth:n,strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity:t,visible:i||o});const r=Wk(this.properties.fill,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults),l=this.getShapeFillBBox();Ek(s,r,l),s.setProperties({stroke:void 0,lineJoin:"round",pointerEvents:fl.None,fill:r,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,strokeOpacity:this.properties.strokeOpacity,fillShadow:this.properties.shadow,strokeWidth:n,opacity:t,visible:i||o}),Wd(this,a),Wd(this,s)}updatePaths(e){this.updateAreaPaths(e.paths,e.contextData)}updateAreaPaths(e,t){for(const i of e)i.visible=t.visible;if(t.visible)this.updateFillPath(e,t),this.updateStrokePath(e,t);else for(const i of e)i.path.clear(),i.markDirty("RangeArea")}updateFillPath(e,t){const[i]=e;i.path.clear(),Lk(i,t.fillData),i.markDirty("RangeArea")}updateStrokePath(e,t){const[,i]=e;i.path.clear(),zd(i,t.highStrokeData.spans),zd(i,t.lowStrokeData.spans),i.markDirty("RangeArea")}updateMarkerSelection(e){const{nodeData:t,markerSelection:i}=e;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(this.properties.marker.enabled?t:[])}getMarkerItemBaseStyle(e){const{properties:t}=this,{marker:i}=t,o=e?t.highlightStyle.item:void 0;return{shape:i.shape,size:i.size,fill:o?.fill??i.fill,fillOpacity:o?.fillOpacity??i.fillOpacity,stroke:o?.stroke??i.stroke,strokeWidth:o?.strokeWidth??this.getStrokeWidth(i.strokeWidth),strokeOpacity:o?.strokeOpacity??i.strokeOpacity,lineDash:o?.lineDash??i.lineDash,lineDashOffset:o?.lineDashOffset??i.lineDashOffset}}getMarkerItemStyleOverrides(e,t,i,o){const{id:s,properties:a}=this,{xKey:n,yHighKey:r,yLowKey:l,marker:c}=a,{itemStyler:p}=c;if(p!=null)return this.cachedDatumCallback(Pk(e,o?"highlight":"node"),()=>this.callWithContext(p,{seriesId:s,datum:t,xKey:n,yHighKey:r,yLowKey:l,highlighted:o,...i}))}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i}=e,{xKey:o,yLowKey:s,yHighKey:a,marker:n,fill:r,stroke:l,strokeWidth:c,fillOpacity:p,strokeOpacity:d}=this.properties,u=xk(i&&this.properties.highlightStyle.item,n.getStyle(),{fill:r,fillOpacity:p,stroke:l,strokeWidth:c,strokeOpacity:d}),f=this.getShapeFillBBox();t.each((y,g)=>{this.updateMarkerStyle(n,y,g.datum,g.point,{xKey:o,yHighKey:a,yLowKey:s},i,u,f)}),i||this.properties.marker.markClean()}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;return i.update(t,o=>{o.pointerEvents=fl.None})}updateLabelNodes(e){e.labelSelection.each((t,i)=>{vk(t,this.properties.label,i)})}getHighlightLabelData(e,t){const i=e.filter(o=>o.datum===t.datum);return i.length>0?i:void 0}getHighlightData(e,t){const i=e.filter(o=>o.datum===t.datum);return i.length>0?i:void 0}getTooltipContent(e,t){const{id:i,dataModel:o,processedData:s,axes:a,properties:n}=this,{xName:r,yName:l,yLowKey:c,yLowName:p,xKey:d,yHighKey:u,yHighName:f,tooltip:y}=n,g=a[je.X],m=a[je.Y];if(!o||!s||!g||!m)return;const S=s.dataSources.get(this.id)?.[e],D=o.resolveKeysById(this,"xValue",s)[e],b=o.resolveColumnById(this,"yHighValue",s)[e],v=o.resolveColumnById(this,"yLowValue",s)[e];if(D==null)return;const R=this.getMarkerItemBaseStyle(!1);Object.assign(R,this.getMarkerItemStyleOverrides(String(e),e,R,!1));const T=`${m.formatDatum(v)} - ${m.formatDatum(b)}`;return y.formatTooltip(this.properties,{heading:g.formatDatum(D),symbol:this.legendItemSymbol(),data:[{label:l,fallbackLabel:`${p??c} - ${f??u}`,value:T}]},{seriesId:i,datum:S,title:l,itemId:t?.itemId??"unknown",xName:r,yName:l,yLowKey:c,yLowName:p,xKey:d,yHighKey:u,yHighName:f,...R})}legendItemSymbol(){const{fill:e,stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:s,marker:a}=this.properties;return{marker:Vk({shape:a.shape,fill:a.fill??e,stroke:a.stroke??t,fillOpacity:a.fillOpacity,strokeOpacity:a.strokeOpacity,strokeWidth:a.strokeWidth,lineDash:a.lineDash,lineDashOffset:a.lineDashOffset},a.fillGradientDefaults,a.fillPatternDefaults),line:{stroke:t,strokeOpacity:o,strokeWidth:i,lineDash:s}}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{yLowKey:o,yHighKey:s,yName:a,yLowName:n,yHighName:r,showInLegend:l}=this.properties,c=a??`${n??o} - ${r??s}`,p=`${o}-${s}`;return[{legendType:"category",id:t,itemId:p,seriesId:t,enabled:i,label:{text:`${c}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}nodeFactory(){return new wk}animateEmptyUpdateReady(e){const{markerSelection:t,labelSelection:i,contextData:o,paths:s}=e,{animationManager:a}=this.ctx;this.updateAreaPaths(s,o),Nk(this,a,...s),Ak([t],Vd),Tk(this,a,t),ul(this,"labels",a,i)}animateReadyResize(e){const{contextData:t,paths:i}=e;this.updateAreaPaths(i,t),super.animateReadyResize(e)}animateWaitingUpdateReady(e){const{animationManager:t}=this.ctx,{markerSelection:i,labelSelection:o,contextData:s,paths:a,previousContextData:n}=e,[r,l]=a;if(r==null&&l==null)return;this.resetMarkerAnimation(e),this.resetLabelAnimation(e);const c=()=>{this.resetPathAnimation(e),this.updateAreaPaths(a,s)},p=()=>{t.skipCurrentBatch(),c()};if(s==null||n==null){c(),Yd(this,t,"added",i),Hd(this,"fill_path_properties",t,"add",r),Hd(this,"stroke_path_properties",t,"add",l),ul(this,"labels",t,o);return}const d=bk(s,n,this.processedData?.reduced?.diff?.[this.id]);if(d===void 0){p();return}else if(d.status==="no-op")return;Xd(this.id,"fill_path_properties",t,[r],d.fill.pathProperties),Xd(this.id,"stroke_path_properties",t,[l],d.stroke.pathProperties),d.status==="added"?this.updateAreaPaths(a,s):d.status==="removed"?this.updateAreaPaths(a,n):(Ud(this.id,"fill_path_update",t,[r],d.fill.path),Ud(this.id,"stroke_path_update",t,[l],d.stroke.path)),d.hasMotion&&(Yd(this,t,void 0,i),ul(this,"labels",t,o)),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(a,s)})}getFormattedMarkerStyle(e){const{xKey:t,yLowKey:i,yHighKey:o}=this.properties;return this.getMarkerStyle(this.properties.marker,e.datum,{xKey:t,yLowKey:i,yHighKey:o},!0)}computeFocusBounds(e){const t=Kd(this,e),i=Kd(this,{...e,datumIndex:e.datumIndex+1});if(t&&i)return _k.merge([t,i])}isDatumEnabled(e,t){return t%2===0&&super.isDatumEnabled(e,t)}};Ia.className="RangeAreaSeries",Ia.type="range-area";import{_ModuleSupport as zk}from"ag-charts-community";import{boolean as gl,constant as $k,fillOptionsDef as Hk,lineDashOptionsDef as Yk,number as Xk,positiveNumber as Uk,required as Ma,string as ji,strokeOptionsDef as qk,union as jk}from"ag-charts-core";var{commonSeriesOptionsDefs:Jk,interpolationValidator:Zk,markerOptionsDefs:Qk,seriesLabelOptionsDefs:eR,shadowOptionsDefs:tR,tooltipOptionsDefs:iR}=zk,yl={type:Ma($k("range-area")),xKey:Ma(ji),yLowKey:Ma(ji),yHighKey:Ma(ji),xName:ji,yName:ji,yLowName:ji,yHighName:ji,showInMiniChart:gl,connectMissingData:gl,interpolation:Zk,label:{...eR,padding:Uk,placement:jk("inside","outside")},marker:Qk,tooltip:iR,shadow:tR,...Jk,...Hk,...qk,...Yk};yl.pickOutsideVisibleMinorAxis=gl,yl.focusPriority=Xk;import{_ModuleSupport as ml}from"ag-charts-community";var oR={series:{fill:{$palette:"fill"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:ml.FILL_PATTERN_DEFAULTS,stroke:{$palette:"stroke"},fillOpacity:.7,nodeClickRange:"nearest",marker:{enabled:!1,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:ml.FILL_PATTERN_DEFAULTS,size:6,strokeWidth:2},label:{enabled:!1,placement:"outside",padding:10,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},interpolation:{type:"linear"}},axes:{[ml.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},{ThemeConstants:{CARTESIAN_AXIS_TYPE:qd,CARTESIAN_POSITION:jd}}=JO,FG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-area",moduleFactory:e=>new Ia(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:qd.NUMBER,position:jd.LEFT},{type:qd.CATEGORY,position:jd.BOTTOM}],themeTemplate:oR},Sl={type:"series",name:"range-area",chartType:"cartesian",enterprise:!0,options:yl,create:e=>new Ia(e)};import{_ModuleSupport as sR}from"ag-charts-community";import{_ModuleSupport as bl}from"ag-charts-community";var aR=1e3,nR=5;function rR(e,t,i,o){if(e.length<aR)return;const[s,a]=Kr(o);let n=Wr(e,nR),{indexData:r,valueData:l}=Hr(e,t,i,s,a,n);const c=[{maxRange:n,indexData:r}];for(;n>64;)({indexData:r,valueData:l,maxRange:n}=Yr(r,l,n)),c.push({maxRange:n,indexData:r});return c.reverse(),c}import{_ModuleSupport as lR}from"ag-charts-community";var{AbstractBarSeriesProperties:cR,FillGradientDefaults:pR,FillPatternDefaults:hR,SeriesTooltip:dR,TempValidate:me,COLOR_STRING:Jd,FUNCTION:uR,LINE_DASH:fR,OBJECT:Ss,PLACEMENT:gR,POSITIVE_NUMBER:La,RATIO:Zd,STRING:Ji,BOOLEAN:yR,COLOR_GRADIENT:mR,COLOR_PATTERN:SR,OR:bR,DropShadow:DR,Label:xR}=lR,Dl=class extends xR{constructor(){super(...arguments),this.placement="inside",this.padding=6}};h([me(gR)],Dl.prototype,"placement",2),h([me(La)],Dl.prototype,"padding",2);var xe=class extends cR{constructor(){super(...arguments),this.fill="#99CCFF",this.fillGradientDefaults=new pR,this.fillPatternDefaults=new hR,this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new DR().set({enabled:!1}),this.label=new Dl,this.tooltip=new dR,this.fastDataProcessing=!1}};h([me(Ji)],xe.prototype,"xKey",2),h([me(Ji)],xe.prototype,"yLowKey",2),h([me(Ji)],xe.prototype,"yHighKey",2),h([me(Ji,{optional:!0})],xe.prototype,"xName",2),h([me(Ji,{optional:!0})],xe.prototype,"yName",2),h([me(Ji,{optional:!0})],xe.prototype,"yLowName",2),h([me(Ji,{optional:!0})],xe.prototype,"yHighName",2),h([me(bR(mR,SR,Jd))],xe.prototype,"fill",2),h([me(Ss)],xe.prototype,"fillGradientDefaults",2),h([me(Ss)],xe.prototype,"fillPatternDefaults",2),h([me(Zd)],xe.prototype,"fillOpacity",2),h([me(Jd)],xe.prototype,"stroke",2),h([me(La)],xe.prototype,"strokeWidth",2),h([me(Zd)],xe.prototype,"strokeOpacity",2),h([me(fR)],xe.prototype,"lineDash",2),h([me(La)],xe.prototype,"lineDashOffset",2),h([me(La)],xe.prototype,"cornerRadius",2),h([me(uR,{optional:!0})],xe.prototype,"itemStyler",2),h([me(Ss)],xe.prototype,"shadow",2),h([me(Ss)],xe.prototype,"label",2),h([me(Ss)],xe.prototype,"tooltip",2),h([me(yR)],xe.prototype,"fastDataProcessing",2);var{SeriesNodePickMode:Qd,valueProperty:eu,keyProperty:vR,ChartAxisDirection:bs,checkCrisp:OR,updateLabelNode:kR,SMALLEST_KEY_INTERVAL:RR,LARGEST_KEY_INTERVAL:NR,diff:AR,prepareBarAnimationFunctions:tu,midpointStartingBarPosition:iu,resetBarSelectionsFn:TR,fixNumericExtent:IR,seriesLabelFadeInAnimation:ou,resetLabelFn:MR,animationValidation:LR,computeBarFocusBounds:CR,visibleRangeIndices:su,createDatumId:PR,ContinuousScale:au,OrdinalTimeScale:ER,Rect:wR,PointerEvents:_R,motion:nu,applyShapeStyle:BR,findMinMax:GR,getShapeStyle:xl}=bl,FR=class extends bl.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Ca=class extends bl.AbstractBarSeries{constructor(e){super({moduleCtx:e,pickModes:[Qd.AXIS_ALIGNED,Qd.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},directionNames:{x:["xName"],y:["yLowName","yHighName","yName"]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:TR,label:MR}}),this.properties=new xe,this.dataAggregationFilters=void 0,this.NodeEvent=FR}async processData(e){if(!this.properties.isValid())return;const{xKey:t,yLowKey:i,yHighKey:o,fastDataProcessing:s}=this.properties,a=!s,n=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale,{isContinuousX:l,xScaleType:c,yScaleType:p}=this.getScaleInformation({xScale:n,yScale:r}),d=[];this.ctx.animationManager.isSkipped()||(this.processedData&&d.push(AR(this.id,this.processedData)),d.push(LR()));const u=this.visible?{}:{forceValue:0},{dataModel:f,processedData:y}=await this.requestDataModel(e,this.data,{props:[vR(t,c,{id:"xValue"}),eu(i,p,{id:"yLowValue",invalidValue:null,...u}),eu(o,p,{id:"yHighValue",invalidValue:null,...u}),...l?[RR,NR]:[],...d],groupByKeys:a});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.largestDataInterval=y.reduced?.largestKeyInterval,this.dataAggregationFilters=this.aggregateData(f,y),this.animationState.transition("updateData")}aggregateData(e,t){if(t.type!=="grouped")return;const i=this.axes[bs.X];if(i==null||!(au.is(i.scale)||ER.is(i.scale)))return;const o=e.resolveKeysById(this,"xValue",t),s=e.resolveColumnById(this,"yHighValue",t),a=e.resolveColumnById(this,"yLowValue",t),{index:n}=e.resolveProcessedDataDefById(this,"xValue"),r=t.domain.keys[n];return rR(o,s,a,r)}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!t||!i)return[];const{keys:[o]}=t.domain;if(e===this.getCategoryDirection()){const s=i.resolveProcessedDataDefById(this,"xValue");return s?.def.type==="key"&&s?.def.valueType==="category"?o:this.padBandExtent(o)}else{const s=this.domainForClippedRange(bs.Y,["yHighValue","yLowValue"],"xValue",!0),a=GR(s);return IR(a)}}getSeriesRange(e,t){return this.domainForVisibleRange(bs.Y,["yHighValue","yLowValue"],"xValue",t,!0)}createNodeData(){const{data:e,dataModel:t,groupScale:i,processedData:o,visible:s}=this,a=this.getCategoryAxis(),n=this.getValueAxis();if(!(e&&a&&n&&t&&o?.dataSources))return;const r=a.scale,l=n.scale,c=this.getBarDirection()===bs.X,{xKey:p,yLowKey:d,yHighKey:u,strokeWidth:f}=this.properties,y=`${d}-${u}`,g={itemId:y,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!s)return g;const m=o.dataSources.get(this.id)??[],S=t.resolveKeysById(this,"xValue",o),D=t.resolveColumnById(this,"yLowValue",o),b=t.resolveColumnById(this,"yHighValue",o),{barWidth:v,groupIndex:R}=this.updateGroupScale(a),T=au.is(r)?v*-.5:0,O=i.convert(String(R)),x=OR(a?.scale,a?.visibleRange,this.smallestDataInterval,this.largestDataInterval),A=C=>Math.round(r.convert(S[C]))+O+T,k=(C,w,G,P,B,_,F)=>{const V=m[C],W=S[C];if(W==null)return;const K=D[C],$=b[C];if(!Number.isFinite(K?.valueOf())||!Number.isFinite($?.valueOf()))return;const[U,Z]=K<$?[K,$]:[$,K],Q=Math.round(l.convert(_)),ee=Math.round(l.convert(B)),J=Math.max(f,Math.abs(ee-Q)),j={x:c?Math.min(Q,ee):G,y:c?G:Math.min(Q,ee),width:c?J:P,height:c?P:J},re={x:j.x+j.width/2,y:j.y+j.height/2},ce=this.createLabelData({datumIndex:C,rect:j,barAlongX:c,yLowValue:U,yHighValue:Z,datum:V,series:this}),X={index:w,valueIndex:C,series:this,itemId:y,datum:V,datumIndex:C,xValue:W,yLowValue:K,yHighValue:$,yLowKey:d,yHighKey:u,xKey:p,x:j.x,y:j.y,width:j.width,height:j.height,midPoint:re,crisp:F,labels:ce};g.nodeData.push(X),g.labelData.push(...ce)},{dataAggregationFilters:I}=this,[N,L]=r.range,M=L-N,E=I?.find(C=>C.maxRange>M);if(E!=null){const{maxRange:C,indexData:w}=E,[G,P]=su(C,a.range,B=>{const _=B*Vt,F=w[_+lt],V=w[_+vt];if(F===-1)return;const W=(F+V)/2|0;return[A(W),A(V)+v]});for(let B=G;B<P;B+=1){const _=B*Vt,F=w[_+lt],V=w[_+vt],W=w[_+Ot],K=w[_+kt];if(F===-1)continue;const $=(F+V)/2|0;if(S[$]==null)continue;const Z=A($),Q=Math.abs(A(F)-A(V))+v,ee=D[W],J=b[K];k($,0,Z,Q,ee,J,!1)}}else if(o.type==="ungrouped"){let[C,w]=su(m.length,a.range,G=>[A(G),v]);o.input.count<1e3&&(C=0,w=o.input.count);for(let G=C;G<w;G+=1){const P=A(G),B=v,_=D[G],F=b[G];k(G,0,P,B,_,F,x)}}else for(const{datumIndex:C,groupIndex:w}of t.forEachGroupDatum(this,o)){const G=A(C),P=v,B=D[C],_=b[C];k(C,w,G,P,B,_,x)}return g}createLabelData({datumIndex:e,rect:t,barAlongX:i,yLowValue:o,yHighValue:s,datum:a,series:n}){const{xKey:r,yLowKey:l,yHighKey:c,xName:p,yLowName:d,yHighName:u,yName:f,label:y}=this.properties,g={datum:a,xKey:r,yLowKey:l,yHighKey:c,xName:p,yLowName:d,yHighName:u,yName:f},{placement:m,padding:S}=y,b=S*(m==="outside"?1:-1),v={datumIndex:e,x:t.x+(i?-b:t.width/2),y:t.y+(i?t.height/2:t.height+b),textAlign:i?"left":"center",textBaseline:i?"middle":"bottom",text:this.getLabelText(y,{itemId:"low",value:o,...g}),itemId:"low",datum:a,series:n},R={datumIndex:e,x:t.x+(i?t.width+b:t.width/2),y:t.y+(i?t.height/2:-b),textAlign:i?"right":"center",textBaseline:i?"middle":"top",text:this.getLabelText(y,{itemId:"high",value:s,...g}),itemId:"high",datum:a,series:n};return m==="outside"&&(v.textAlign=i?"right":"center",v.textBaseline=i?"middle":"top",R.textAlign=i?"left":"center",R.textBaseline=i?"middle":"bottom"),[v,R]}nodeFactory(){return new wR}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,o=t??[];return i.update(o,void 0,s=>this.getDatumId(s))}getItemBaseStyle(e){const{properties:t}=this,{cornerRadius:i,fillGradientDefaults:o,fillPatternDefaults:s}=t,a=e?t.highlightStyle.item:void 0;return xl({fill:a?.fill??t.fill,fillOpacity:a?.fillOpacity??t.fillOpacity,stroke:a?.stroke??t.stroke,strokeWidth:a?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:a?.strokeOpacity??t.strokeOpacity,lineDash:a?.lineDash??t.lineDash??[],lineDashOffset:a?.lineDashOffset??t.lineDashOffset,cornerRadius:i},o,s)}getItemStyleOverrides(e,t,i,o){const{id:s,properties:a}=this,{xKey:n,yHighKey:r,yLowKey:l,itemStyler:c,fillGradientDefaults:p,fillPatternDefaults:d}=a;if(c==null)return;const u=this.cachedDatumCallback(PR(e,o?"highlight":"node"),()=>this.callWithContext(c,{seriesId:s,datum:t,xKey:n,yHighKey:r,yLowKey:l,highlighted:o,...i}));return xl(u,p,d)}updateDatumNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getCategoryDirection()===bs.X,s=this.getItemBaseStyle(i),a=this.getShapeFillBBox();t.each((n,r)=>{const l=this.getItemStyleOverrides(String(r.datumIndex),r.datum,s,i);BR(n,s,l,a),n.cornerRadius=l?.cornerRadius??s.cornerRadius,n.visible=o?r.width>0:r.height>0,n.crisp=r.crisp})}getHighlightLabelData(e,t){const i=e.filter(o=>o.datum===t.datum);return i.length>0?i:void 0}updateLabelSelection(e){const t=this.properties.label.enabled?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=_R.None})}updateLabelNodes(e){e.labelSelection.each((t,i)=>{kR(t,this.properties.label,i)})}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,yLowKey:l,yHighKey:c,yLowName:p,yHighName:d,tooltip:u}=s,f=this.getCategoryAxis(),y=this.getValueAxis();if(!i||!o||!f||!y)return;const g=o.dataSources.get(this.id)?.[e],m=i.resolveKeysById(this,"xValue",o)[e],S=i.resolveColumnById(this,"yHighValue",o)[e],D=i.resolveColumnById(this,"yLowValue",o)[e];if(m==null)return;const b=this.getItemBaseStyle(!1);Object.assign(b,this.getItemStyleOverrides(String(e),g,b,!1));const v=`${y.formatDatum(D)} - ${y.formatDatum(S)}`;return u.formatTooltip(this.properties,{heading:f.formatDatum(m),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:`${p??l} - ${d??c}`,value:v}]},{seriesId:t,datum:g,title:r,xKey:a,xName:n,yName:r,yLowKey:l,yHighKey:c,yLowName:p,yHighName:d,...b})}legendItemSymbol(){const{fill:e,stroke:t,strokeWidth:i,fillOpacity:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,fillGradientDefaults:r,fillPatternDefaults:l}=this.properties;return{marker:xl({fill:e,stroke:t,fillOpacity:o,strokeOpacity:s,strokeWidth:i,lineDash:a,lineDashOffset:n},r,l)}}getLegendData(e){if(e!=="category")return[];const{id:t,visible:i}=this,{yName:o,yLowName:s,yHighName:a,yLowKey:n,yHighKey:r,showInLegend:l}=this.properties,c=o??`${s??n} - ${a??r}`,p=`${n}-${r}`;return[{legendType:"category",id:t,itemId:p,seriesId:t,enabled:i,label:{text:`${c}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}animateEmptyUpdateReady({datumSelection:e,labelSelection:t}){const i=tu(iu(this.isVertical(),"normal"));nu.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],i),ou(this,"labels",this.ctx.animationManager,t)}animateWaitingUpdateReady(e){const{datumSelection:t,labelSelection:i,previousContextData:o}=e,{processedData:s}=this,a=s?.reduced?.diff?.[this.id];this.ctx.animationManager.stopByAnimationGroupId(this.id);const n=o==null?"fade":"normal",r=tu(iu(this.isVertical(),n));nu.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],r,(l,c)=>this.getDatumId(c),a),ou(this,"labels",this.ctx.animationManager,i)}getDatumId(e){return`${e.xValue}-${e.valueIndex}`}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:e}){return CR(this,this.contextNodeData?.nodeData[e])}};Ca.className="RangeBarSeries",Ca.type="range-bar";import{_ModuleSupport as VR}from"ag-charts-community";import{boolean as vl,callback as WR,constant as KR,fillOptionsDef as zR,lineDashOptionsDef as $R,number as HR,positiveNumber as ru,required as Pa,string as Zi,strokeOptionsDef as YR,union as lu}from"ag-charts-core";var{commonSeriesOptionsDefs:XR,seriesLabelOptionsDefs:UR,shadowOptionsDefs:qR,tooltipOptionsDefs:jR}=VR,Ea={type:Pa(KR("range-bar")),xKey:Pa(Zi),yLowKey:Pa(Zi),yHighKey:Pa(Zi),xName:Zi,yName:Zi,yLowName:Zi,yHighName:Zi,direction:lu("horizontal","vertical"),showInMiniChart:vl,cornerRadius:ru,itemStyler:WR,label:{...UR,padding:ru,placement:lu("inside","outside")},tooltip:jR,shadow:qR,...XR,...zR,...YR,...$R};Ea.pickOutsideVisibleMinorAxis=vl,Ea.fastDataProcessing=vl,Ea.focusPriority=HR;import{_ModuleSupport as cu}from"ag-charts-community";var JR={series:{direction:"vertical",fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:cu.FILL_PATTERN_DEFAULTS,strokeWidth:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"},placement:"inside"}},axes:{[cu.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},YG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-bar",moduleFactory:e=>new Ca(e),tooltipDefaults:{range:"exact"},defaultAxes:sR.DIRECTION_SWAP_AXES,themeTemplate:JR,groupable:!0},Ol={type:"series",name:"range-bar",chartType:"cartesian",enterprise:!0,options:Ea,create:e=>new Ca(e)};import{_ModuleSupport as ZR}from"ag-charts-community";import{_ModuleSupport as Qi}from"ag-charts-community";import{_ModuleSupport as QR}from"ag-charts-community";var{AbstractBarSeriesProperties:eN,BaseProperties:Ds,FillGradientDefaults:tN,FillPatternDefaults:iN,PropertiesArray:oN,SeriesTooltip:sN,TempValidate:ie,BOOLEAN:aN,COLOR_STRING:kl,COLOR_PATTERN:nN,FUNCTION:pu,LINE_DASH:hu,NUMBER:rN,OBJECT:$t,OBJECT_ARRAY:lN,POSITIVE_NUMBER:Eo,OR:cN,COLOR_GRADIENT:pN,RATIO:Rl,STRING:wo,UNION:du,DropShadow:hN,Label:dN}=QR,wa=class extends Ds{};h([ie(du(["subtotal","total"],"a total type"))],wa.prototype,"totalType",2),h([ie(rN)],wa.prototype,"index",2),h([ie(wo)],wa.prototype,"axisLabel",2);var uu=class extends Ds{};h([ie(pu,{optional:!0})],uu.prototype,"renderer",2);var Nl=class extends dN{constructor(){super(...arguments),this.placement="outside-end",this.padding=6}};h([ie(du(["inside-center","inside-start","inside-end","outside-start","outside-end"],"a placement"))],Nl.prototype,"placement",2),h([ie(Eo)],Nl.prototype,"padding",2);var Ke=class extends Ds{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new tN,this.fillPatternDefaults=new iN,this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=new hN().set({enabled:!1}),this.label=new Nl,this.tooltip=new uu}};h([ie(wo,{optional:!0})],Ke.prototype,"name",2),h([ie(cN(pN,kl,nN))],Ke.prototype,"fill",2),h([ie($t)],Ke.prototype,"fillGradientDefaults",2),h([ie($t)],Ke.prototype,"fillPatternDefaults",2),h([ie(kl)],Ke.prototype,"stroke",2),h([ie(Rl)],Ke.prototype,"fillOpacity",2),h([ie(Rl)],Ke.prototype,"strokeOpacity",2),h([ie(hu)],Ke.prototype,"lineDash",2),h([ie(Eo)],Ke.prototype,"lineDashOffset",2),h([ie(Eo)],Ke.prototype,"strokeWidth",2),h([ie(Eo)],Ke.prototype,"cornerRadius",2),h([ie(pu,{optional:!0})],Ke.prototype,"itemStyler",2),h([ie($t)],Ke.prototype,"shadow",2),h([ie($t)],Ke.prototype,"label",2),h([ie($t)],Ke.prototype,"tooltip",2);var eo=class extends Ds{constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};h([ie(aN)],eo.prototype,"enabled",2),h([ie(kl)],eo.prototype,"stroke",2),h([ie(Rl)],eo.prototype,"strokeOpacity",2),h([ie(hu)],eo.prototype,"lineDash",2),h([ie(Eo)],eo.prototype,"lineDashOffset",2),h([ie(Eo)],eo.prototype,"strokeWidth",2);var _a=class extends Ds{constructor(){super(...arguments),this.positive=new Ke,this.negative=new Ke,this.total=new Ke}};h([ie($t)],_a.prototype,"positive",2),h([ie($t)],_a.prototype,"negative",2),h([ie($t)],_a.prototype,"total",2);var di=class extends eN{constructor(){super(...arguments),this.item=new _a,this.totals=new oN(wa),this.line=new eo,this.tooltip=new sN}};h([ie(wo)],di.prototype,"xKey",2),h([ie(wo)],di.prototype,"yKey",2),h([ie(wo,{optional:!0})],di.prototype,"xName",2),h([ie(wo,{optional:!0})],di.prototype,"yName",2),h([ie($t)],di.prototype,"item",2),h([ie(lN)],di.prototype,"totals",2),h([ie($t)],di.prototype,"line",2),h([ie($t)],di.prototype,"tooltip",2);var{adjustLabelPlacement:uN,SeriesNodePickMode:fu,fixNumericExtent:fN,valueProperty:gu,keyProperty:gN,accumulativeValueProperty:Ba,trailingAccumulatedValueProperty:yN,ChartAxisDirection:Al,createDatumId:mN,checkCrisp:SN,updateLabelNode:bN,prepareBarAnimationFunctions:DN,collapsedStartingBarPosition:xN,resetBarSelectionsFn:vN,seriesLabelFadeInAnimation:ON,resetLabelFn:kN,animationValidation:RN,DEFAULT_CARTESIAN_DIRECTION_KEYS:NN,DEFAULT_CARTESIAN_DIRECTION_NAMES:AN,computeBarFocusBounds:TN,isContinuous:yu,Rect:IN,motion:MN,applyShapeStyle:LN,getShapeStyle:Tl}=Qi,Ga=class extends Qi.AbstractBarSeries{constructor(e){super({moduleCtx:e,directionKeys:NN,directionNames:AN,categoryKey:void 0,pickModes:[fu.NEAREST_NODE,fu.EXACT_SHAPE_MATCH],pathsPerSeries:["connector"],hasHighlightedLabels:!0,pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:vN,label:kN}}),this.properties=new di,this.seriesItemTypes=new Set(["positive","negative","total"])}async processData(e){const{xKey:t,yKey:i,totals:o}=this.properties,{data:s=[]}=this;if(!this.properties.isValid()||!this.visible)return;const a=D=>yu(D)&&Number(D)>=0,n=D=>yu(D)&&Number(D)>=0,r=D=>D==="total"||D==="subtotal",l={missingValue:void 0,invalidValue:void 0},c=[],p=o.reduce((D,b)=>{const v=D.get(b.index);return v?v.push(b):D.set(b.index,[b]),D},new Map);s.forEach((D,b)=>{c.push(D),p.get(b)?.forEach(v=>c.push({...v.toJson(),[t]:v.axisLabel}))});const d=[];this.ctx.animationManager.isSkipped()||d.push(RN());const u=this.getCategoryAxis()?.scale,f=this.getValueAxis()?.scale,{isContinuousX:y,xScaleType:g,yScaleType:m}=this.getScaleInformation({xScale:u,yScale:f}),{processedData:S}=await this.requestDataModel(e,c,{props:[gN(t,g,{id:"xValue"}),Ba(i,m,{...l,id:"yCurrent"}),Ba(i,m,{...l,missingValue:0,id:"yCurrentTotal"}),Ba(i,m,{...l,id:"yCurrentPositive",validation:a}),Ba(i,m,{...l,id:"yCurrentNegative",validation:n}),yN(i,m,{...l,id:"yPrevious"}),gu(i,m,{id:"yRaw"}),gu("totalType","band",{id:"totalTypeValue",missingValue:void 0,validation:r}),...y?[Qi.SMALLEST_KEY_INTERVAL,Qi.LARGEST_KEY_INTERVAL]:[],...d]});this.smallestDataInterval=S.reduced?.smallestKeyInterval,this.largestDataInterval=S.reduced?.largestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i}=this;if(!t||!i)return[];const{keys:[o],values:s}=t.domain;if(e===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");if(a?.def.type==="key"&&a?.def.valueType==="category")return o;const n=e===Al.Y,r=this.getCategoryAxis().isReversed();return this.padBandExtent(o,r!==n)}else{const a=i.resolveProcessedDataIndexById(this,"yCurrent"),n=s[a],r=[Math.min(0,n[0]),Math.max(0,n[1])];return fN(r)}}getSeriesRange(e,t){return[NaN,NaN]}createNodeData(){const{data:e,dataModel:t,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!e||!o||!s||!t||!i)return;const{line:a}=this.properties,n=o.scale,r=s.scale,l=this.getBarDirection()===Al.X,c=this.getBandwidth(o)??10,p=o.isReversed(),d=s.isReversed();if(i.type!=="ungrouped")return;const u={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return u;const f=[],y=t.resolveKeysById(this,"xValue",i),g=t.resolveColumnById(this,"yRaw",i),m=t.resolveColumnById(this,"totalTypeValue",i),S=t.resolveColumnById(this,"yCurrent",i),D=t.resolveColumnById(this,"yPrevious",i),b=t.resolveColumnById(this,"yCurrentTotal",i),v=SN(o?.scale,o?.visibleRange,this.smallestDataInterval,this.largestDataInterval);function R(M,E,C){return M||E?{cumulativeValue:b[C],trailingValue:E?O:0}:{cumulativeValue:S[C],trailingValue:D[C]}}function T(M,E,C,w,G){return M?w:E?(w??0)-(G??0):C}let O=0;const{xKey:x,yKey:A,xName:k,yName:I}=this.properties;(i.dataSources.get(this.id)??[]).forEach((M,E)=>{const C=m[E],w=this.isSubtotal(C),G=this.isTotal(C),P=G||w,B=y[E];if(B==null)return;const _=Math.round(n.convert(B)),F=g[E],{cumulativeValue:V,trailingValue:W}=R(G,w,E);P&&(O=V??0);const K=Math.round(r.convert(V)),$=Math.round(r.convert(W)),U=T(G,w,F,V,W),Z=(U??0)>=0,Q=this.getSeriesItemType(Z,C),{strokeWidth:ee,label:J}=this.getItemConfig(Q),j=Z?K:$,re=Z?$:K,ce=Math.max(ee,Math.abs(re-j)),X={x:l?Math.min(j,re):_,y:l?_:Math.min(j,re),width:l?ce:c,height:l?c:ce},Ge={x:X.x+X.width/2,y:X.y+X.height/2},Fe=P?K:$,pe=Math.floor(a.strokeWidth)%2/2,Oe=p?K:Fe,le=p?Fe:K;let fe,ke;l?(fe={x:Oe+pe,y:X.y},ke={x:le+pe,y:X.y+X.height}):(fe={x:X.x,y:Oe+pe},ke={x:X.x+X.width,y:le+pe});const dt={x:p?ke.x:fe.x,y:p?ke.y:fe.y,x2:p?fe.x:ke.x,y2:p?fe.y:ke.y,size:0};f.push(dt);const Pt=Q==="subtotal"?"total":Q,pi=this.getLabelText(J,{itemId:Pt,value:U,datum:M,xKey:x,yKey:A,xName:k,yName:I}),Vi={index:E,series:this,itemId:Q,datum:M,datumIndex:E,cumulativeValue:V??0,xValue:B,yValue:U,yKey:A,xKey:x,x:X.x,y:X.y,width:X.width,height:X.height,midPoint:Ge,crisp:v,label:{text:pi,...uN({isUpward:(U??-1)>=0!==d,isVertical:!l,placement:J.placement,padding:J.padding,rect:X})}};u.nodeData.push(Vi),u.labelData.push(Vi)});const L=this.properties.line.enabled;return S!=null&&L&&(u.pointData=f),u}updateSeriesItemTypes(){const{dataModel:e,seriesItemTypes:t,processedData:i}=this;if(!e||!i)return;t.clear();const o=e.resolveProcessedDataIndexById(this,"yCurrentPositive"),s=e.resolveProcessedDataIndexById(this,"yCurrentNegative"),a=e.resolveProcessedDataIndexById(this,"totalTypeValue"),n=i.domain.values[o]??[],r=i.domain.values[s]??[];n.length>0&&t.add("positive"),r.length>0&&t.add("negative");const l=i?.domain.values[a];l&&l.forEach(c=>{(c==="total"||c==="subtotal")&&t.add("total")})}isSubtotal(e){return e==="subtotal"}isTotal(e){return e==="total"}nodeFactory(){return new IN}getSeriesItemType(e,t){return t??(e?"positive":"negative")}getItemConfig(e){switch(e){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,o=t??[];return i.update(o)}getItemStyle(e,t,i,o){const{id:s,properties:a}=this,n=a.item[i==="subtotal"?"total":i],r=o?a.highlightStyle.item:void 0,{itemStyler:l,fillGradientDefaults:c,fillPatternDefaults:p}=n,{xKey:d,yKey:u}=a,f=Tl({fill:r?.fill??n.fill,fillOpacity:r?.fillOpacity??n.fillOpacity,stroke:r?.stroke??n.stroke,strokeWidth:r?.strokeWidth??n.strokeWidth,strokeOpacity:r?.strokeOpacity??n.strokeOpacity,lineDash:r?.lineDash??n.lineDash??[],lineDashOffset:r?.lineDashOffset??n.lineDashOffset,cornerRadius:n.cornerRadius},c,p);if(l!=null){let y=this.cachedDatumCallback(mN(e,o?"highlight":"node"),()=>this.callWithContext(l,{seriesId:s,itemId:i,datum:t,xKey:d,yKey:u,highlighted:o,...f}));y=Tl(y,c,p),Object.assign(f,y)}return f}updateDatumNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getCategoryDirection()===Al.X,s=this.getShapeFillBBox();t.each((a,n)=>{const r=n.itemId,l=this.getItemStyle(String(n.datumIndex),n.datum,r,i);LN(a,l,void 0,s),a.visible=o?n.width>0:n.height>0,a.crisp=n.crisp})}updateLabelSelection(e){const{labelData:t,labelSelection:i}=e;if(t.length===0)return i.update([]);const o=t.filter(s=>{const{label:a}=this.getItemConfig(s.itemId);return a.enabled});return i.update(o)}updateLabelNodes(e){e.labelSelection.each((t,i)=>{bN(t,this.getItemConfig(i.itemId).label,i.label)})}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yKey:r,yName:l,tooltip:c}=s,p=this.getCategoryAxis(),d=this.getValueAxis();if(!i||!o||!p||!d)return;const u=o.dataSources.get(this.id)?.[e],f=i.resolveKeysById(this,"xValue",o)[e],y=i.resolveColumnById(this,"yRaw",o)[e],g=i.resolveColumnById(this,"yCurrentTotal",o),m=i.resolveColumnById(this,"totalTypeValue",o);if(f==null)return;const S=m[e],D=(y??0)>=0,b=this.getSeriesItemType(D,S);let v;if(this.isTotal(S))v=g[e];else if(this.isSubtotal(S)){v=g[e];for(let T=e-1;T>=0;T-=1)if(this.isSubtotal(m[T])){v=v-g[T];break}}else v=y;const R=this.getItemStyle(String(e),u,b,!1);return c.formatTooltip(this.properties,{heading:p.formatDatum(f),symbol:this.legendItemSymbol(b),data:[{label:l,fallbackLabel:r,value:d.formatDatum(v)}]},{seriesId:t,datum:u,title:l,itemId:b,xKey:a,xName:n,yKey:r,yName:l,...R})}legendItemSymbol(e){const{fill:t,stroke:i,fillOpacity:o,strokeOpacity:s,strokeWidth:a,lineDash:n,lineDashOffset:r,fillGradientDefaults:l,fillPatternDefaults:c}=this.getItemConfig(e);return{marker:Tl({fill:t,stroke:i,fillOpacity:o,strokeOpacity:s,strokeWidth:a,lineDash:n,lineDashOffset:r},l,c)}}getLegendData(e){if(e!=="category")return[];const{id:t,seriesItemTypes:i}=this,o=[],s=n=>n.charAt(0).toUpperCase()+n.substring(1),{showInLegend:a}=this.properties;return i.forEach(n=>{const{name:r}=this.getItemConfig(n);o.push({legendType:"category",id:t,itemId:n,seriesId:t,enabled:!0,label:{text:r??s(n)},symbol:this.legendItemSymbol(n),hideInLegend:!a,isFixed:!0})}),o}toggleSeriesItem(){}animateEmptyUpdateReady(e){const{datumSelection:t,labelSelection:i,contextData:o}=e,s=DN(xN(this.isVertical(),this.axes,"normal"));MN.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s),ON(this,"labels",this.ctx.animationManager,i);const{pointData:a}=o;a&&(this.isVertical()?this.animateConnectorLinesVertical(e):this.animateConnectorLinesHorizontal(e))}animateConnectorLinesHorizontal(e){const{pointData:t=[]}=e.contextData,[i]=e.paths,{path:o}=i;this.updateLineNode(i);const s=this.getValueAxis(),a=s?.isReversed(),n=a?(p,d)=>p<d:(p,d)=>p>d,r=s?.scale.convert(0),l=t.reduce((p,d)=>(n(d.x,p)&&(p=d.x),p),a?1/0:0),c=(p,d,u,f,y)=>(p-d)/(u-d)*(y-f)+f;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:Qi.Motion.easeOut,collapsable:!1,onUpdate(p){o.clear(!0),t.forEach((d,u)=>{const f=c(p,r,l,r,d.x),y=c(p,r,l,r,d.x2);u!==0&&o.lineTo(f,d.y),o.moveTo(y,d.y2)}),i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(e)})}animateConnectorLinesVertical(e){const{pointData:t=[]}=e.contextData,[i]=e.paths,{path:o}=i;this.updateLineNode(i);const s=this.getValueAxis(),a=s?.isReversed(),n=a?(p,d)=>p>d:(p,d)=>p<d,r=s?.scale.convert(0),l=t.reduce((p,d)=>(n(d.y,p)&&(p=d.y),p),a?0:1/0),c=(p,d,u,f,y)=>(p-d)/(u-d)*(y-f)+f;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:Qi.Motion.easeOut,collapsable:!1,onUpdate(p){o.clear(!0),t.forEach((d,u)=>{const f=c(p,r,l,r,d.y),y=c(p,r,l,r,d.y2);u!==0&&o.lineTo(d.x,f),o.moveTo(d.x2,y)}),i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(e)})}animateReadyResize(e){super.animateReadyResize(e),this.resetConnectorLinesPath(e)}updatePaths(e){this.resetConnectorLinesPath({contextData:e.contextData,paths:e.paths})}resetConnectorLinesPath({contextData:e,paths:t}){if(t.length===0)return;const[i]=t;this.updateLineNode(i);const{path:o}=i;o.clear(!0);const{pointData:s}=e;s&&(s.forEach((a,n)=>{n!==0&&o.lineTo(a.x,a.y),o.moveTo(a.x2,a.y2)}),i.checkPathDirty())}updateLineNode(e){const{stroke:t,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}=this.properties.line;e.setProperties({fill:void 0,stroke:t,strokeWidth:this.getStrokeWidth(i),strokeOpacity:o,lineDash:s,lineDashOffset:a,lineJoin:"round",pointerEvents:Qi.PointerEvents.None})}isLabelEnabled(){const{positive:e,negative:t,total:i}=this.properties.item;return e.label.enabled||t.label.enabled||i.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:e}){return TN(this,this.contextNodeData?.nodeData[e])}};Ga.className="WaterfallSeries",Ga.type="waterfall";import{_ModuleSupport as CN}from"ag-charts-community";import{arrayOfDefs as PN,boolean as mu,callback as EN,constant as wN,fillOptionsDef as _N,lineDashOptionsDef as Su,positiveNumber as Il,required as _o,string as Bo,strokeOptionsDef as bu,union as Ml}from"ag-charts-core";var{commonSeriesOptionsDefs:BN,seriesLabelOptionsDefs:GN,shadowOptionsDefs:FN,tooltipOptionsDefs:Du}=CN,Ll={name:Bo,cornerRadius:Il,itemStyler:EN,label:{...GN,padding:Il,placement:Ml("inside-start","inside-center","inside-end","outside-start","outside-end")},tooltip:Du,shadow:FN,..._N,...bu,...Su},VN={type:_o(wN("waterfall")),xKey:_o(Bo),yKey:_o(Bo),xName:Bo,yName:Bo,direction:Ml("horizontal","vertical"),totals:PN({totalType:_o(Ml("total","subtotal")),index:_o(Il),axisLabel:_o(Bo)},"a total definition options array"),showInMiniChart:mu,item:{positive:Ll,negative:Ll,total:Ll},line:{enabled:mu,...bu,...Su},tooltip:Du,...BN};import{_ModuleSupport as WN}from"ag-charts-community";function Cl(e,t){return{fill:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$path:[`./${t}`,{$palette:"fill"},{$palette:"fills"}]},{$palette:`${e}.fill`}]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$if:[{$or:[{$isGradient:[{$palette:`${e}.fill`}]},{$isPattern:[{$palette:`${e}.fill`}]}]},{$map:[{$path:["./color",void 0,{$value:"$1"}]},{$path:["./colorStops",void 0,{$palette:`${e}.fill`}]}]},[{$mix:[{$palette:`${e}.fill`},"black",.15]},{$mix:[{$palette:`${e}.fill`},"white",.15]}]]},rotation:0,reverse:!1},fillPatternDefaults:WN.FILL_PATTERN_DEFAULTS,stroke:{$palette:`${e}.stroke`},strokeWidth:0,label:{enabled:!1,fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},formatter:void 0,placement:"outside-end"}}}var KN={series:{item:{positive:Cl("altUp",0),negative:Cl("altDown",1),total:Cl("neutral",2)},line:{stroke:{$palette:"neutral.stroke"},strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2}},legend:{enabled:!0,toggleSeries:!1}},QG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"waterfall",solo:!0,moduleFactory:e=>new Ga(e),tooltipDefaults:{range:"exact"},defaultAxes:ZR.DIRECTION_SWAP_AXES,themeTemplate:KN},Pl={type:"series",name:"waterfall",chartType:"cartesian",enterprise:!0,options:VN,create:e=>new Ga(e)},{NewAreaSeriesModule:zN,NewBarSeriesModule:$N,NewBubbleSeriesModule:HN,NewHistogramSeriesModule:YN,NewLineSeriesModule:XN,NewScatterSeriesModule:UN,numberFormatValidator:qN,without:mt}=nx,xu={width:xt,height:xt,grip:ns,fill:fa,stroke:fa,strokeWidth:xt,cornerRadius:xt},St=["cursor","highlightStyle","listeners","nodeClickRange","showInLegend","showInMiniChart","tooltip","visible","xName","yName"],jN={enabled:ns,height:xt,spacing:xt,cornerRadius:Ph,mask:{fill:fa,fillOpacity:hx,stroke:fa,strokeWidth:xt},minHandle:xu,maxHandle:xu,miniChart:{enabled:ns,padding:{top:xt,bottom:xt},label:{enabled:ns,avoidCollisions:ns,spacing:xt,format:qN,formatter:cx,interval:{minSpacing:xt,maxSpacing:xt,values:rx,step:Ph},...px},series:lx(dx({area:mt(zN.options,St),bar:mt($N.options,[...St,"errorBar","label","legendItemName","direction"]),"box-plot":mt(Fr.options,[...St,"direction","legendItemName","minName","q1Name","medianName","q3Name","maxName"]),bubble:mt(HN.options,[...St,"title","label","labelKey","labelName","sizeName"]),candlestick:mt(ol.options,St),heatmap:mt(ll.options,[...St,"title","label","colorName","textAlign","verticalAlign","itemPadding","colorRange"]),histogram:mt(YN.options,[...St,"label"]),line:mt(XN.options,[...St,"errorBar","title","label"]),ohlc:mt(pl.options,St),"range-area":mt(Sl.options,[...St,"label","yLowName","yHighName"]),"range-bar":mt(Ol.options,[...St,"direction","label","yLowName","yHighName"]),scatter:mt(UN.options,[...St,"errorBar","title","label","labelKey","labelName"]),waterfall:mt(Pl.options,[...St,"direction"])}))}},JN={type:"plugin",name:"annotations",chartType:"cartesian",options:ss,create(){return null}},ZN={type:"plugin",name:"navigator",chartType:"cartesian",options:jN,create(){return null}},QN={type:"plugin",name:"initialState",options:ax,create(){return null}};import{_ModuleSupport as e0}from"ag-charts-community";import{_ModuleSupport as t0}from"ag-charts-community";import{Logger as i0}from"ag-charts-core";import{_ModuleSupport as vu}from"ag-charts-community";import{Logger as o0}from"ag-charts-core";function Ou(e,t,i){i||(t=s0(t));const o=new Map;for(const a of e)o.set(a.id,{datum:a,linksBefore:[],linksAfter:[],maxPathLengthBefore:-1,maxPathLengthAfter:-1});let s=0;return o.forEach((a,n)=>{s=Math.max(s,El(o,t,a,n,-1,[])+El(o,t,a,n,1,[])+1)}),{links:t,nodeGraph:o,maxPathLength:s}}function ku(e,t,i,o){const s=o.indexOf(t);if(s!==-1){for(let n=s;n<o.length;n+=1)i.add(o[n]);return}o.push(t);const{toNode:a}=t;for(const n of e)n.fromNode===a&&ku(e,n,i,o);o.pop()}function s0(e){const t=new Set;for(const i of e)ku(e,i,t,[]);return t.size!==0&&o0.warnOnce("Some links formed circular references. These will be removed from the output."),t.size===0?e:e.filter(i=>!t.has(i))}function El(e,t,i,o,s,a){if(a.includes(o))return 1/0;let n=s===-1?i.maxPathLengthBefore:i.maxPathLengthAfter;if(n===-1){n=0;const r=s===-1?i.linksBefore:i.linksAfter;for(const l of t){const{fromNode:c,toNode:p}=l,d=s===-1?p.id:c.id,u=s===-1?c.id:p.id,f=o===d?e.get(u):void 0;f!=null&&(r.push({node:f,link:l}),a?.push(o),n=Math.max(n,El(e,t,f,u,s,a)+1),a?.pop())}s===-1?i.maxPathLengthBefore=n:i.maxPathLengthAfter=n}return n}var{Series:a0,DataController:n0,keyProperty:r0,valueProperty:Fa,Selection:to,Group:Go,TransformableText:l0}=vu,c0=class extends vu.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o);const{datumIndex:s}=i,a=o.contextNodeData?.nodeData.find(n=>n.datumIndex.type===s.type&&n.datumIndex.index===s.index);this.size=a?.size,this.label=a?.type===1?a?.label:void 0}},Ru=class extends a0{constructor(){super(...arguments),this.NodeEvent=c0,this._chartNodes=void 0,this.nodeCount=0,this.linkCount=0,this.linksDataModel=void 0,this.linksProcessedData=void 0,this.nodesDataModel=void 0,this.nodesProcessedData=void 0,this.processedNodes=new Map,this.linkGroup=this.contentGroup.appendChild(new Go({name:"linkGroup"})),this.nodeGroup=this.contentGroup.appendChild(new Go({name:"nodeGroup"})),this.focusLinkGroup=this.highlightNode.appendChild(new Go({name:"linkGroup"})),this.focusNodeGroup=this.highlightNode.appendChild(new Go({name:"nodeGroup"})),this.highlightLinkGroup=this.highlightNode.appendChild(new Go({name:"linkGroup"})),this.highlightNodeGroup=this.highlightNode.appendChild(new Go({name:"nodeGroup"})),this.labelSelection=to.select(this.labelGroup,l0),this.linkSelection=to.select(this.linkGroup,()=>this.linkFactory()),this.nodeSelection=to.select(this.nodeGroup,()=>this.nodeFactory()),this.focusLinkSelection=to.select(this.focusLinkGroup,()=>this.linkFactory()),this.focusNodeSelection=to.select(this.focusNodeGroup,()=>this.nodeFactory()),this.highlightLinkSelection=to.select(this.highlightLinkGroup,()=>this.linkFactory()),this.highlightNodeSelection=to.select(this.highlightNodeGroup,()=>this.nodeFactory())}get nodes(){return this.properties.nodes??this._chartNodes}setChartNodes(e){this._chartNodes=e,this.nodes===e&&(this.nodeDataRefresh=!0)}async processData(e){const{data:t,nodes:i}=this;if(t==null||!this.properties.isValid())return;const{fromKey:o,toKey:s,sizeKey:a,idKey:n,labelKey:r}=this.properties,l=new n0("standalone",e.suppressFieldDotNotation),c=i!=null?l.request(this.id,i,{props:[r0(n,void 0,{id:"idValue",includeProperty:!1}),...r!=null?[Fa(r,void 0,{id:"labelValue",includeProperty:!1})]:[]],groupByKeys:!0}):null,p=e.request(this.id,t,{props:[Fa(o,void 0,{id:"fromValue",includeProperty:!1}),Fa(s,void 0,{id:"toValue",includeProperty:!1}),...a!=null?[Fa(a,void 0,{id:"sizeValue",includeProperty:!1,missingValue:0})]:[]],groupByKeys:!1});i!=null&&l.execute();const[d,u]=await Promise.all([c,p]);this.nodesDataModel=d?.dataModel,this.nodesProcessedData=d?.processedData,this.linksDataModel=u?.dataModel,this.linksProcessedData=u?.processedData;const f=new Map;if(d==null){const y=u.dataModel.resolveColumnById(this,"fromValue",u.processedData),g=u.dataModel.resolveColumnById(this,"toValue",u.processedData),m=S=>{const D=f.size;return{series:this,itemId:void 0,datum:{},datumIndex:{type:1,index:D},type:1,index:D,linksBefore:[],linksAfter:[],id:S,size:0,label:S}};u.processedData.dataSources.get(this.id)?.forEach((S,D)=>{const b=y[D],v=g[D];b==null||v==null||(f.has(b)||f.set(b,m(b)),f.has(v)||f.set(v,m(v)))})}else{const y=d.dataModel.resolveColumnById(this,"idValue",d.processedData),g=r!=null?d.dataModel.resolveColumnById(this,"labelValue",d.processedData):void 0;d.processedData.dataSources.get(this.id)?.forEach((m,S)=>{const D=y[S],b=g?.[S];f.set(D,{series:this,itemId:void 0,datum:m,datumIndex:{type:1,index:S},type:1,index:S,linksBefore:[],linksAfter:[],id:D,size:0,label:b})})}this.processedNodes=f}getNodeGraph(e,t,{includeCircularReferences:i}){const{linksDataModel:o,linksProcessedData:s}=this;if(o==null||s==null){const{links:y,nodeGraph:g,maxPathLength:m}=Ou(new Map().values(),[],i);return this.nodeCount=0,this.linkCount=0,{nodeGraph:g,links:y,maxPathLength:m}}const{sizeKey:a}=this.properties,n=o.resolveColumnById(this,"fromValue",s),r=o.resolveColumnById(this,"toValue",s),l=a!=null?o.resolveColumnById(this,"sizeValue",s):void 0,c=new Map;this.processedNodes.forEach(y=>{const g=e(y);c.set(y.id,g)});const p=[];s.dataSources.get(this.id)?.forEach((y,g)=>{const m=n[g],S=r[g],D=l!=null?l[g]:1,b=c.get(m),v=c.get(S);if(D<=0||b==null||v==null)return;const R=t({series:this,itemId:void 0,datum:y,datumIndex:{type:0,index:g},type:0,index:g,fromNode:b,toNode:v,size:D});p.push(R)});const{links:d,nodeGraph:u,maxPathLength:f}=Ou(c.values(),p,i);return u.forEach(y=>{y.datum.linksBefore=y.linksBefore.map(g=>g.link),y.datum.linksAfter=y.linksAfter.map(g=>g.link)}),this.nodeCount=u.size,this.linkCount=d.length,{nodeGraph:u,links:d,maxPathLength:f}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(e){const{seriesRect:t}=e,i={seriesRectWidth:t?.width??0,seriesRectHeight:t?.height??0};(this._nodeDataDependencies==null||this._nodeDataDependencies.seriesRectWidth!==i.seriesRectWidth||this._nodeDataDependencies.seriesRectHeight!==i.seriesRectHeight)&&(this._nodeDataDependencies=i),this.updateSelections();const o=this.contextNodeData?.nodeData??[],s=this.contextNodeData?.labelData??[];let a=this.ctx.highlightManager?.getActiveHighlight();if(a?.series===this&&a.type==null){const{itemId:p}=a;a=p!=null?o.find(d=>d.type===1&&d.id===p):void 0}else a?.series!==this&&(a=void 0);this.contentGroup.visible=this.visible,this.contentGroup.opacity=a!=null?this.properties.highlightStyle.series.dimOpacity??1:1,this.labelSelection=this.updateLabelSelection({labelData:s,labelSelection:this.labelSelection}),this.updateLabelNodes({labelSelection:this.labelSelection}),this.linkSelection=this.updateLinkSelection({nodeData:o.filter(p=>p.type===0),datumSelection:this.linkSelection}),this.updateLinkNodes({datumSelection:this.linkSelection,isHighlight:!1}),this.nodeSelection=this.updateNodeSelection({nodeData:o.filter(p=>p.type===1),datumSelection:this.nodeSelection}),this.updateNodeNodes({datumSelection:this.nodeSelection,isHighlight:!1});let n,r,l,c;a?.type===1?(n=o.filter(p=>p.type===0&&(p.toNode===a||p.fromNode===a)),r=n.map(p=>p.fromNode===a?p.toNode:p.fromNode),r.push(a),l=[],c=[a]):a?.type===0?(n=[a],r=[a.fromNode,a.toNode],l=[a],c=[]):(n=[],r=[],l=[],c=[]),this.focusLinkSelection=this.updateLinkSelection({nodeData:n,datumSelection:this.focusLinkSelection}),this.updateLinkNodes({datumSelection:this.focusLinkSelection,isHighlight:!1}),this.focusNodeSelection=this.updateNodeSelection({nodeData:r,datumSelection:this.focusNodeSelection}),this.updateNodeNodes({datumSelection:this.focusNodeSelection,isHighlight:!1}),this.highlightLinkSelection=this.updateLinkSelection({nodeData:l,datumSelection:this.highlightLinkSelection}),this.updateLinkNodes({datumSelection:this.highlightLinkSelection,isHighlight:!0}),this.highlightNodeSelection=this.updateNodeSelection({nodeData:c,datumSelection:this.highlightNodeSelection}),this.updateNodeNodes({datumSelection:this.highlightNodeSelection,isHighlight:!0})}resetAnimation(e){}getSeriesDomain(e){return[]}getSeriesRange(e,t){return[NaN,NaN]}legendItemSymbol(e,t,i={}){const{fills:o,strokes:s}=this.properties,{fill:a=o[t%o.length],fillOpacity:n=1,stroke:r=s[t%s.length],strokeWidth:l=0,strokeOpacity:c=1,lineDash:p=[0],lineDashOffset:d=0}=i;return{marker:{fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:p,lineDashOffset:d}}}getLegendData(e){if(e!=="category")return[];const{showInLegend:t}=this.properties;return Array.from(this.processedNodes.values(),({id:i,label:o},s)=>({legendType:"category",id:this.id,itemId:i,seriesId:this.id,enabled:!0,label:{text:o??i},symbol:this.legendItemSymbol(1,s),hideInLegend:!t,isFixed:!0}))}pickNodeClosestDatum({x:e,y:t}){let i=1/0,o;return this.linkSelection.each((s,a)=>{const n=s.containsPoint(e,t)?0:1/0;n<i&&(i=n,o=a)}),this.nodeSelection.each((s,a)=>{const n=s.distanceSquared(e,t);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}getDatumAriaText(e,t){if(e.type===0)return this.ctx.localeManager.t("ariaAnnounceFlowProportionLink",{index:e.index+1,count:this.linkCount,from:e.fromNode.id,to:e.toNode.id,size:e.size,sizeName:this.properties.sizeName??this.properties.sizeKey});if(e.type===1)return this.ctx.localeManager.t("ariaAnnounceFlowProportionNode",{index:e.index+1,count:this.nodeCount,description:t})}pickFocus(e){const{datumIndexDelta:t,otherIndexDelta:i}=e,o=this.contextNodeData?.nodeData[e.datumIndex-e.datumIndexDelta];let s=o;if(i!==0||t===0)return;if(o?.type===0){const r=Array.from(this.linkSelection,p=>p.datum),c=r.indexOf(o)+t;if(c>=0&&c<r.length)s=r[c];else if(c>0)s=r[r.length-1];else{const p=Array.from(this.nodeSelection,d=>d.datum);s=p[p.length-1]}}else if(o?.type===1){const r=Array.from(this.nodeSelection,p=>p.datum),c=r.indexOf(o)+t;c>=0&&c<r.length?s=r[c]:c<0?s=r[0]:s=Array.from(this.linkSelection,d=>d.datum)[0]}if(s==null)return;const a=s.type===1?Array.from(this.nodeSelection).find(r=>r.datum===s):Array.from(this.linkSelection).find(r=>r.datum===s);if(a==null)return;const n=this.computeFocusBounds(a.node);if(n!=null)return{datum:a.datum,datumIndex:this.contextNodeData?.nodeData.indexOf(a.datum)??0,otherIndex:0,bounds:n,clipFocusBox:!0}}getCategoryValue(e){}datumIndexForCategoryValue(e){}};import{_ModuleSupport as p0}from"ag-charts-community";var{BBox:h0,Path:d0,ScenePathChangeDetection:Ni}=p0;function Va({radius:e,startAngle:t,endAngle:i,tension:o}){const s=e*Math.cos(t),a=e*Math.sin(t),n=e*Math.cos(i),r=e*Math.sin(i),l=s*o,c=a*o,p=n*o,d=r*o;return{x:[s,l,p,n],y:[a,c,d,r]}}var ui=class extends d0{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=0,this.startAngle1=0,this.endAngle1=0,this.startAngle2=0,this.endAngle2=0,this.tension=1}computeBBox(){const{centerX:e,centerY:t,radius:i,startAngle1:o,endAngle1:s,startAngle2:a,endAngle2:n,tension:r}=this,l=Va({radius:i,startAngle:o,endAngle:n,tension:r}),c=Va({radius:i,startAngle:a,endAngle:s,tension:r}),p=Math.min(...l.x,...c.x),d=Math.max(...l.x,...c.x)-p,u=Math.min(...l.y,...c.y),f=Math.max(...l.y,...c.y)-u;return new h0(e+p,t+u,d,f)}isPointInPath(e,t){return super.isPointInPath(e,t)&&this.getBBox().containsPoint(e,t)}tensionedCurveTo(e,t,i,o,s,a,n,r){const{path:l,tension:c}=this,p=1-c;l.cubicCurveTo((i-e)*p+e,(o-t)*p+t,(s-n)*p+n,(a-r)*p+r,n,r)}updatePath(){const{path:e,centerX:t,centerY:i,radius:o}=this;let{startAngle1:s,endAngle1:a,startAngle2:n,endAngle2:r}=this;s>n&&([s,n]=[n,s],[a,r]=[r,a]),e.clear();const l=t+o*Math.cos(s),c=i+o*Math.sin(s);e.moveTo(l,c),this.tensionedCurveTo(l,c,t,i,t,i,t+o*Math.cos(r),i+o*Math.sin(r)),e.arc(t,i,o,r,n,!0),this.tensionedCurveTo(t+o*Math.cos(n),i+o*Math.sin(n),t,i,t,i,t+o*Math.cos(a),i+o*Math.sin(a)),e.arc(t,i,o,a,s,!0),e.closePath()}};h([Ni()],ui.prototype,"centerX",2),h([Ni()],ui.prototype,"centerY",2),h([Ni()],ui.prototype,"radius",2),h([Ni()],ui.prototype,"startAngle1",2),h([Ni()],ui.prototype,"endAngle1",2),h([Ni()],ui.prototype,"startAngle2",2),h([Ni()],ui.prototype,"endAngle2",2),h([Ni()],ui.prototype,"tension",2);import{_ModuleSupport as u0}from"ag-charts-community";var{FillGradientDefaults:f0,FillPatternDefaults:g0,BaseProperties:Nu,SeriesTooltip:y0,SeriesProperties:m0,ARRAY:S0,ARRAY_OF:b0,COLOR_STRING:xs,COLOR_STRING_ARRAY:D0,FUNCTION:Au,LINE_DASH:Tu,OBJECT:Fo,POSITIVE_NUMBER:Ai,RATIO:vs,STRING:Ti,OR:wl,COLOR_GRADIENT:_l,TempValidate:oe,COLOR_PATTERN:Bl,Label:x0}=u0,Gl=class extends x0{constructor(){super(...arguments),this.spacing=1,this.maxWidth=1}};h([oe(Ai)],Gl.prototype,"spacing",2),h([oe(Ai)],Gl.prototype,"maxWidth",2);var si=class extends Nu{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0,this.tension=0}};h([oe(wl(_l,xs,Bl),{optional:!0})],si.prototype,"fill",2),h([oe(vs)],si.prototype,"fillOpacity",2),h([oe(xs,{optional:!0})],si.prototype,"stroke",2),h([oe(vs)],si.prototype,"strokeOpacity",2),h([oe(Ai)],si.prototype,"strokeWidth",2),h([oe(Tu)],si.prototype,"lineDash",2),h([oe(Ai)],si.prototype,"lineDashOffset",2),h([oe(vs)],si.prototype,"tension",2),h([oe(Au,{optional:!0})],si.prototype,"itemStyler",2);var Ht=class extends Nu{constructor(){super(...arguments),this.spacing=1,this.width=1,this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};h([oe(Ai)],Ht.prototype,"spacing",2),h([oe(Ai)],Ht.prototype,"width",2),h([oe(wl(_l,xs,Bl),{optional:!0})],Ht.prototype,"fill",2),h([oe(vs)],Ht.prototype,"fillOpacity",2),h([oe(xs,{optional:!0})],Ht.prototype,"stroke",2),h([oe(vs)],Ht.prototype,"strokeOpacity",2),h([oe(Ai)],Ht.prototype,"strokeWidth",2),h([oe(Tu)],Ht.prototype,"lineDash",2),h([oe(Ai)],Ht.prototype,"lineDashOffset",2),h([oe(Au,{optional:!0})],Ht.prototype,"itemStyler",2);var ze=class extends m0{constructor(){super(...arguments),this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.nodes=void 0,this.fillGradientDefaults=new f0,this.fillPatternDefaults=new g0,this.fills=[],this.strokes=[],this.label=new Gl,this.link=new si,this.node=new Ht,this.tooltip=new y0}};h([oe(Ti)],ze.prototype,"fromKey",2),h([oe(Ti)],ze.prototype,"toKey",2),h([oe(Ti)],ze.prototype,"idKey",2),h([oe(Ti,{optional:!0})],ze.prototype,"idName",2),h([oe(Ti,{optional:!0})],ze.prototype,"labelKey",2),h([oe(Ti,{optional:!0})],ze.prototype,"labelName",2),h([oe(Ti,{optional:!0})],ze.prototype,"sizeKey",2),h([oe(Ti,{optional:!0})],ze.prototype,"sizeName",2),h([oe(S0,{optional:!0})],ze.prototype,"nodes",2),h([oe(Fo)],ze.prototype,"fillGradientDefaults",2),h([oe(Fo)],ze.prototype,"fillPatternDefaults",2),h([oe(b0(wl(_l,xs,Bl)))],ze.prototype,"fills",2),h([oe(D0)],ze.prototype,"strokes",2),h([oe(Fo)],ze.prototype,"label",2),h([oe(Fo)],ze.prototype,"link",2),h([oe(Fo)],ze.prototype,"node",2),h([oe(Fo)],ze.prototype,"tooltip",2);var{SeriesNodePickMode:Iu,CachedTextMeasurerPool:v0,TextWrapper:O0,TextUtils:k0,createDatumId:Wa,angleBetween:Ka,normalizeAngle360:R0,isBetweenAngles:Mu,Sector:N0,evaluateBezier:za,applyShapeStyle:Lu,getShapeStyle:$a,BBox:A0}=t0,Ha=e=>e.startAngle+Ka(e.startAngle,e.endAngle)/2,Ya=class extends Ru{constructor(e){super({moduleCtx:e,pickModes:[Iu.NEAREST_NODE,Iu.EXACT_SHAPE_MATCH]}),this.properties=new ze}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new ui}nodeFactory(){return new N0}createNodeData(){const{id:e,_nodeDataDependencies:{seriesRectWidth:t,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:o,toKey:s,sizeKey:a,label:{spacing:n,maxWidth:r,fontSize:l},node:{width:c,spacing:p}}=this.properties,d=t/2,u=i/2;let f=[];const{nodeGraph:y,links:g}=this.getNodeGraph(L=>({...L,centerX:d,centerY:u,innerRadius:NaN,outerRadius:NaN,startAngle:NaN,endAngle:NaN}),L=>({...L,centerX:d,centerY:u,radius:NaN,startAngle1:NaN,endAngle1:NaN,startAngle2:NaN,endAngle2:NaN}),{includeCircularReferences:!0});let m=0;y.forEach(({datum:L,linksBefore:M,linksAfter:E},C)=>{const w=M.reduce((G,{link:P})=>G+P.size,0)+E.reduce((G,{link:P})=>G+P.size,0);if(w===0)y.delete(C);else{L.size=w,m+=L.size;const G=this.getLabelText(this.properties.label,{datum:L.datum,value:L.label,fromKey:o,toKey:s,sizeKey:a,size:L.size});L.label=String(G)}});let S=0;if(this.isLabelEnabled()){const L=this.properties.label.getFont();let M=0;y.forEach(({datum:E})=>{const{id:C,label:w}=E;if(w==null)return;const G=O0.wrapText(w,{maxWidth:r,font:this.properties.label,textWrap:"never"}),{width:P}=v0.measureText(G,{font:L,textAlign:"left",textBaseline:"middle"});M=Math.max(P,M),f.push({id:C,text:G,centerX:d,centerY:u,angle:NaN,radius:NaN})}),S=M+n}const D=y.size;let b=Math.min(t,i)/2-c-S,v=p/b;if(S!==0&&(D*v>=1.5*Math.PI||b<=0)&&(f=[],b=Math.min(t,i)/2-c,v=p/b),D*v>=2*Math.PI||b<=0){i0.warnOnce("There was insufficient space to display the Chord Series.");return}const R=b,T=b+c,O=Math.max((2*Math.PI-D*v)/m,0);let x=0;y.forEach(({datum:L})=>{L.innerRadius=R,L.outerRadius=T,L.startAngle=x,L.endAngle=x+L.size*O,x=L.endAngle+v;const M=(L.innerRadius+L.outerRadius)/2,E=Ha(L);L.midPoint={x:L.centerX+M*Math.cos(E),y:L.centerY+M*Math.sin(E)}});const A=[];y.forEach(({datum:L,linksBefore:M,linksAfter:E})=>{const C=Ha(L),w=[...M.map(P=>({link:P.link,distance:Ka(Ha(P.node.datum),C),after:!1})),...E.map(P=>({link:P.link,distance:Ka(Ha(P.node.datum),C),after:!0}))];let G=L.startAngle;w.toSorted((P,B)=>P.distance-B.distance).forEach(({link:P,after:B})=>{const _=P.size*O;B?(P.startAngle1=G,P.endAngle1=G+_):(P.startAngle2=G,P.endAngle2=G+_),G+=P.size*O}),A.push(L)});const{tension:k}=this.properties.link;g.forEach(L=>{L.radius=b;const M=Va({radius:b,startAngle:L.startAngle1,endAngle:L.endAngle2,tension:k}),E=Va({radius:b,startAngle:L.startAngle2,endAngle:L.endAngle1,tension:k}),C=za(...M.x,.5),w=za(...M.y,.5),G=za(...E.x,.5),P=za(...E.y,.5);L.midPoint={x:L.centerX+(C+G)/2,y:L.centerY+(w+P)/2},A.push(L)}),f.forEach(L=>{const M=y.get(L.id)?.datum;M!=null&&(L.radius=T+n,L.angle=R0(M.startAngle+Ka(M.startAngle,M.endAngle)/2))}),f.sort((L,M)=>L.angle-M.angle);let I=1/0,N=-1/0;return f=f.filter(L=>{const M=k0.getLineHeight(l),E=Math.atan2(M/2,L.radius),C=L.angle-E,w=L.angle+E;return Mu(I,C,w)||Mu(N,C,w)?!1:(I=Math.min(C,I),N=Math.max(w,N),!0)}),{itemId:e,nodeData:A,labelData:f}}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;t.each((r,{text:l,centerX:c,centerY:p,radius:d,angle:u})=>{r.visible=!0,r.translationX=c+d*Math.cos(u),r.translationY=p+d*Math.sin(u),r.text=l,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textBaseline="middle",Math.cos(u)>=0?(r.textAlign="left",r.rotation=u):(r.textAlign="right",r.rotation=u-Math.PI)})}updateNodeSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>Wa([t.type,t.id]))}getBaseNodeStyle(e){const{properties:t}=this,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=t.node,l=e?t.highlightStyle.item:void 0;return $a({fill:l?.fill??i,fillOpacity:l?.fillOpacity??o,stroke:l?.stroke??s,strokeOpacity:l?.strokeOpacity??a,strokeWidth:l?.strokeWidth??this.getStrokeWidth(t.node.strokeWidth),lineDash:l?.lineDash??n,lineDashOffset:l?.lineDashOffset??r},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}getNodeStyleOverrides(e,t,i,o,s,a,n){const{id:r,properties:l}=this,{fills:c,strokes:p}=l,{itemStyler:d}=l.node,u=a.fill??c[i%c.length],f=a.stroke??p[i%p.length];let y;if(n||(y??(y={}),y.fill=u,y.stroke=f),d!=null){const g=this.cachedDatumCallback(Wa(e,"node",n?"highlight":"node"),()=>{const{fillOpacity:m=1,strokeOpacity:S=1,strokeWidth:D=0,lineDash:b=[],lineDashOffset:v=0}=a;return this.callWithContext(d,{seriesId:r,datum:t,highlighted:n,label:s,size:o,fill:u,fillOpacity:m,stroke:f,strokeOpacity:S,strokeWidth:D,lineDash:b,lineDashOffset:v})});y??(y={}),Object.assign(y,g)}return $a(y,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}updateNodeNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getBaseNodeStyle(i),s=this.getShapeFillBBox();t.each((a,n)=>{const{datumIndex:r,size:l,label:c}=n,p=this.getNodeStyleOverrides(String(r.index),n.datum,r.index,l,c,o,i);Lu(a,o,p,s),a.centerX=n.centerX,a.centerY=n.centerY,a.innerRadius=n.innerRadius,a.outerRadius=n.outerRadius,a.startAngle=n.startAngle,a.endAngle=n.endAngle,a.inset=a.strokeWidth/2})}updateLinkSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>Wa([t.type,t.index,t.fromNode.id,t.toNode.id]))}getBaseLinkStyle(e){const{properties:t}=this,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,tension:l}=t.link,c=e?t.highlightStyle.item:void 0;return $a({fill:c?.fill??i,fillOpacity:c?.fillOpacity??o,stroke:c?.stroke??s,strokeOpacity:c?.strokeOpacity??a,strokeWidth:c?.strokeWidth??this.getStrokeWidth(t.link.strokeWidth),lineDash:c?.lineDash??n,lineDashOffset:c?.lineDashOffset??r,tension:l},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}getLinkStyleOverrides(e,t,i,o,s){const{id:a,properties:n}=this,{fills:r,strokes:l}=n,{itemStyler:c}=n.link,p=o.fill??r[i%r.length],d=o.stroke??l[i%l.length];let u;if(s||(u??(u={}),u.fill=p,u.stroke=d),c!=null){const f=this.cachedDatumCallback(Wa(e,"link",s?"highlight":"node"),()=>{const{fillOpacity:y=1,strokeOpacity:g=1,strokeWidth:m=0,lineDash:S=[],lineDashOffset:D=0,tension:b}=o;return this.callWithContext(c,{seriesId:a,datum:t,highlighted:s,tension:b,fill:p,fillOpacity:y,stroke:d,strokeOpacity:g,strokeWidth:m,lineDash:S,lineDashOffset:D})});u??(u={}),Object.assign(u,f)}return $a(u,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}updateLinkNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getBaseLinkStyle(i),s=this.getShapeFillBBox();t.each((a,n)=>{const{datumIndex:r}=n,l=n.fromNode.datumIndex,c=this.getLinkStyleOverrides(String(r.index),n.datum,l.index,o,i);a.centerX=n.centerX,a.centerY=n.centerY,a.radius=n.radius,a.startAngle1=n.startAngle1,a.endAngle1=n.endAngle1,a.startAngle2=n.startAngle2,a.endAngle2=n.endAngle2,Lu(a,o,c,s),a.tension=c?.tension??o.tension})}getShapeFillBBox(){const e=this._nodeDataDependencies?.seriesRectWidth??0,t=this._nodeDataDependencies?.seriesRectHeight??0,i=Math.min(e,t),o=(e-i)/2,s=(t-i)/2,a=new A0(o,s,e,t);return{series:a,axis:a}}getTooltipContent(e){const{id:t,linksProcessedData:i,nodesProcessedData:o,properties:s}=this,{fromKey:a,toKey:n,sizeKey:r,sizeName:l,tooltip:c}=s,p=this.contextNodeData?.nodeData.find(m=>m.datumIndex.type===e.type&&m.datumIndex.index===e.index);if(p==null)return;const d=p.type===0?p.fromNode.index:p.index,u=p.type===0?`${p.fromNode.label} - ${p.toNode.label}`:p.label,f=e.type===0?i?.dataSources.get(this.id)?.[e.index]:o?.dataSources.get(this.id)?.[e.index],y=p.size;let g;if(p.type===0){const m=p.fromNode.datumIndex,S=this.getBaseLinkStyle(!1);Object.assign(S,this.getLinkStyleOverrides(String(e.index),f,m.index,S,!1)),g=S}else{const m=p.label,S=this.getBaseNodeStyle(!1);Object.assign(S,this.getNodeStyleOverrides(String(e.index),f,e.index,y,m,S,!1)),g=S}return c.formatTooltip(this.properties,{title:u,symbol:this.legendItemSymbol(p.type,d,g),data:r!=null?[{label:l,fallbackLabel:r,value:String(y)}]:[]},{seriesId:t,datum:f,title:u,fromKey:a,toKey:n,sizeKey:r,sizeName:l,size:y,...g})}computeFocusBounds(e){return e}};Ya.className="ChordSeries",Ya.type="chord";import{_ModuleSupport as T0}from"ag-charts-community";import{arrayOf as Cu,callback as Pu,color as I0,colorUnion as M0,constant as L0,fillGradientDefaults as C0,fillOptionsDef as Eu,fillPatternDefaults as P0,lineDashOptionsDef as wu,positiveNumber as Xa,ratio as E0,required as Fl,string as Ua,strokeOptionsDef as _u}from"ag-charts-core";var{commonSeriesOptionsDefs:w0,seriesLabelOptionsDefs:_0,tooltipOptionsDefs:B0}=T0,Vl={type:Fl(L0("chord")),fromKey:Fl(Ua),toKey:Fl(Ua),sizeKey:Ua,sizeName:Ua,fills:Cu(M0),strokes:Cu(I0),label:{spacing:Xa,maxWidth:Xa,..._0},link:{tension:E0,itemStyler:Pu,...Eu,..._u,...wu},node:{width:Xa,spacing:Xa,itemStyler:Pu,...Eu,..._u,...wu},tooltip:B0,...w0};Vl.fillGradientDefaults=C0,Vl.fillPatternDefaults=P0;var cF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"chord",tooltipDefaults:{range:"exact"},moduleFactory:e=>new Ya(e),themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:e0.FILL_PATTERN_DEFAULTS,highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:5,maxWidth:100},node:{spacing:8,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0,tension:.4}},legend:{enabled:!1,toggleSeries:!1}}},Bu={type:"series",name:"chord",chartType:"flow-proportion",enterprise:!0,options:Vl,create:e=>new Ya(e)};import"ag-charts-community";import{_ModuleSupport as Gu}from"ag-charts-community";var{ThemeConstants:{CARTESIAN_AXIS_TYPE:Vo,CARTESIAN_POSITION:Wo},ThemeSymbols:{DEFAULT_SHADOW_COLOUR:G0}}=Gu,dF={$if:[{$eq:[{$path:["/direction",void 0]},"horizontal"]},[{type:Vo.NUMBER,position:Wo.LEFT},{type:Vo.CATEGORY,position:{$if:[{$eq:[{$path:["/stageLabel/placement",void 0]},"before"]},Wo.TOP,Wo.BOTTOM]},label:{$omit:[["placement"],{$path:["/stageLabel",void 0]}]}}],[{type:Vo.CATEGORY,position:{$if:[{$eq:[{$path:["/stageLabel/placement",void 0]},"after"]},Wo.RIGHT,Wo.LEFT]},label:{$omit:[["placement"],{$path:["/stageLabel",void 0]}]}},{type:Vo.NUMBER,position:Wo.BOTTOM}]]},uF={series:{direction:"vertical",strokeWidth:0,spacingRatio:.25,fills:[{$palette:"fill"}],strokes:[{$palette:"stroke"}],fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:Gu.FILL_PATTERN_DEFAULTS,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}},dropOff:{enabled:!0,fillOpacity:.2,strokeWidth:0},shadow:{enabled:!1,color:G0,xOffset:3,yOffset:3,blur:5}},axes:{[Vo.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter(e){return Math.abs(e.value).toFixed(e.fractionDigits??0)}}},[Vo.CATEGORY]:{line:{enabled:!1}}}};import{_ModuleSupport as F0}from"ag-charts-community";import{_ModuleSupport as Wl}from"ag-charts-community";import{_ModuleSupport as V0}from"ag-charts-community";var{lineDistanceSquared:qa,BBox:W0,Path:K0,ScenePathChangeDetection:Ii}=V0,Fu=1e-6;function Vu([e,t],[i,o]){return Math.abs(e-i)<=Fu&&Math.abs(t-o)<=Fu}var ai=class extends K0{constructor(){super(...arguments),this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}get midPoint(){const{x0:e,y0:t,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this;return{x:(e+i+s+n)/4,y:(t+o+a+r)/4}}distanceSquared(e,t){if(this.containsPoint(e,t))return 0;const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c}=this;return Math.min(qa(e,t,i,o,s,a,1/0),qa(e,t,s,a,n,r,1/0),qa(e,t,n,r,l,c,1/0),qa(e,t,l,c,i,o,1/0))}computeBBox(){const{x0:e,y0:t,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this,l=Math.min(e,i,s,n),c=Math.max(e,i,s,n)-l,p=Math.min(t,o,a,r),d=Math.max(t,o,a,r)-p;return new W0(l,p,c,d)}updatePath(){const{path:e,x0:t,y0:i,x1:o,y1:s,x2:a,y2:n,x3:r,y3:l}=this,c=[[t,i],[o,s],[a,n],[r,l]];e.clear();let p,d;c.forEach(u=>{if(p!=null&&Vu(p,u)||d!=null&&Vu(d,u))return;const[f,y]=u;p==null?e.moveTo(f,y):e.lineTo(f,y),p??(p=u),d=u}),e.closePath()}};h([Ii()],ai.prototype,"x0",2),h([Ii()],ai.prototype,"y0",2),h([Ii()],ai.prototype,"x1",2),h([Ii()],ai.prototype,"y1",2),h([Ii()],ai.prototype,"x2",2),h([Ii()],ai.prototype,"y2",2),h([Ii()],ai.prototype,"x3",2),h([Ii()],ai.prototype,"y3",2);import{_ModuleSupport as z0}from"ag-charts-community";var{NODE_UPDATE_STATE_TO_PHASE_MAPPING:$0}=z0;function Wu(e,t,i,o){const{x0:s,y0:a,x1:n,y1:r,x2:l,y2:c,x3:p,y3:d,opacity:u}=e;return i?{x0:(s+p)/2,y0:(a+d)/2,x1:(n+l)/2,y1:(r+c)/2,x2:(n+l)/2,y2:(r+c)/2,x3:(s+p)/2,y3:(a+d)/2,opacity:u}:{x0:(s+n)/2,y0:(a+r)/2,x1:(s+n)/2,y1:(a+r)/2,x2:(l+p)/2,y2:(c+d)/2,x3:(l+p)/2,y3:(c+d)/2,opacity:u}}function H0(e,t){const i=a=>a==null;return{fromFn:(a,n,r)=>{r==="updated"&&i(n)?r="removed":r==="updated"&&i(a.previousDatum)&&(r="added");let l;r==="added"&&a.previousDatum==null&&t==="fade"?l={...Os(a,n),opacity:0}:r==="unknown"||r==="added"?l=Wu(n,a.previousDatum,e,t):l={x0:a.x0,y0:a.y0,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,x3:a.x3,y3:a.y3,opacity:a.opacity};const c=$0[r];return{...l,phase:c}},toFn:(a,n,r)=>{let l;return r==="removed"&&a.datum==null&&t==="fade"?l={...Os(a,n),opacity:0}:r==="removed"||i(n)?l=Wu(n,a.previousDatum,e,t):l=Os(a,n),l}}}function Os(e,t){const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:p}=t;return{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:p}}var{SeriesNodePickMode:Ku,SeriesZIndexMap:zu,valueProperty:Y0,keyProperty:X0,ChartAxisDirection:$u,updateLabelNode:U0,SMALLEST_KEY_INTERVAL:q0,LARGEST_KEY_INTERVAL:j0,diff:J0,fixNumericExtent:Z0,seriesLabelFadeInAnimation:Hu,resetMotion:Q0,resetLabelFn:eA,animationValidation:tA,computeBarFocusBounds:iA,ContinuousScale:oA,Group:sA,Selection:aA,PointerEvents:Yu,motion:nA,checkCrisp:rA,createDatumId:lA,applyShapeFillBBox:cA,getShapeStyle:pA,getShapeFill:hA}=Wl,dA=class extends Wl.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.xKey=o.properties.stageKey,this.yKey=o.properties.valueKey}},Xu=class extends Wl.AbstractBarSeries{constructor({moduleCtx:e,animationResetFns:t}){super({moduleCtx:e,pickModes:[Ku.AXIS_ALIGNED,Ku.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["stageKey"],y:["valueKey"]},directionNames:{x:[],y:[]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:t.datum,label:eA}}),this.NodeEvent=dA,this.connectorNodeGroup=this.contentGroup.appendChild(new sA({name:`${this.id}-series-connectorNodes`,zIndex:zu.BACKGROUND})),this.connectorSelection=aA.select(this.connectorNodeGroup,()=>this.connectionFactory()),this.connectorNodeGroup.pointerEvents=Yu.None}get pickModeAxis(){return"main-category"}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.connectorNodeGroup.zIndex=[zu.BACKGROUND,e],!0):!1}isVertical(){return!super.isVertical()}connectionFactory(){return new ai}async processData(e){if(!this.properties.isValid())return;const{stageKey:t,valueKey:i}=this.properties,{visible:o,id:s}=this,a=(y,g,m)=>o&&this.ctx.legendManager.getItemEnabled({seriesId:s,itemId:m}),n=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale,{isContinuousX:l,xScaleType:c,yScaleType:p}=this.getScaleInformation({xScale:n,yScale:r}),d=[];this.ctx.animationManager.isSkipped()||(this.processedData&&d.push(J0(this.id,this.processedData)),d.push(tA()));const u=this.visible?{}:{forceValue:0},{processedData:f}=await this.requestDataModel(e,this.data,{props:[X0(t,c,{id:"xValue"}),Y0(i,p,{id:"yValue",...u,validation:a,invalidValue:0}),...l?[q0,j0]:[],...d],groupByKeys:!1});this.smallestDataInterval=f.reduced?.smallestKeyInterval,this.largestDataInterval=f.reduced?.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(e){const{processedData:t,dataModel:i,id:o,ctx:{legendManager:s}}=this;if(!t||!i)return[];const{keys:[a]}=t.domain;if(e===this.getCategoryDirection()){const n=i.resolveProcessedDataDefById(this,"xValue");return n?.def.type==="key"&&n?.def.valueType==="category"?this.hasData?a.filter((r,l)=>s.getItemEnabled({seriesId:o,itemId:l})):[]:this.padBandExtent(a)}else{const n=this.domainForClippedRange($u.Y,["yValue"],"xValue",!0),r=Math.max(...n),l=[-r,r];return Z0(l)}}getSeriesRange(e,t){return[NaN,NaN]}createNodeData(){const{hasData:e,data:t,dataModel:i,groupScale:o,processedData:s,id:a,ctx:{legendManager:n}}=this,r=this.getCategoryAxis(),l=this.getValueAxis();if(!(e&&t&&r&&l&&i&&s?.type==="ungrouped"))return;const c=r.scale,p=l.scale,d=this.getBarDirection()===$u.X,{stageKey:u,valueKey:f}=this.properties,{strokeWidth:y}=this.barStyle(),g=`${f}`,m={itemId:g,nodeData:[],labelData:[],connectorData:[],scales:this.calculateScaling(),visible:this.visible},S=this.visible;if(!S)return m;const D=i.resolveKeysById(this,"xValue",s),b=i.resolveColumnById(this,"yValue",s),{barWidth:v,groupIndex:R}=this.updateGroupScale(r),T=oA.is(c)?v*-.5:0,O=rA(r?.scale,r?.visibleRange,this.smallestDataInterval,this.largestDataInterval);let x;return(s.dataSources.get(this.id)??[]).forEach((k,I)=>{const N=S&&n.getItemEnabled({seriesId:a,itemId:I}),L=D[I];if(L==null)return;const M=Math.round(c.convert(L))+o.convert(String(R))+T,E=b[I],C=Math.round(p.convert(-E)),w=Math.round(p.convert(E)),G=Math.max(y,Math.abs(w-C)),P={x:d?Math.min(w,C):M,y:d?M:Math.min(w,C),width:d?G:v,height:d?v:G},B={x:P.x+P.width/2,y:P.y+P.height/2},_=this.createLabelData({datumIndex:I,rect:P,barAlongX:d,yDatum:E,datum:k,visible:N}),F={index:I,series:this,itemId:g,datum:k,datumIndex:I,xValue:L,yValue:E,xKey:u,yKey:f,x:P.x,y:P.y,width:P.width,height:P.height,midPoint:B,strokeWidth:y,crisp:O,label:_,visible:N};if(m.nodeData.push(F),_!=null&&m.labelData.push(_),x!=null){const V=x.rect,W=x.nodeDatum,K=x.datumIndex;d?m.connectorData.push({datum:W,datumIndex:K,x0:V.x,y0:V.y+V.height,x1:V.x+V.width,y1:V.y+V.height,x2:P.x+P.width,y2:P.y,x3:P.x,y3:P.y,opacity:1}):m.connectorData.push({datum:W,datumIndex:K,x0:V.x+V.width,y0:V.y,x1:P.x,y1:P.y,x2:P.x,y2:P.y+P.height,x3:V.x+V.width,y3:V.y+V.height,opacity:1})}N&&(x={itemId:g,rect:P,nodeDatum:F,datumIndex:I})}),m}updateNodes(e,t,i){super.updateNodes(e,t,i);const{connectorSelection:o}=this,s=this.contextNodeData?.connectorData??[];this.connectorSelection=this.updateConnectorSelection({connectorSelection:o,connectorData:s}),this.updateConnectorNodes({connectorSelection:o})}updateDatumSelection(e){const{nodeData:t,datumSelection:i}=e,o=t??[];return i.update(o,void 0,s=>this.getDatumId(s))}updateConnectorSelection(e){const{connectorData:t,connectorSelection:i}=e;return i.update(this.connectorEnabled()?t:[],void 0,o=>this.getDatumId(o.datum))}updateConnectorNodes(e){const{fills:t,strokes:i,fillGradientDefaults:o,fillPatternDefaults:s}=this.properties,{fill:a,fillOpacity:n,stroke:r,strokeOpacity:l,strokeWidth:c,lineDash:p,lineDashOffset:d}=this.connectorStyle(),u=this.getShapeFillBBox();e.connectorSelection.each((f,y)=>{const{datumIndex:g}=y;f.setProperties(Os(f,y));const m=hA(a??t[g%t.length],o,s);f.fill=m,cA(f,m,u),f.fillOpacity=n,f.stroke=r??i[g%i.length],f.strokeOpacity=l,f.strokeWidth=c,f.lineDash=p,f.lineDashOffset=d})}getHighlightLabelData(e,t){const i=e.filter(o=>o.datum===t.datum);return i.length>0?i:void 0}updateLabelSelection(e){const t=this.properties.label.enabled?e.labelData:[];return e.labelSelection.update(t,i=>{i.pointerEvents=Yu.None})}updateLabelNodes(e){e.labelSelection.each((t,i)=>{U0(t,this.properties.label,i)})}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{stageKey:a,valueKey:n,tooltip:r}=s,l=this.getCategoryAxis(),c=this.getValueAxis();if(!i||!o||!l||!c)return;const p=o.dataSources.get(this.id)?.[e],d=i.resolveKeysById(this,"xValue",o)[e],u=i.resolveColumnById(this,"yValue",o)[e];if(d!=null)return r.formatTooltip(this.properties,{symbol:this.legendItemSymbol(e),data:[{label:l.formatDatum(d),value:c.formatDatum(u)}]},{seriesId:t,datum:p,title:a,stageKey:a,valueKey:n,...this.tooltipStyle(p,e)})}resetAllAnimation(e){super.resetAllAnimation(e),Q0([this.connectorSelection],Os)}animateEmptyUpdateReady({labelSelection:e}){const{connectorSelection:t}=this,i=this.isVertical(),s=H0(i,"normal");nA.fromToMotion(this.id,"connectors",this.ctx.animationManager,[t],s),Hu(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(e){const{labelSelection:t}=e;this.ctx.animationManager.stopByAnimationGroupId(this.id),Hu(this,"labels",this.ctx.animationManager,t)}getDatumId(e){return lA(e.xValue)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:e}){return iA(this,this.contextNodeData?.nodeData[e])}legendItemSymbol(e){const{strokeWidth:t,fillOpacity:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,fillGradientDefaults:n,fillPatternDefaults:r}=this.barStyle(),{fills:l,strokes:c}=this.properties,p=l[e%l.length]??"black",d=c[e%c.length]??"black";return{marker:pA({fill:p,fillOpacity:i,stroke:d,strokeWidth:t,strokeOpacity:o,lineDash:s,lineDashOffset:a},n,r)}}getLegendData(e){const{id:t,processedData:i,dataModel:o,ctx:{legendManager:s},visible:a}=this;if(!o||!i||e!=="category"||!this.properties.isValid())return[];const{showInLegend:n}=this.properties,r=o.resolveKeysById(this,"xValue",i);return(i.dataSources.get(this.id)??[]).map((l,c)=>{const p=r[c];if(p!=null)return{legendType:"category",id:t,datum:l,itemId:c,seriesId:t,enabled:a&&s.getItemEnabled({seriesId:t,itemId:c}),label:{text:String(p)},symbol:this.legendItemSymbol(c),skipAnimations:!0,hideInLegend:!n}}).filter(l=>l!=null)}};import{_ModuleSupport as uA}from"ag-charts-community";var{FillGradientDefaults:fA,FillPatternDefaults:gA,Label:yA,AbstractBarSeriesProperties:mA,SeriesTooltip:SA,AxisLabel:bA,TempValidate:He,UNION:Uu,OR:DA,ARRAY_OF:xA,COLOR_GRADIENT:vA,COLOR_STRING:OA,COLOR_STRING_ARRAY:kA,COLOR_PATTERN:RA,LINE_DASH:NA,OBJECT:ks,POSITIVE_NUMBER:Kl,RATIO:qu,STRING:ju}=uA,zl=class extends yA{constructor(){super(...arguments),this.spacing=0}};h([He(Uu(["before","middle","after"],"a placement"))],zl.prototype,"placement",2),h([He(Kl)],zl.prototype,"spacing",2);var Ju=class extends bA{};h([He(Uu(["before","after"],"a placement"))],Ju.prototype,"placement",2);var tt=class extends mA{constructor(){super(...arguments),this.fills=[],this.fillGradientDefaults=new fA,this.fillPatternDefaults=new gA,this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new zl,this.stageLabel=new Ju,this.tooltip=new SA}};h([He(ju)],tt.prototype,"stageKey",2),h([He(ju)],tt.prototype,"valueKey",2),h([He(xA(DA(vA,RA,OA)))],tt.prototype,"fills",2),h([He(ks)],tt.prototype,"fillGradientDefaults",2),h([He(ks)],tt.prototype,"fillPatternDefaults",2),h([He(qu)],tt.prototype,"fillOpacity",2),h([He(kA)],tt.prototype,"strokes",2),h([He(Kl)],tt.prototype,"strokeWidth",2),h([He(qu)],tt.prototype,"strokeOpacity",2),h([He(NA)],tt.prototype,"lineDash",2),h([He(Kl)],tt.prototype,"lineDashOffset",2),h([He(ks)],tt.prototype,"label",2),h([He(ks)],tt.prototype,"stageLabel",2),h([He(ks)],tt.prototype,"tooltip",2);function Zu(e,{x:t,y:i,width:o,height:s,opacity:a}){return{x1:t,y1:i,x2:t+o,y2:i+s,opacity:a}}var{formatValue:AA,Line:TA}=F0,$l=class extends Xu{constructor(e){super({moduleCtx:e,animationResetFns:{datum:Zu}}),this.properties=new tt}get hasData(){const{id:e,ctx:{legendManager:t}}=this,i=this.data?.reduce((o,s,a)=>o+(t.getItemEnabled({seriesId:e,itemId:a})?1:0),0);return i!=null&&i>1}getBandScalePadding(){return{inner:1,outer:0}}connectorEnabled(){return!0}barStyle(){return{fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[],lineDashOffset:0,fillGradientDefaults:this.properties.fillGradientDefaults,fillPatternDefaults:this.properties.fillPatternDefaults}}connectorStyle(){const{fillOpacity:e,strokeOpacity:t,strokeWidth:i,lineDash:o,lineDashOffset:s,fillGradientDefaults:a,fillPatternDefaults:n}=this.properties;return{fillOpacity:e,strokeOpacity:t,strokeWidth:i,lineDash:o,lineDashOffset:s,fillGradientDefaults:a,fillPatternDefaults:n}}nodeFactory(){return new TA}createLabelData({datumIndex:e,rect:t,barAlongX:i,yDatum:o,datum:s,visible:a}){const{stageKey:n,valueKey:r,label:l}=this.properties,{spacing:c,placement:p}=l;let d,u,f,y;if(i)switch(d=t.x+t.width/2,f="center",p){case"before":u=t.y-c,y="bottom";break;case"after":u=t.y+t.height+c,y="top";break;default:u=t.y+t.height/2,y="middle"}else switch(u=t.y+t.height/2,y="middle",p){case"before":d=t.x-c,f="right";break;case"after":d=t.x+t.width+c,f="left";break;default:d=t.x+t.width/2,f="center"}return{x:d,y:u,textAlign:f,textBaseline:y,text:this.getLabelText(l,{itemId:r,value:o,datum:s,stageKey:n,valueKey:r},g=>AA(g,0)),itemId:r,datum:s,datumIndex:e,series:this,visible:a}}updateDatumNodes(e){const t=e.isHighlight?this.properties.highlightStyle.item:void 0;e.datumSelection.each((i,o)=>{i.setProperties(Zu(i,o)),i.stroke=t?.stroke,i.strokeWidth=t?.strokeWidth??0,i.strokeOpacity=t?.strokeOpacity??1,i.lineDash=t?.lineDash,i.lineDashOffset=t?.lineDashOffset??0})}tooltipStyle(e,t){const{fills:i,strokes:o}=this.properties,s=i[t%i.length]??"black",a=o[t%o.length]??"black",{fillOpacity:n,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:p}=this.barStyle();return{fill:s,fillOpacity:n,stroke:a,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:p}}};$l.className="ConeFunnelSeries",$l.type="cone-funnel";import{_ModuleSupport as IA}from"ag-charts-community";import{arrayOf as Qu,boolean as ef,callback as MA,color as LA,colorUnion as CA,constant as PA,fillOptionsDef as EA,lineDashOptionsDef as wA,number as _A,positiveNumber as Hl,required as Yl,string as Xl,strokeOptionsDef as BA,union as Ul}from"ag-charts-core";var{commonSeriesOptionsDefs:GA,seriesLabelOptionsDefs:tf,tooltipOptionsDefs:FA,without:of}=IA,VA={type:Yl(PA("cone-funnel")),stageKey:Yl(Xl),valueKey:Yl(Xl),direction:Ul("horizontal","vertical"),fills:Qu(CA),strokes:Qu(LA),showInMiniChart:ef,label:{spacing:Hl,placement:Ul("before","middle","after"),...tf},stageLabel:{rotation:_A,spacing:Hl,minSpacing:Hl,placement:Ul("before","after"),avoidCollisions:ef,itemStyler:MA,format:Xl,...tf},tooltip:FA,...GA,...of(EA,["fill"]),...of(BA,["stroke"]),...wA};import{_ModuleSupport as ja}from"ag-charts-community";var{ThemeConstants:{CARTESIAN_AXIS_TYPE:sf}}=ja,vF={series:{direction:"vertical",fills:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},ja.SAFE_RANGE2_OPERATION]},strokes:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},ja.SAFE_RANGE2_OPERATION]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:ja.FILL_PATTERN_DEFAULTS,strokeWidth:0,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},placement:"before",spacing:4}},seriesArea:{padding:{top:20,bottom:20}},axes:{[sf.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter(e){return Math.abs(e.value).toFixed(e.fractionDigits??0)}}},[sf.CATEGORY]:{line:{enabled:!1}}}},af={type:"series",name:"cone-funnel",chartType:"cartesian",enterprise:!0,options:VA,create:e=>new $l(e)};import"ag-charts-community";import{_ModuleSupport as WA}from"ag-charts-community";import{_ModuleSupport as KA}from"ag-charts-community";var{FillGradientDefaults:zA,FillPatternDefaults:$A,Label:HA,DropShadow:YA,AbstractBarSeriesProperties:XA,BaseProperties:UA,SeriesTooltip:qA,AxisLabel:jA,TempValidate:de,UNION:JA,BOOLEAN:ZA,ARRAY_OF:QA,OR:nf,COLOR_GRADIENT:rf,COLOR_STRING_ARRAY:eT,COLOR_PATTERN:lf,COLOR_STRING:ql,FUNCTION:tT,LINE_DASH:cf,OBJECT:io,POSITIVE_NUMBER:Ja,RATIO:Rs,STRING:pf}=KA,iT=class extends HA{},hf=class extends jA{};h([de(JA(["before","after"],"a placement"))],hf.prototype,"placement",2);var fi=class extends UA{constructor(){super(...arguments),this.enabled=!0,this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};h([de(ZA)],fi.prototype,"enabled",2),h([de(nf(rf,ql,lf),{optional:!0})],fi.prototype,"fill",2),h([de(Rs)],fi.prototype,"fillOpacity",2),h([de(ql,{optional:!0})],fi.prototype,"stroke",2),h([de(Ja)],fi.prototype,"strokeWidth",2),h([de(Rs)],fi.prototype,"strokeOpacity",2),h([de(cf)],fi.prototype,"lineDash",2),h([de(Ja)],fi.prototype,"lineDashOffset",2);var Ve=class extends XA{constructor(){super(...arguments),this.fills=[],this.fillGradientDefaults=new zA,this.fillPatternDefaults=new $A,this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.spacingRatio=0,this.dropOff=new fi,this.shadow=new YA().set({enabled:!1}),this.label=new iT,this.stageLabel=new hf,this.tooltip=new qA}};h([de(pf)],Ve.prototype,"stageKey",2),h([de(pf)],Ve.prototype,"valueKey",2),h([de(QA(nf(rf,lf,ql)))],Ve.prototype,"fills",2),h([de(io)],Ve.prototype,"fillGradientDefaults",2),h([de(io)],Ve.prototype,"fillPatternDefaults",2),h([de(Rs)],Ve.prototype,"fillOpacity",2),h([de(eT)],Ve.prototype,"strokes",2),h([de(Ja)],Ve.prototype,"strokeWidth",2),h([de(Rs)],Ve.prototype,"strokeOpacity",2),h([de(cf)],Ve.prototype,"lineDash",2),h([de(Ja)],Ve.prototype,"lineDashOffset",2),h([de(Rs)],Ve.prototype,"spacingRatio",2),h([de(tT,{optional:!0})],Ve.prototype,"itemStyler",2),h([de(io)],Ve.prototype,"dropOff",2),h([de(io)],Ve.prototype,"shadow",2),h([de(io)],Ve.prototype,"label",2),h([de(io)],Ve.prototype,"stageLabel",2),h([de(io)],Ve.prototype,"tooltip",2);var{ChartAxisDirection:oT,resetBarSelectionsFn:sT,prepareBarAnimationFunctions:df,midpointStartingBarPosition:uf,createDatumId:aT,formatValue:nT,Rect:rT,motion:ff,applyShapeStyle:lT,getShapeStyle:gf}=WA,jl=class extends Xu{constructor(e){super({moduleCtx:e,animationResetFns:{datum:sT}}),this.properties=new Ve}getBandScalePadding(){return{inner:this.properties.spacingRatio,outer:0}}connectorEnabled(){return this.properties.dropOff.enabled}barStyle(){const{fillOpacity:e,strokeOpacity:t,strokeWidth:i,lineDash:o,lineDashOffset:s,fillGradientDefaults:a,fillPatternDefaults:n}=this.properties;return{fillOpacity:e,strokeOpacity:t,strokeWidth:i,lineDash:o,lineDashOffset:s,fillGradientDefaults:a,fillPatternDefaults:n}}connectorStyle(){const{fill:e,fillOpacity:t,stroke:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n}=this.properties.dropOff;return{fill:e,fillOpacity:t,stroke:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n,fillGradientDefaults:this.properties.fillGradientDefaults,fillPatternDefaults:this.properties.fillPatternDefaults}}nodeFactory(){return new rT}createLabelData({datumIndex:e,rect:t,yDatum:i,datum:o,visible:s}){const{valueKey:a,stageKey:n,label:r}=this.properties;return{x:t.x+t.width/2,y:t.y+t.height/2,textAlign:"center",textBaseline:"middle",text:this.getLabelText(r,{itemId:n,value:i,datum:o,valueKey:a,stageKey:n},l=>nT(l,0)),itemId:n,datum:o,datumIndex:e,series:this,visible:s}}getItemBaseStyle(e){const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return gf({fill:i?.fill,fillOpacity:i?.fillOpacity??t.fillOpacity,stroke:i?.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:i?.strokeOpacity??t.strokeOpacity,lineDash:i?.lineDash??t.lineDash,lineDashOffset:i?.lineDashOffset??t.lineDashOffset},t.fillGradientDefaults,t.fillPatternDefaults)}getItemStyleOverrides(e,t,i,o,s){const{id:a,properties:n}=this,{stageKey:r,valueKey:l,fills:c,strokes:p,itemStyler:d}=n,u=o.fill??c[i%c.length]??"black",f=o.stroke??p[i%p.length]??"black",y={};if(s||(y.fill=u,y.stroke=f),d!=null){const g=this.cachedDatumCallback(aT(e,s?"highlight":"node"),()=>{const{fillOpacity:m,strokeOpacity:S,strokeWidth:D,lineDash:b,lineDashOffset:v}=o;return this.callWithContext(d,{seriesId:a,datum:t,highlighted:s,stageKey:r,valueKey:l,fill:u,fillOpacity:m,stroke:f,strokeOpacity:S,strokeWidth:D,lineDash:b,lineDashOffset:v})});Object.assign(y,g)}return gf(y,n.fillGradientDefaults,n.fillPatternDefaults)}updateDatumNodes(e){const{shadow:t}=this.properties,{datumSelection:i,isHighlight:o}=e,s=this.getCategoryDirection()===oT.X,a=this.getItemBaseStyle(o),n=this.getShapeFillBBox();i.each((r,l)=>{const{datumIndex:c}=l,p=this.getItemStyleOverrides(String(l.datumIndex),l.datum,c,a,o);lT(r,a,p,n),r.visible=s?l.width>0:l.height>0,r.crisp=l.crisp,r.fillShadow=t})}tooltipStyle(e,t){const i=this.getItemBaseStyle(!1);return Object.assign(i,this.getItemStyleOverrides(String(t),e,t,i,!1)),i}animateEmptyUpdateReady(e){super.animateEmptyUpdateReady(e);const{datumSelection:t}=e,i=this.isVertical(),s=df(uf(i,"normal"));ff.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s)}animateWaitingUpdateReady(e){super.animateWaitingUpdateReady(e);const{datumSelection:t}=e,{processedData:i}=this,o=i?.reduced?.diff?.[this.id],s=df(uf(this.isVertical(),"fade"));ff.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s,(a,n)=>n.xValue,o)}};jl.className="FunnelSeries",jl.type="funnel";import{_ModuleSupport as cT}from"ag-charts-community";import{arrayOf as yf,boolean as Za,callback as mf,color as pT,colorUnion as hT,constant as dT,fillOptionsDef as Sf,lineDashOptionsDef as bf,number as uT,positiveNumber as Df,ratio as fT,required as Jl,string as Zl,strokeOptionsDef as xf,union as vf}from"ag-charts-core";var{commonSeriesOptionsDefs:gT,seriesLabelOptionsDefs:Of,shadowOptionsDefs:yT,tooltipOptionsDefs:mT,without:kf}=cT,ST={type:Jl(dT("funnel")),stageKey:Jl(Zl),valueKey:Jl(Zl),direction:vf("horizontal","vertical"),fills:yf(hT),strokes:yf(pT),showInMiniChart:Za,itemStyler:mf,spacingRatio:fT,crisp:Za,dropOff:{enabled:Za,...Sf,...xf,...bf},stageLabel:{rotation:uT,spacing:Df,minSpacing:Df,placement:vf("before","after"),avoidCollisions:Za,itemStyler:mf,format:Zl,...Of},label:Of,tooltip:mT,shadow:yT,...gT,...kf(Sf,["fill"]),...kf(xf,["stroke"]),...bf},Rf={type:"series",name:"funnel",chartType:"cartesian",enterprise:!0,options:ST,create:e=>new jl(e)};import{_ModuleSupport as Nf}from"ag-charts-community";import{_ModuleSupport as Ko}from"ag-charts-community";var Af=class{*[Symbol.iterator](){const{node:e,datum:t}=this;e&&t&&(yield{node:e,datum:t})}nodes(){return this.node?[this.node]:[]}update(e,t,i,o){const s=e.nodes();if(s.length===0)this.node?.remove(),this.node=void 0;else{this.node===void 0&&(this.node=new i,this.node.fillOpacity=0,this.node.strokeOpacity=0,t.appendChild(this.node));const a=s[0],n=s.toReversed().find(r=>r.datum.datum.value>r.datum.datum.segmentStart)??s[s.length-1];this.node.datum=this.datum=a.datum,o(this.node,a,n)}}},Tf={fromFn:()=>({opacity:0,phase:"initial"}),toFn:()=>({opacity:1})};function If(e,t){if(e==null)return"";const{min:i,max:o}=t,s=i!==0?Math.ceil(Math.log10(Math.abs(i))):0,a=o!==0?Math.ceil(Math.log10(Math.abs(o))):0,n=Math.max(2-Math.max(s,a),0);return e.toFixed(n)}function Ns(e,t,i){if(t.text!=null)return t.text;const o=i??t.value,s=t?.formatter?.({seriesId:e.id,datum:void 0,value:o});if(s!=null)return String(s)}import"ag-charts-community";function Mf({path:e,x:t,y:i,size:o}){e.moveTo(t,i-o/2),e.lineTo(t,i+o/2)}import"ag-charts-community";import{clamp as Lf,iterate as bT}from"ag-charts-core";function Cf(e,t){const i=bT(e.datumUnion.nodes(),e.targetSelection.nodes());return e.pickNodeNearestDistantObject(t,i)}function Pf(e,t){const i=[{data:e.contextNodeData?.nodeData,selection:e.datumUnion},{data:e.contextNodeData?.targetData,selection:e.targetSelection}].filter(l=>l.data&&l.data.length>0),o=Lf(0,t.otherIndex+t.otherIndexDelta,i.length-1);if(i.length===0)return;const{data:s,selection:a}=i[o];if(s==null||s.length===0)return;const n=Lf(0,t.datumIndex,s.length-1),r=s[n];for(const l of a)if(l.datum===r)return{bounds:l.node,clipFocusBox:!0,datum:r,datumIndex:n,otherIndex:o}}import{_ModuleSupport as Ql}from"ag-charts-community";import{_ModuleSupport as DT}from"ag-charts-community";var{MARKER_SHAPE:xT,UNION:ec,OR:vT}=DT,Qa=ec(["continuous","discrete"],"a fill mode"),Ef=vT(xT,ec(["line"],"a marker shape")),wf=ec(["container","item"],"a corner mode");import{_ModuleSupport as OT}from"ag-charts-community";import{Logger as kT}from"ag-charts-core";var{BaseProperties:_f,TempValidate:zo,OBJECT:RT,BOOLEAN:NT,NUMBER:tc,NUMBER_ARRAY:AT}=OT,en=class extends _f{getSegments(e,t){const{values:i,step:o,count:s}=this,a=Math.min(...e.domain),n=Math.max(...e.domain);let r;if(i!=null){const l=i.filter(c=>c>a&&c<n).sort((c,p)=>c-p);r=[a,...l,n]}else if(o!=null){const l=[];for(let c=a;c<n;c+=o)l.push(c);l.push(n),r=l}else if(s!=null){const l=s+1;r=Array.from({length:l+1},(c,p)=>p/l*(n-a)+a)}else{const l=e.ticks({nice:!0,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.filter(c=>c>a&&c<n);r=l!=null?[a,...l,n]:void 0}return r!=null&&r.length>t&&(kT.warnOnce("the configured segmentation results in more than 1 item per pixel, ignoring. Supply a segmentation configuration that results in larger segments or omit this configuration"),r=void 0),r??(r=[a,n]),r}};h([zo(AT,{optional:!0})],en.prototype,"values",2),h([zo(tc,{optional:!0})],en.prototype,"step",2),h([zo(tc,{optional:!0})],en.prototype,"count",2);var As=class extends _f{constructor(){super(...arguments),this.enabled=!1,this.interval=new en,this.spacing=0}};h([zo(NT)],As.prototype,"enabled",2),h([zo(RT)],As.prototype,"interval",2),h([zo(tc)],As.prototype,"spacing",2);var{BaseProperties:tn,SeriesTooltip:TT,SeriesProperties:IT,PropertiesArray:ic,TempValidate:H,BOOLEAN:Bf,COLOR_STRING:oo,COLOR_STRING_ARRAY:MT,FUNCTION:LT,LINE_DASH:oc,NUMBER:Yt,OBJECT_ARRAY:sc,OBJECT:ni,POSITIVE_NUMBER:ri,RATIO:so,STRING:Gf,NUMBER_ARRAY:CT,UNION:on,AND:Ff,LESS_THAN:PT,GREATER_THAN:ET,Label:wT,AxisLabel:_T}=Ql,BT=on(["before","after","middle"],"a placement"),GT=on(["inside-start","outside-start","inside-end","outside-end","inside-center","bar-inside","bar-inside-end","bar-outside-end","bar-end"],"an placement"),FT=on(["horizontal","vertical"],"an orientation"),VT=on(["before","after"],"a placement"),Vf=class extends wT{};h([H(Yt,{optional:!0})],Vf.prototype,"spacing",2);var Ye=class extends tn{constructor(){super(...arguments),this.value=0,this.label=new Vf}};h([H(Gf,{optional:!0})],Ye.prototype,"text",2),h([H(Yt)],Ye.prototype,"value",2),h([H(Ef,{optional:!0})],Ye.prototype,"shape",2),h([H(BT,{optional:!0})],Ye.prototype,"placement",2),h([H(Yt,{optional:!0})],Ye.prototype,"spacing",2),h([H(ri,{optional:!0})],Ye.prototype,"size",2),h([H(Yt,{optional:!0})],Ye.prototype,"rotation",2),h([H(oo,{optional:!0})],Ye.prototype,"fill",2),h([H(so,{optional:!0})],Ye.prototype,"fillOpacity",2),h([H(oo,{optional:!0})],Ye.prototype,"stroke",2),h([H(ri,{optional:!0})],Ye.prototype,"strokeWidth",2),h([H(so,{optional:!0})],Ye.prototype,"strokeOpacity",2),h([H(oc,{optional:!0})],Ye.prototype,"lineDash",2),h([H(ri,{optional:!0})],Ye.prototype,"lineDashOffset",2),h([H(ni)],Ye.prototype,"label",2);var bt=class extends tn{constructor(){super(...arguments),this.enabled=!0,this.thicknessRatio=1,this.fills=new ic(Ql.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};h([H(Bf)],bt.prototype,"enabled",2),h([H(ri,{optional:!0})],bt.prototype,"thickness",2),h([H(so)],bt.prototype,"thicknessRatio",2),h([H(sc)],bt.prototype,"fills",2),h([H(Qa)],bt.prototype,"fillMode",2),h([H(oo,{optional:!0})],bt.prototype,"fill",2),h([H(so)],bt.prototype,"fillOpacity",2),h([H(oo)],bt.prototype,"stroke",2),h([H(ri)],bt.prototype,"strokeWidth",2),h([H(so)],bt.prototype,"strokeOpacity",2),h([H(oc)],bt.prototype,"lineDash",2),h([H(ri)],bt.prototype,"lineDashOffset",2);var Ts=class extends tn{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};h([H(CT,{optional:!0})],Ts.prototype,"values",2),h([H(Yt,{optional:!0})],Ts.prototype,"step",2),h([H(Yt)],Ts.prototype,"minSpacing",2),h([H(Yt)],Ts.prototype,"maxSpacing",2);var Wf=class extends _T{constructor(){super(...arguments),this.placement=void 0}};h([H(VT,{optional:!0})],Wf.prototype,"placement",2);var Je=class extends tn{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new ic(Ql.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new Ts,this.label=new Wf}};h([H(Ff(Yt,PT("max")))],Je.prototype,"min",2),h([H(Ff(Yt,ET("min")))],Je.prototype,"max",2),h([H(sc)],Je.prototype,"fills",2),h([H(Qa)],Je.prototype,"fillMode",2),h([H(oo,{optional:!0})],Je.prototype,"fill",2),h([H(so)],Je.prototype,"fillOpacity",2),h([H(oo)],Je.prototype,"stroke",2),h([H(ri)],Je.prototype,"strokeWidth",2),h([H(so)],Je.prototype,"strokeOpacity",2),h([H(oc)],Je.prototype,"lineDash",2),h([H(ri)],Je.prototype,"lineDashOffset",2),h([H(oo)],Je.prototype,"defaultFill",2),h([H(ni)],Je.prototype,"interval",2),h([H(ni)],Je.prototype,"label",2);var sn=class extends oi{constructor(){super(...arguments),this.placement="inside-center",this.avoidCollisions=!0}};h([H(Gf,{optional:!0})],sn.prototype,"text",2),h([H(GT)],sn.prototype,"placement",2),h([H(Bf)],sn.prototype,"avoidCollisions",2);var Xe=class extends IT{constructor(){super(...arguments),this.value=0,this.segmentation=new As,this.defaultColorRange=[],this.targets=new ic(Ye),this.defaultTarget=new Ye,this.defaultScale=new Je,this.direction="vertical",this.thickness=1,this.cornerRadius=0,this.cornerMode="container",this.margin=0,this.scale=new Je,this.bar=new bt,this.label=new sn,this.tooltip=new TT}};h([H(Yt)],Xe.prototype,"value",2),h([H(ni)],Xe.prototype,"segmentation",2),h([H(MT)],Xe.prototype,"defaultColorRange",2),h([H(sc)],Xe.prototype,"targets",2),h([H(ni)],Xe.prototype,"defaultTarget",2),h([H(ni)],Xe.prototype,"defaultScale",2),h([H(FT)],Xe.prototype,"direction",2),h([H(ri)],Xe.prototype,"thickness",2),h([H(ri)],Xe.prototype,"cornerRadius",2),h([H(wf)],Xe.prototype,"cornerMode",2),h([H(Yt)],Xe.prototype,"margin",2),h([H(ni)],Xe.prototype,"scale",2),h([H(ni)],Xe.prototype,"bar",2),h([H(LT,{optional:!0})],Xe.prototype,"itemStyler",2),h([H(ni)],Xe.prototype,"label",2),h([H(ni)],Xe.prototype,"tooltip",2);import{_ModuleSupport as WT}from"ag-charts-community";var{CachedTextMeasurerPool:KT,BBox:zT}=WT;function ac(e){const{x0:t,y0:i,x1:o,y1:s,horizontalInset:a,verticalInset:n}=e,r=Math.min(t,o)+a,l=Math.min(i,s)+n,c=Math.max(Math.abs(o-t)-2*a,0),p=Math.max(Math.abs(s-i)-2*n,0);return{x:r,y:l,width:c,height:p}}function $T(e,t){if(t==null)return!0;const i=ac(e),o=1e-6,s=i.x+o,a=i.y+o,n=i.x+i.width-o,r=i.y+i.height-o,l=t.x,c=t.x+t.width,p=t.y,d=t.y+t.height;return Math.max(s,l)<=Math.min(n,c)&&Math.max(a,p)<=Math.min(r,d)}function nc(e){const{clipX0:t,clipX1:i,clipY0:o,clipY1:s}=e;return t!=null&&i!=null||o!=null&&s!=null}function HT(e){if(!nc(e))return;const{x0:t,y0:i,x1:o,y1:s}=e,{x:a,y:n,width:r,height:l}=ac(e);let{clipX0:c,clipX1:p,clipY0:d,clipY1:u}=e;(c==null||p==null)&&(c=t,p=o),(d==null||u==null)&&(d=i,u=s);const f=Math.min(c,p),y=Math.min(d,u),g=Math.abs(p-c),m=Math.abs(u-d);return c=Math.max(a,f),d=Math.max(n,y),p=Math.min(a+r,f+g),u=Math.min(n+l,y+m),new zT(Math.min(c,p),Math.min(d,u),Math.abs(p-c),Math.abs(u-d))}function Kf(e,t){const i=e?"initial":"update";return{node:{fromFn(s,a){const n=s.previousDatum;let{x0:r,y0:l,x1:c,y1:p,clipX0:d,clipY0:u,clipX1:f,clipY1:y}=n??a;const{horizontalInset:g,verticalInset:m}=a,S=n!=null&&nc(n),D=nc(a);return S&&D||(!S&&D?({x0:r,y0:l,x1:c,y1:p,clipX0:d,clipY0:u,clipX1:f,clipY1:y}=a,e&&(t?f=a.clipX0:y=a.clipY0)):S&&!D?({x0:r,y0:l,x1:c,y1:p}=a,d=void 0,u=void 0,f=void 0,y=void 0):e&&(t?c=r:p=l)),{x0:r,y0:l,x1:c,y1:p,clipX0:d,clipY0:u,clipX1:f,clipY1:y,horizontalInset:g,verticalInset:m,phase:i}},toFn(s,a){const{x0:n,y0:r,x1:l,y1:c,clipX0:p,clipY0:d,clipX1:u,clipY1:f,horizontalInset:y,verticalInset:g}=a;return{x0:n,y0:r,x1:l,y1:c,clipX0:p,clipY0:d,clipX1:u,clipY1:f,horizontalInset:y,verticalInset:g}},applyFn(s,a){s.setProperties(an(s,a))}}}}function an(e,t){const{x:i,y:o,width:s,height:a}=ac(t),n=HT(t),r=$T(t,n);return{x:i,y:o,width:s,height:a,clipBBox:n,visible:r}}var YT={Before:"right",Center:"center",After:"left"},XT={Before:"top",Center:"middle",After:"bottom"},UT={Before:-1,Center:-.5,After:0},qT={Before:0,Center:-.5,After:-1};function jT(e,t,i,o,s){const{seriesRect:a,gaugeRect:n,barRect:r}=o,{padding:l,horizontal:c}=i;t.each((p,d)=>{const u=Ns(e,d,s?.label);let f,y;d.placement==="outside-start"?c?(f=n.x,y=a.height):(f=a.width,y=a.height-(n.y+n.height)):d.placement==="outside-end"?c?(f=a.width-(n.x+n.width),y=a.height):(f=a.width,y=n.y):d.avoidCollisions&&(f=n.width,y=n.height);let g;if(u==null)return;if(f!=null&&y!=null)g=gs(u,d,{padding:l},()=>({width:f,height:y,meta:null}))?.[0];else{const M={fontSize:d.fontSize,fontStyle:d.fontStyle,fontWeight:d.fontWeight,fontFamily:d.fontFamily,lineHeight:d.lineHeight},{width:E,height:C}=KT.measureText(u,{font:M});g={text:u,fontSize:d.fontSize,lineHeight:Mo(d,d.fontSize),width:E,height:C}}if(g==null){p.visible=!1;return}const m=c?n.x:n.y+n.height,S=c?n.x+n.width:n.y,D=c?r.x:r.y+r.height,b=c?r.x+r.width:r.y,v=d.spacing*(c?1:-1);let R,T,O,x;switch(d.placement){case"outside-start":R=-1/0,T=1/0,O=m-v,x="Before";break;case"outside-end":R=-1/0,T=1/0,O=S+v,x="After";break;case"inside-start":R=m,T=b,O=m+v,x="After";break;case"inside-end":R=b,T=S,O=S-v,x="Before";break;case"inside-center":R=m,T=S,O=(m+S)/2,x="Center";break;case"bar-inside":R=D,T=b,O=(D+b)/2,x="Center";break;case"bar-inside-end":R=D,T=b,O=b-v,x="Before";break;case"bar-outside-end":R=b,T=S,O=b+v,x="After";break;case"bar-end":R=-1/0,T=1/0,O=b,x="Center";break}const A=c?O:n.x+n.width/2,k=c?n.y+n.height/2:O;let I,N;c?(I=A+UT[x]*g.width,N=I+g.width):(I=k+qT[x]*g.height,N=I+g.height);const L=Math.min(I,N)>=Math.min(R,T)&&Math.max(I,N)<=Math.max(R,T);if(d.avoidCollisions&&!L){p.visible=!1;return}p.visible=!0,p.text=g.text,p.fontSize=g.fontSize,p.lineHeight=g.lineHeight,p.textAlign=c?YT[x]:"center",p.textBaseline=c?"middle":XT[x],p.x=A,p.y=k})}var{fromToMotion:rc,resetMotion:JT,SeriesNodePickMode:zf,StateMachine:ZT,createDatumId:$f,CachedTextMeasurerPool:QT,toRadians:Hf,BBox:Mi,Group:ao,PointerEvents:Yf,Selection:no,Rect:e2,Text:Xf,TransformableText:t2,Marker:i2,LinearScale:o2,AxisTickGenerator:s2,NiceMode:a2,easing:n2,getColorStops:r2,findRangeExtent:l2}=Ko,c2={before:180,middle:0,after:0},p2={before:90,middle:0,after:-90},h2=class{constructor(e){this.gauge=e}get defaultTickMinSpacing(){return 0}get range(){return this.gauge.range}get reverse(){return!1}get scale(){return this.gauge.scale}get label(){return this.gauge.properties.scale.label}get interval(){return this.gauge.properties.scale.interval}formatTick(e,t,i,o,s){const{label:a}=this;return a.formatter?.({value:e,index:t,domain:i,boundSeries:void 0})??(a.format!=null?s?.(e):void 0)??this.gauge.formatLabel(e)}inRange(){return!0}},nn=class extends Ko.Series{constructor(e){super({moduleCtx:e,useLabelLayer:!0,pickModes:[zf.EXACT_SHAPE_MATCH,zf.NEAREST_NODE]}),this.properties=new Xe,this.seriesRect=Mi.NaN,this.gaugeRect=Mi.NaN,this.scale=new o2,this.axis=new h2(this),this.tickGenerator=new s2(this.axis),this.originX=0,this.originY=0,this.scaleGroup=this.contentGroup.appendChild(new ao({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new ao({name:"itemGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new ao({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new ao({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new ao({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new ao({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new ao({name:"tickGroup"})),this.scaleSelection=no.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=no.select(this.itemGroup,()=>this.nodeFactory()),this.targetSelection=no.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=no.select(this.itemTargetLabelGroup,Xf),this.labelSelection=no.select(this.itemLabelGroup,Xf),this.highlightTargetSelection=no.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=no.select(this.tickGroup,t2),this.datumUnion=new Af,this.animationState=new ZT("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=Yf.None,this.tickGroup.pointerEvents=Yf.None}get range(){return this.horizontal?[0,this.gaugeRect.width]:[0,this.gaugeRect.height]}get horizontal(){return this.properties.direction==="horizontal"}get hasData(){return!0}nodeFactory(){const e=new e2;return e.crisp=!0,e}markerFactory(){return new i2}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(e){return If(e,this.properties.scale)}createLinearGradient(e,t,i){const{properties:o,horizontal:s}=this,{defaultColorRange:a}=o;return{type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:r2(t,a,e.domain,i),rotation:s?90:0}}getShapeFillBBox(){const{properties:e,originX:t,originY:i,horizontal:o,scale:s}=this,{thickness:a}=e,n=l2(s.range);return new Mi(t,i,o?n:a,o?a:n)}getTargets(){const{properties:e}=this,t=e.defaultTarget;return Array.from(e.targets).map(i=>{const{text:o=t.text,value:s=t.value??0,shape:a=t.shape??"triangle",rotation:n=t.rotation??0,strokeWidth:r=t.strokeWidth??0,placement:l=t.placement??"middle",spacing:c=t.spacing??0,size:p=t.size??0,fill:d=t.fill??"black",fillOpacity:u=t.fillOpacity??1,stroke:f=t.stroke??"black",strokeOpacity:y=t.strokeOpacity??1,lineDash:g=t.lineDash??[0],lineDashOffset:m=t.lineDashOffset??0}=i,{enabled:S=t.label.enabled,color:D=t.label.color??"black",fontStyle:b=t.label.fontStyle??"normal",fontWeight:v=t.label.fontWeight??"normal",fontSize:R=t.label.fontSize,fontFamily:T=t.label.fontFamily,spacing:O=t.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:l,spacing:c,size:p,rotation:n,fill:d,fillOpacity:u,stroke:f,strokeWidth:r,strokeOpacity:y,lineDash:g,lineDashOffset:m,label:{enabled:S,color:D,fontStyle:b,fontWeight:v,fontSize:R,fontFamily:T,spacing:O}}})}getTargetPoint(e){const{properties:t,originX:i,originY:o,horizontal:s,scale:a,gaugeRect:n}=this,{thickness:r}=t,{value:l,placement:c,spacing:p,size:d}=e,u=a.convert(l);let f;switch(c){case"before":f=-(p+d/2);break;case"after":f=r+p+d/2;break;default:f=r/2;break}return{x:i+n.x+(s?u:f),y:o+n.y+(s?f:u)}}getTargetLabel(e){const{size:t,placement:i,label:o}=e,{spacing:s,color:a,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c}=o,p=void 0,d=t/2+s;let u,f,y=0,g=0;return this.horizontal?(u="center",i==="after"?(f="top",g=d):(f="bottom",g=-d)):(f="middle",i==="before"?(u="right",y=-d):(u="left",y=d)),{offsetX:y,offsetY:g,fill:a,textAlign:u,textBaseline:f,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c,lineHeight:p}}labelDatum(e,t){const{placement:i,avoidCollisions:o,spacing:s,text:a,color:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:p,fontFamily:d,lineHeight:u,wrapping:f,overflowStrategy:y,formatter:g=m=>this.formatLabel(m.value)}=e;return{placement:i,avoidCollisions:o,spacing:s,text:a,value:t,fill:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:p,fontFamily:d,lineHeight:u,wrapping:f,overflowStrategy:y,formatter:g}}verticalLabelInset(){const{properties:e}=this,{label:t}=e,i=t.text?.split(`
`),o=Mo(t,t.fontSize)*(i?.length??1);return t.spacing+o}horizontalLabelInset(){const{scale:e,properties:t}=this,{scale:i,label:o}=t,s=o.text?.split(`
`),a=o.getFont(),n=i.interval.values??e.ticks({nice:!1,interval:i.interval.step,minTickCount:0,maxTickCount:6,tickCount:5}),l=(s??n.map(c=>Ns(this,this.labelDatum(o,c))??"")).reduce((c,p)=>{const{width:d}=QT.measureText(p,{font:a});return Math.max(c,d)},0);return o.spacing+l}createNodeData(){const{id:e,properties:t,horizontal:i,scale:o,seriesRect:s}=this;if(!t.isValid())return;const{value:a,segmentation:n,thickness:r,cornerRadius:l,cornerMode:c,bar:p,scale:d,label:u}=t;o.domain=[d.min,d.max],o.range=i?[0,s.width]:[s.height,0];let f,y;i?(y=1,f=Math.PI/2):d.label.placement==="before"?(y=1,f=0):(y=-1,f=0);const g=f-Math.PI/2;let m,S,D,b;i?(m=0,S=s.width,D=(s.height-r)/2,b=D+r,u.placement==="outside-start"?m+=this.horizontalLabelInset():u.placement==="outside-end"&&(S-=this.horizontalLabelInset())):(m=(s.width-r)/2,S=m+r,b=0,D=s.height,u.placement==="outside-start"?D-=this.verticalLabelInset():u.placement==="outside-end"&&(b+=this.verticalLabelInset())),this.gaugeRect=new Mi(Math.min(m,S),Math.min(D,b),Math.abs(S-m),Math.abs(b-D));const v=0,R=0;o.domain=[d.min,d.max],o.range=i?[m,S]:[D,b];const{ticks:T}=this.tickGenerator.generateTicks({domain:o.domain,primaryTickCount:void 0,visibleRange:[0,1],niceMode:a2.Off,labelX:0,parallelFlipRotation:f,regularFlipRotation:g,sideFlag:y}).tickData,O=!1,x=this.getTargets(),A=[],k=[],I=[],N=[],[L,M]=o.range,E=Math.abs(M-L),C=i?o.convert(a):S,w=i?b:o.convert(a),G=n.enabled?n.spacing/2:0,P=i?G:0,B=i?0:G,_=Math.min(p.thickness??Math.round(p.thicknessRatio*r),r),F=-(r-_)/2,V=i?0:F,W=i?F:0,K=c==="item",$=Math.ceil(E);let U=n.enabled?n.interval.getSegments(o,$):void 0;const Z=p.fill??this.createLinearGradient(o,p.fills,p.fillMode),Q=d.fill??(p.enabled&&d.fills.length===0?d.defaultFill:void 0)??this.createLinearGradient(o,d.fills,d.fillMode);if(U==null&&K){const J=Math.min(...o.domain),j=Math.max(...o.domain),re={value:a,segmentStart:J,segmentEnd:j};if(p.enabled){const Oe=Math.min(l,_/2,E/2)*(O?-1:1),le=i?Oe:0,fe=i?0:Oe;A.push({series:this,itemId:"value",datum:re,datumIndex:{type:0},type:0,x0:v+m-le-V,y0:R+D-fe-W,x1:v+C+le+V,y1:R+w+fe+W,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,fill:Z,horizontalInset:P,verticalInset:B})}const X=Math.min(l,r/2,E/2)*(O?-1:1),Ge=i?X:0,Fe=i?0:X;N.push({series:this,itemId:"scale",datum:re,datumIndex:{type:0},type:0,x0:v+m-Ge,y0:R+D-Fe,x1:v+S+Ge,y1:R+b+Fe,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,fill:Q,horizontalInset:P,verticalInset:B})}else{U??(U=o.domain);const J=v+m-V,j=R+D-W,re=v+C+V,ce=R+w+W;for(let X=0;X<U.length-1;X+=1){const Ge=U[X+0],Fe=U[X+1],pe={value:a,segmentStart:Ge,segmentEnd:Fe},Oe=X===0,le=X===U.length-2,fe=o.convert(Ge),ke=o.convert(Fe),dt=K||Oe?l:0,Pt=K||le?l:0,pi=i?dt:Pt,Vi=Pt,hi=i?Pt:dt,xi=dt;p.enabled&&A.push({series:this,itemId:`value-${X}`,datum:pe,datumIndex:{type:0},type:0,x0:v+(i?fe:m),y0:R+(i?D:fe),x1:v+(i?ke:S),y1:R+(i?b:ke),clipX0:J,clipY0:j,clipX1:re,clipY1:ce,topLeftCornerRadius:pi,topRightCornerRadius:Vi,bottomRightCornerRadius:hi,bottomLeftCornerRadius:xi,fill:Z,horizontalInset:P,verticalInset:B}),N.push({series:this,itemId:`scale-${X}`,datum:pe,datumIndex:{type:0},type:0,x0:v+(i?fe:m),y0:R+(i?D:fe),x1:v+(i?ke:S),y1:R+(i?b:ke),clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:pi,topRightCornerRadius:Vi,bottomRightCornerRadius:hi,bottomLeftCornerRadius:xi,fill:Q,horizontalInset:P,verticalInset:B})}}u.enabled&&I.push(this.labelDatum(u,a));const ee=i?c2:p2;for(let J=0;J<x.length;J+=1){const j=x[J],{value:re,text:ce,shape:X,size:Ge,fill:Fe,fillOpacity:pe,stroke:Oe,strokeWidth:le,strokeOpacity:fe,lineDash:ke,lineDashOffset:dt}=j,Pt=this.getTargetPoint(j),pi=Hf(j.rotation+ee[j.placement]);k.push({series:this,itemId:`target-${J}`,midPoint:Pt,datum:{value:re},datumIndex:{type:1,index:J},type:1,value:re,text:ce,x:Pt.x,y:Pt.y,shape:X,size:Ge,rotation:pi,fill:Fe,fillOpacity:pe,stroke:Oe,strokeOpacity:fe,strokeWidth:le,lineDash:ke,lineDashOffset:dt,label:this.getTargetLabel(j)})}return{itemId:e,nodeData:A,tickData:T,targetData:k,labelData:I,scaleData:N}}updateSelections(e){(this.nodeDataRefresh||e)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(e){if(e!=null&&e.series===this&&e.type===1)return e}update({seriesRect:e}){const{datumSelection:t,labelSelection:i,targetSelection:o,targetLabelSelection:s,scaleSelection:a,highlightTargetSelection:n,tickSelection:r}=this;this.seriesRect=e??Mi.NaN;const l=this.checkResize(e);this.updateSelections(l),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const c=this.contextNodeData?.nodeData??[],p=this.contextNodeData?.labelData??[],d=this.contextNodeData?.targetData??[],u=this.contextNodeData?.scaleData??[],f=this.contextNodeData?.tickData??[],y=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:u,scaleSelection:a}),this.updateScaleNodes({scaleSelection:a}),this.targetSelection=this.updateTargetSelection({targetData:d,targetSelection:o}),this.updateTargetNodes({targetSelection:o,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:d,targetLabelSelection:s}),this.updateTargetLabelNodes({targetLabelSelection:s}),this.datumSelection=this.updateDatumSelection({nodeData:c,datumSelection:t}),this.updateDatumNodes({datumSelection:t}),this.labelSelection=this.updateLabelSelection({labelData:p,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:y!=null?[y]:[],targetSelection:n}),this.updateTargetNodes({targetSelection:n,isHighlight:!0}),this.tickSelection=this.updateTickSelection({tickData:f,tickSelection:r}),this.updateTickNodes({tickSelection:r}),l&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>$f(e.nodeData.length,t.itemId))}updateDatumNodes(e){const{datumSelection:t}=e,{ctx:i,properties:o}=this,{bar:s}=o,{fillOpacity:a,stroke:n,strokeOpacity:r,lineDash:l,lineDashOffset:c}=s,p=this.getStrokeWidth(s.strokeWidth),d=i.animationManager.isSkipped(),u=this.getShapeFillBBox();t.each((f,y)=>{const{topLeftCornerRadius:g,topRightCornerRadius:m,bottomRightCornerRadius:S,bottomLeftCornerRadius:D,fill:b}=y;f.fill=b,f.fillBBox=u,f.fillOpacity=a,f.stroke=n,f.strokeOpacity=r,f.strokeWidth=p,f.lineDash=l,f.lineDashOffset=c,f.topLeftCornerRadius=g,f.topRightCornerRadius=m,f.bottomRightCornerRadius=S,f.bottomLeftCornerRadius=D,f.pointerEvents=this.properties.bar.enabled?Ko.PointerEvents.All:Ko.PointerEvents.None,(d||f.previousDatum==null)&&f.setProperties(an(f,y))}),this.datumUnion.update(t,this.itemGroup,Ko.Rect,(f,y,g)=>{f.pointerEvents=Ko.PointerEvents.None,f.clipBBox??(f.clipBBox=new Mi(NaN,NaN,NaN,NaN)),f.x=y.x,f.y=y.y,f.clipBBox.x=y.clipBBox?.x??y.x,f.clipBBox.y=y.clipBBox?.y??y.y,this.horizontal?(f.height=f.clipBBox.height=g.height,f.width=g===y?g.width:g.x+g.width,f.clipBBox.width=f.width-(g.width-(g.clipBBox?.width??g.width)),f.topLeftCornerRadius=y.topLeftCornerRadius,f.bottomLeftCornerRadius=y.bottomLeftCornerRadius,f.topRightCornerRadius=g.topRightCornerRadius,f.bottomRightCornerRadius=g.bottomRightCornerRadius):(f.width=f.clipBBox.width=g.width,f.height=g===y?g.height:g.x+g.height,f.clipBBox.height=f.height-(g.height-(g.clipBBox?.height??g.height)),f.topLeftCornerRadius=y.topLeftCornerRadius,f.topRightCornerRadius=y.topRightCornerRadius,f.bottomLeftCornerRadius=g.bottomLeftCornerRadius,f.bottomRightCornerRadius=g.bottomRightCornerRadius)})}updateScaleSelection(e){return e.scaleSelection.update(e.scaleData,void 0,t=>$f(e.scaleData.length,t.itemId))}updateScaleNodes(e){const{scaleSelection:t}=e,{scale:i}=this.properties,{fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=i,c=this.getShapeFillBBox();t.each((p,d)=>{const{topLeftCornerRadius:u,topRightCornerRadius:f,bottomRightCornerRadius:y,bottomLeftCornerRadius:g,fill:m}=d;p.fill=m,p.fillBBox=c,p.fillOpacity=o,p.stroke=s,p.strokeOpacity=a,p.strokeWidth=n,p.lineDash=r,p.lineDashOffset=l,p.topLeftCornerRadius=u,p.topRightCornerRadius=f,p.bottomRightCornerRadius=y,p.bottomLeftCornerRadius=g,p.setProperties(an(p,d))})}updateTargetSelection(e){return e.targetSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetNodes(e){const{targetSelection:t,isHighlight:i}=e,o=i?this.properties.highlightStyle.item:void 0;t.each((s,a)=>{const{x:n,y:r,shape:l,size:c,rotation:p,fill:d,fillOpacity:u,stroke:f,strokeOpacity:y,strokeWidth:g,lineDash:m,lineDashOffset:S}=a;s.size=c,s.shape=l==="line"?Mf:l,s.fill=o?.fill??d,s.fillOpacity=o?.fillOpacity??u,s.stroke=o?.stroke??f,s.strokeOpacity=o?.strokeOpacity??y,s.strokeWidth=o?.strokeWidth??g,s.lineDash=o?.lineDash??m,s.lineDashOffset=o?.lineDashOffset??S,s.translationX=n,s.translationY=r,s.rotation=p})}updateTargetLabelSelection(e){return e.targetLabelSelection.update(e.targetData)}updateTargetLabelNodes(e){const{targetLabelSelection:t}=e;t.each((i,o)=>{const{x:s,y:a,text:n}=o,{offsetX:r,offsetY:l,fill:c,fontStyle:p,fontWeight:d,fontSize:u,fontFamily:f,textAlign:y,textBaseline:g}=o.label;i.visible=!0,i.x=s+r,i.y=a+l,i.text=n,i.fill=c,i.fontStyle=p,i.fontWeight=d,i.fontSize=u,i.fontFamily=f,i.textAlign=y,i.textBaseline=g})}updateTickSelection(e){return e.tickSelection.update(e.tickData,void 0,t=>t.tickId)}updateTickNodes(e){const{gaugeRect:t,properties:i}=this,o=i.defaultScale,{enabled:s,color:a,fontFamily:n=o.label.fontFamily,fontSize:r=o.label.fontSize,fontStyle:l,fontWeight:c=o.label.fontWeight,spacing:p}=i.scale.label;let{placement:d}=i.scale.label;const u=Hf(i.scale.label.rotation??0);let f,y,g,m;this.horizontal?(d??(d="after"),f="center",y=d==="before"?"bottom":"top",m=this.originY+t.y+(d==="before"?-p:t.height+p)):(d??(d="before"),f=d==="before"?"end":"start",y="middle",g=this.originX+t.x+(d==="before"?-p:t.width+p)),e.tickSelection.each((S,D)=>{if(!s){S.visible=!1;return}const b=g??D.translationY,v=m??D.translationY;S.visible=!0,S.text=D.tickLabel,S.fill=a,S.fontFamily=n,S.fontSize=r,S.fontStyle=l,S.fontWeight=c,S.textBaseline=y,S.textAlign=f,S.x=b,S.y=v,S.rotationCenterX=b,S.rotationCenterY=v,S.rotation=u})}updateLabelSelection(e){return e.labelSelection.update(e.labelData,void 0,t=>"primary")}updateLabelNodes(e){const{labelSelection:t}=e,i=this.ctx.animationManager.isSkipped();t.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(const{datum:e}of this.labelSelection)if(e.text==null)return!1;return!0}formatLabelText(e){const{labelSelection:t,horizontal:i,scale:o,seriesRect:s,gaugeRect:a}=this,{x:n,y:r,width:l,height:c}=a,p=e?.label??this.properties.value;let d;if(i){const y=o.convert(p);d=new Mi(n,r,y-n,c)}else{const y=o.convert(p);d=new Mi(n,y,l,c-y)}const u={seriesRect:s,gaugeRect:a,barRect:d},{margin:f}=this.properties;jT(this,t,{padding:f,horizontal:i},u,e)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),JT([this.datumSelection],an),this.formatLabelText()}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}animateLabelText(e={}){const{animationManager:t}=this.ctx;let i=0,o=0;if(this.labelSelection.each((s,a)=>{s.opacity=1,i=s.previousDatum?.value??e.from??a.value,o=a.value}),!this.labelsHaveExplicitText())if(i===o)this.formatLabelText({label:o});else{const s=`${this.id}_labels`;t.animate({id:s,groupId:"label",from:{label:i},to:{label:o},phase:e.phase??"update",ease:n2.easeOut,onUpdate:a=>this.formatLabelText(a)})}}animateEmptyUpdateReady(){const{animationManager:e}=this.ctx,{node:t}=Kf(!0,this.horizontal);rc(this.id,"node",e,[this.datumSelection],t,(i,o)=>o.itemId),rc(this.id,"label",e,[this.labelSelection],Tf,()=>"primary"),this.animateLabelText({from:0,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:e}=this.ctx,{node:t}=Kf(!1,this.horizontal);rc(this.id,"node",e,[this.datumSelection],t,(i,o)=>o.itemId),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return[0,1]}getSeriesRange(e,t){return[NaN,NaN]}getLegendData(){return[]}getTooltipContent(e){const{id:t,properties:i}=this,{tooltip:o}=i;if(!i.isValid())return;let s,a;if(e.type===0?(s=i.value,a=i.label.text):{value:s,text:a}=i.targets[e.index],s!=null)return o.formatTooltip(this.properties,{data:[{label:a,fallbackLabel:"Value",value:this.formatLabel(s)}]},{seriesId:t,title:void 0,datum:void 0,value:s})}pickNodeClosestDatum(e){return Cf(this,e)}pickFocus(e){return Pf(this,e)}getCaptionText(){return this.formatLabel(this.properties.value)}getCategoryValue(e){}datumIndexForCategoryValue(e){}};nn.className="LinearGaugeSeries",nn.type="linear-gauge";import{_ModuleSupport as d2}from"ag-charts-community";import{and as Uf,arrayOf as lc,arrayOfDefs as u2,boolean as Is,callback as qf,color as jf,constant as f2,fillOptionsDef as cc,fontOptionsDef as g2,gradientColorStops as y2,greaterThan as m2,lessThan as S2,lineDashOptionsDef as pc,number as ct,or as b2,positiveNumber as gi,ratio as D2,required as hc,string as Jf,strokeOptionsDef as dc,union as ro}from"ag-charts-core";var{commonSeriesOptionsDefs:x2,autoSizedLabelOptionsDefs:v2,seriesLabelOptionsDefs:O2,tooltipOptionsDefs:k2,numberFormatValidator:R2}=d2,rn={fills:y2,fillMode:ro("continuous","discrete")},Zf={value:hc(ct),text:Jf,shape:b2(ro("circle","cross","diamond","heart","plus","pin","square","star","triangle","line"),qf),placement:ro("before","after","middle"),spacing:gi,size:gi,rotation:ct,...cc,...dc,...pc},lo={type:hc(f2("linear-gauge")),value:hc(ct),direction:ro("horizontal","vertical"),cornerMode:ro("container","item"),cornerRadius:gi,thickness:gi,scale:{min:Uf(ct,S2("max")),max:Uf(ct,m2("min")),label:{enabled:Is,formatter:qf,rotation:ct,spacing:gi,minSpacing:gi,placement:ro("before","after"),avoidCollisions:Is,format:R2,...g2},interval:{values:lc(ct),step:ct},...rn,...cc,...dc,...pc},targets:u2(Zf,"target options array"),segmentation:{enabled:Is,spacing:gi,interval:{values:lc(ct),step:ct,count:ct}},bar:{enabled:Is,thickness:gi,thicknessRatio:D2,...rn,...cc,...dc,...pc},label:{...v2,text:Jf,spacing:gi,avoidCollisions:Is,placement:ro("inside-start","outside-start","inside-end","outside-end","inside-center","bar-inside","bar-inside-end","bar-outside-end","bar-end")},tooltip:k2,...x2};lo.margin=ct,lo.defaultColorRange=lc(jf),lo.defaultTarget={...Zf,value:ct,label:{...O2,spacing:ct}},lo.defaultScale=lo.scale,lo.scale.defaultFill=jf;var VF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"linear-gauge",moduleFactory:e=>new nn(e),tooltipDefaults:{range:10},themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{thickness:50,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},Nf.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["./2",Nf.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},label:{spacing:11}},bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:1},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"after",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},defaultScale:{label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},label:{enabled:!1,placement:"inside-start",fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[2]},minimumFontSize:12,spacing:18,color:{$ref:"backgroundColor"}},margin:4}}},Qf={type:"series",name:"linear-gauge",chartType:"gauge",enterprise:!0,options:lo,create:e=>new nn(e)};import{_ModuleSupport as eg}from"ag-charts-community";var Ms={zoom:{axes:"xy",anchorPointX:"pointer",anchorPointY:"pointer",buttons:{anchorPointX:"middle",anchorPointY:"middle"}},legend:{enabled:!1},gradientLegend:{enabled:!1}};import{_ModuleSupport as tg}from"ag-charts-community";import{Logger as ig}from"ag-charts-core";import{_ModuleSupport as N2}from"ag-charts-community";var A2=1e-9;function og(e,t,i,o){const[s,a]=e,[n,r]=t,l=n-s,c=r-a,p=l*l+c*c;let d,u;if(Math.abs(p)<A2)d=s,u=a;else{let g=((i-s)*l+(o-a)*c)/p;g=Math.max(0,Math.min(1,g)),d=s+g*(n-s),u=a+g*(r-a)}const f=i-d,y=o-u;return f*f+y*y}function sg(e,t,i){let o=1/0,s=e[e.length-1];for(const a of e)o=Math.min(o,og(s,a,t,i)),s=a;return Math.sqrt(o)}function uc(e){let[t,i]=e[0],o=0;for(let s=1;s<e.length;s+=1){const[a,n]=e[s],r=Math.hypot(a-t,n-i);o+=r,t=a,i=n}return o}function ln(e){if(e.length===0)return;const t=uc(e)/2;let[i,o]=e[0],s=0;for(let a=1;a<e.length;a+=1){const[n,r]=e[a],l=Math.hypot(n-i,r-o),c=s+l;if(c>t){const p=(t-s)/l,d=[i+(n-i)*p,o+(r-o)*p],u=Math.atan2(r-o,n-i);return{point:d,angle:u}}s=c,i=n,o=r}}import{_ModuleSupport as T2}from"ag-charts-community";var{LonLatBBox:I2}=T2;function Ls(e,t,i,o,s){return e==null?e=new I2(t,i,o,s):(e.lon0=Math.min(e.lon0,t),e.lat0=Math.min(e.lat0,i),e.lon1=Math.max(e.lon1,o),e.lat1=Math.max(e.lat1,s)),e}function co(e,t){return e.forEach(i=>{const[o,s]=i;t=Ls(t,o,s,o,s)}),t}function M2(e){if(e.length===0)return;let t=0,i=0,o=0,[s,a]=e[e.length-1];for(const[n,r]of e){const l=s*r-n*a;o+=l,t+=(s+n)*l,i+=(a+r)*l,s=n,a=r}return o*=3,[t/o,i/o]}function cn(e,t,i){let o=!1,s=1/0;for(const a of e){let n=a[a.length-1],[r,l]=n;for(const c of a){const[p,d]=c;d>i!=l>i&&t<(r-p)*(i-d)/(l-d)+p&&(o=!o),s=Math.min(s,og(n,c,t,i)),n=c,r=p,l=d}}return(o?-1:1)*Math.sqrt(s)}var{Path:L2,ExtendedPath2D:C2,BBox:P2,ScenePathChangeDetection:ag}=N2,$o=class extends L2{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new C2}computeBBox(){return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),this.bbox?.clone()}updatePath(){const{projectedGeometry:e}=this;this.strokePath.clear(),this.path.clear(),this.bbox=e!=null?this.drawGeometry(e,void 0):void 0}drawPath(e){super.drawPath(e),this.renderStroke(e,this.strokePath.getPath2D())}containsPoint(e,t){const{projectedGeometry:i}=this;return i==null||!this.getBBox().containsPoint(e,t)?!1:this.geometryDistance(i,e,t)<=0}distanceSquared(e,t){const{projectedGeometry:i}=this;if(i==null)return 1/0;const o=this.geometryDistance(i,e,t);return o>0?o*o:0}geometryDistance(e,t,i){const{renderMode:o,strokeWidth:s}=this,a=(o&1)!==0,n=(o&2)!==0,r=Math.max(s/2,1)+1;switch(e.type){case"GeometryCollection":return e.geometries.reduce((l,c)=>Math.min(l,this.geometryDistance(c,t,i)),1/0);case"MultiPolygon":return a?e.coordinates.reduce((l,c)=>Math.min(l,Math.max(cn(c,t,i),0)),1/0):1/0;case"Polygon":return a?Math.max(cn(e.coordinates,t,i),0):1/0;case"MultiLineString":return n?e.coordinates.reduce((l,c)=>Math.min(l,Math.max(sg(c,t,i)-r,0)),1/0):1/0;case"LineString":return n?Math.max(sg(e.coordinates,t,i)-r,0):1/0;case"MultiPoint":case"Point":default:return 1/0}}drawGeometry(e,t){const{renderMode:i,path:o,strokePath:s}=this,a=(i&1)!==0,n=(i&2)!==0;switch(e.type){case"GeometryCollection":e.geometries.forEach(r=>{t=this.drawGeometry(r,t)});break;case"MultiPolygon":a&&e.coordinates.forEach(r=>{t=this.drawPolygon(o,r,t)});break;case"Polygon":a&&(t=this.drawPolygon(o,e.coordinates,t));break;case"LineString":n&&(t=this.drawLineString(s,e.coordinates,t,!1));break;case"MultiLineString":n&&e.coordinates.forEach(r=>{t=this.drawLineString(s,r,t,!1)});break;case"Point":case"MultiPoint":break}return t}drawPolygon(e,t,i){if(t.length<1)return i;i=this.drawLineString(e,t[0],i,!0);for(let o=1;o<t.length;o+=1){const s=t[o];this.drawLineString(e,s,void 0,!0)}return i}drawLineString(e,t,i,o){if(t.length<2)return i;const s=o?t.length-1:t.length;for(let a=0;a<s;a+=1){const[n,r]=t[a];if(a===0?e.moveTo(n,r):e.lineTo(n,r),i==null)i=new P2(n,r,0,0);else{const{x:l,y:c}=i,p=l+i.width,d=c+i.height;i.x=Math.min(l,n),i.y=Math.min(c,r),i.width=Math.max(p,n)-i.x,i.height=Math.max(d,r)-i.y}}return o&&e.closePath(),i}};h([ag()],$o.prototype,"projectedGeometry",2),h([ag()],$o.prototype,"renderMode",2);function Ho(e,t){if(e.bbox!=null){const[i,o,s,a]=e.bbox;return t=Ls(t,i,o,s,a),t}switch(e.type){case"GeometryCollection":e.geometries.forEach(i=>{t=Ho(i,t)});break;case"MultiPolygon":e.coordinates.forEach(i=>{i.length>0&&(t=co(i[0],t))});break;case"Polygon":e.coordinates.length>0&&(t=co(e.coordinates[0],t));break;case"MultiLineString":e.coordinates.forEach(i=>{t=co(i,t)});break;case"LineString":t=co(e.coordinates,t);break;case"MultiPoint":e.coordinates.forEach(i=>{const[o,s]=i;t=Ls(t,o,s,o,s)});break;case"Point":{const[i,o]=e.coordinates;t=Ls(t,i,o,i,o);break}}return t}function pn(e){switch(e.type){case"GeometryCollection":{let t,i;return e.geometries.forEach(o=>{const s=pn(o);if(s==null)return;const a=co(s[0],void 0);if(a==null)return;const n=Math.abs(a.lat1-a.lat0)*Math.abs(a.lon1-a.lon0);(t==null||n>t)&&(t=n,i=s)}),i}case"MultiPolygon":{let t,i;return e.coordinates.forEach(o=>{const s=co(o[0],void 0);if(s==null)return;const a=Math.abs(s.lat1-s.lat0)*Math.abs(s.lon1-s.lon0);(t==null||a>t)&&(t=a,i=o)}),i}case"Polygon":return e.coordinates;case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function hn(e){switch(e.type){case"GeometryCollection":{let t,i;return e.geometries.forEach(o=>{const s=hn(o);if(s==null)return;const a=uc(s);a!=null&&(t==null||a>t)&&(t=a,i=s)}),i}case"MultiLineString":{let t=0,i;return e.coordinates.forEach(o=>{const s=uc(o);s>t&&(t=s,i=o)}),i}case"LineString":return e.coordinates;case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function fc(e,t){if(e==null)return!1;switch(e.type){case"GeometryCollection":return e.geometries.some(i=>fc(i,t));case"MultiPolygon":case"Polygon":return(t&1)!==0;case"MultiLineString":case"LineString":return(t&2)!==0;case"MultiPoint":case"Point":return(t&4)!==0}}function Li(e,t){switch(e.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:e.geometries.map(i=>Li(i,t))};case"Polygon":return{type:"Polygon",coordinates:gc(e.coordinates,t)};case"MultiPolygon":return{type:"MultiPolygon",coordinates:E2(e.coordinates,t)};case"MultiLineString":return{type:"MultiLineString",coordinates:gc(e.coordinates,t)};case"LineString":return{type:"LineString",coordinates:yc(e.coordinates,t)};case"MultiPoint":return{type:"MultiPoint",coordinates:yc(e.coordinates,t)};case"Point":return{type:"Point",coordinates:t.convert(e.coordinates)}}}function E2(e,t){return e.map(i=>gc(i,t))}function gc(e,t){return e.map(i=>yc(i,t))}function yc(e,t){return e.map(i=>t.convert(i))}function w2(){return{fromFn:(i,o,s)=>s==="removed"?{scalingX:1,scalingY:1}:i.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:i.scalingX,scalingY:i.scalingY},toFn:(i,o,s)=>s==="removed"?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}}function ng(e,t){const i=e.contextNodeData?.nodeData[t.datumIndex];if(i!==void 0){for(const o of e.datumSelection.nodes())if(o.datum===i)return o}}import{_ModuleSupport as rg}from"ag-charts-community";var XF=class extends rg.SeriesProperties{},Cs=class extends rg.DataModelSeries{addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",e=>{this.onLegendItemClick(e)}),this.ctx.chartEventManager.addListener("legend-item-double-click",e=>{this.onLegendItemDoubleClick(e)}))}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(e,t){return[NaN,NaN]}};import{_ModuleSupport as _2}from"ag-charts-community";var{AND:B2,ARRAY:G2,COLOR_STRING:F2,COLOR_STRING_ARRAY:V2,FUNCTION:W2,LINE_DASH:K2,NUMBER_ARRAY:z2,OBJECT:lg,POSITIVE_NUMBER:mc,RATIO:$2,STRING:Xt,TempValidate:ve,SeriesProperties:H2,SeriesTooltip:Y2,Label:X2}=_2,Se=class extends H2{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new X2,this.tooltip=new Y2}};h([ve(Ro,{optional:!0})],Se.prototype,"topology",2),h([ve(Xt,{optional:!0})],Se.prototype,"title",2),h([ve(Xt,{optional:!0})],Se.prototype,"legendItemName",2),h([ve(Xt)],Se.prototype,"idKey",2),h([ve(Xt)],Se.prototype,"topologyIdKey",2),h([ve(Xt,{optional:!0})],Se.prototype,"idName",2),h([ve(Xt,{optional:!0})],Se.prototype,"labelKey",2),h([ve(Xt,{optional:!0})],Se.prototype,"labelName",2),h([ve(Xt,{optional:!0})],Se.prototype,"sizeKey",2),h([ve(Xt,{optional:!0})],Se.prototype,"sizeName",2),h([ve(Xt,{optional:!0})],Se.prototype,"colorKey",2),h([ve(Xt,{optional:!0})],Se.prototype,"colorName",2),h([ve(z2,{optional:!0})],Se.prototype,"sizeDomain",2),h([ve(B2(V2,G2.restrict({minLength:1})),{optional:!0})],Se.prototype,"colorRange",2),h([ve(mc,{optional:!0})],Se.prototype,"maxStrokeWidth",2),h([ve(F2)],Se.prototype,"stroke",2),h([ve($2)],Se.prototype,"strokeOpacity",2),h([ve(mc)],Se.prototype,"strokeWidth",2),h([ve(K2)],Se.prototype,"lineDash",2),h([ve(mc)],Se.prototype,"lineDashOffset",2),h([ve(W2,{optional:!0})],Se.prototype,"itemStyler",2),h([ve(lg)],Se.prototype,"label",2),h([ve(lg)],Se.prototype,"tooltip",2);var{getMissCount:U2,createDatumId:cg,SeriesNodePickMode:pg,valueProperty:Ps,CachedTextMeasurerPool:q2,ColorScale:j2,LinearScale:J2,Selection:Sc,Text:Z2,Transformable:Q2}=tg,dn=class extends Cs{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[pg.EXACT_SHAPE_MATCH,pg.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new Se,this._chartTopology=void 0,this.colorScale=new j2,this.sizeScale=new J2,this.datumSelection=Sc.select(this.contentGroup,()=>this.nodeFactory()),this.labelSelection=Sc.select(this.labelGroup,Z2),this.highlightDatumSelection=Sc.select(this.highlightNode,()=>this.nodeFactory()),this._previousDatumMidPoint=void 0}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[1,e],this.highlightGroup.zIndex=[2,e],!0):!1}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const e=new $o;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e}async processData(e){if(this.data==null||!this.properties.isValid())return;const{data:t,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,sizeKey:r,colorKey:l,labelKey:c,sizeDomain:p,colorRange:d}=this.properties,u=new Map;i?.features.forEach(b=>{const v=b.properties?.[a];v==null||!fc(b.geometry,2)||u.set(v,b)});const f=this.sizeScale.type,y=this.colorScale.type,g=this.scale?.type,{dataModel:m,processedData:S}=await this.requestDataModel(e,t,{props:[Ps(n,g,{id:"idValue",includeProperty:!1}),Ps(n,g,{id:"featureValue",includeProperty:!1,processor:()=>b=>u.get(b)}),...c!=null?[Ps(c,"band",{id:"labelValue"})]:[],...r!=null?[Ps(r,f,{id:"sizeValue"})]:[],...l!=null?[Ps(l,y,{id:"colorValue"})]:[]]}),D=m.resolveColumnById(this,"featureValue",S);if(this.topologyBounds=D.reduce((b,v)=>{const R=v?.geometry;return R==null?b:Ho(R,b)},void 0),r!=null){const b=m.resolveProcessedDataIndexById(this,"sizeValue"),v=S.domain.values[b]??[];o.domain=p??v}if(d!=null&&this.isColorScaleValid()){const b=m.resolveProcessedDataIndexById(this,"colorValue");s.domain=S.domain.values[b],s.range=d,s.update()}i==null&&ig.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=U2(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(e,t,i,o){if(t==null||i==null)return;const s=hn(i);if(s==null)return;const{idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:p,labelKey:d,labelName:u,label:f}=this.properties,y=this.getLabelText(f,{value:t,datum:e,idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:p,labelKey:d,labelName:u});if(y==null)return;const g=q2.measureText(String(y),{font:o}),m=ln(s);if(m==null)return;const[S,D]=m.point,{width:b,height:v}=g;return{point:{x:S,y:D,size:0},label:{width:b,height:v,text:y},anchor:void 0,placement:void 0}}createNodeData(){const{id:e,dataModel:t,processedData:i,sizeScale:o,properties:s,scale:a}=this,{idKey:n,sizeKey:r,colorKey:l,labelKey:c,label:p}=s;if(t==null||i==null)return;const d=t.resolveColumnById(this,"idValue",i),u=t.resolveColumnById(this,"featureValue",i),f=c!=null?t.resolveColumnById(this,"labelValue",i):void 0,y=r!=null?t.resolveColumnById(this,"sizeValue",i):void 0,g=l!=null?t.resolveColumnById(this,"colorValue",i):void 0,m=s.maxStrokeWidth??s.strokeWidth;o.range=[Math.min(s.strokeWidth,m),m];const S=p.getFont(),D=new Map;i.dataSources.get(this.id)?.forEach((x,A)=>{const k=d[A],I=u[A]?.geometry??void 0,N=I!=null&&a!=null?Li(I,a):void 0;k!=null&&N!=null&&D.set(k,N)});const b=[],v=[],R=[];(i.dataSources.get(this.id)??[]).forEach((x,A)=>{const k=d[A],I=g?.[A],N=y?.[A],L=f?.[A],M=D.get(k);M==null&&R.push(k);const E=this.getLabelDatum(x,L,M,S);E!=null&&v.push(E),b.push({series:this,itemId:n,datum:x,datumIndex:A,idValue:k,labelValue:L,colorValue:I,sizeValue:N,projectedGeometry:M})});const O=10;if(R.length>O){const x=R.length-O;R.length=O,R.push(`(+${x} more)`)}return R.length>0&&ig.warnOnce("some data items do not have matches in the provided topology",R),{itemId:e,nodeData:b,labelData:v}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e,highlightDatumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let i=this.ctx.highlightManager?.getActiveHighlight();i!=null&&(i.series!==this||i.datum==null)&&(i=void 0);const o=this.contextNodeData?.nodeData??[];this.datumSelection=this.updateDatumSelection({nodeData:o,datumSelection:e}),this.updateDatumNodes({datumSelection:e,isHighlight:!1}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:i!=null?[i]:[],datumSelection:t}),this.updateDatumNodes({datumSelection:t,isHighlight:!0})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>cg(t.idValue))}getItemBaseStyle(e){const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return{stroke:i?.stroke??t.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:i?.strokeOpacity??t.strokeOpacity,lineDash:i?.lineDash??t.lineDash,lineDashOffset:i?.lineDashOffset??t.lineDashOffset}}getItemStyleOverrides(e,t,i,o,s,a){const{id:n,properties:r,colorScale:l,sizeScale:c}=this,{colorRange:p,itemStyler:d}=r;let u;if(!a&&i!=null&&(u??(u={}),u.stroke=this.isColorScaleValid()?l.convert(i):p?.[0]??r.stroke),o!=null&&(u??(u={}),u.strokeWidth=c.convert(o,!0)),d!=null){const f=this.cachedDatumCallback(cg(e,a?"highlight":"node"),()=>this.callWithContext(d,{seriesId:n,datum:t,highlighted:a,...s,...u}));u??(u={}),Object.assign(u,f)}return u}updateDatumNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getItemBaseStyle(i);t.each((s,a)=>{const{datum:n,datumIndex:r,colorValue:l,sizeValue:c,projectedGeometry:p}=a;if(p==null){s.visible=!1,s.projectedGeometry=void 0;return}const d=this.getItemStyleOverrides(String(r),n,l,c,o,i);s.visible=!0,s.projectedGeometry=p,s.stroke=d?.stroke??o.stroke,s.strokeWidth=d?.strokeWidth??o.strokeWidth,s.strokeOpacity=d?.strokeOpacity??o.strokeOpacity,s.lineDash=d?.lineDash??o.lineDash,s.lineDashOffset=d?.lineDashOffset??o.lineDashOffset})}updatePlacedLabelData(e){this.labelSelection=this.labelSelection.update(e,t=>{t.pointerEvents=tg.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;t.each((r,{x:l,y:c,width:p,height:d,text:u})=>{r.visible=!0,r.x=l+p/2,r.y=c+d/2,r.text=u,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign="center",r.textBaseline="middle"})}resetAnimation(){}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum({x:e,y:t}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(e,t);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}datumMidPoint(e){const{_previousDatumMidPoint:t}=this;if(t?.datum===e)return t.point;const i=e.projectedGeometry,o=i!=null?hn(i):void 0,s=o!=null?ln(o)?.point:void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:e,point:a},a}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:o}=this,{strokeWidth:s,strokeOpacity:a,lineDash:n}=o;let{stroke:r}=o;if(e!=null&&this.isColorScaleValid()){const c=t.resolveColumnById(this,"colorValue",i)[e];r=this.colorScale.convert(c)}return{marker:{fill:void 0,fillOpacity:0,stroke:void 0,strokeWidth:0,strokeOpacity:0,lineDash:[0],lineDashOffset:0,enabled:!1},line:{stroke:r,strokeWidth:s,strokeOpacity:a,lineDash:n}}}getLegendData(e){const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idKey:r,idName:l,colorKey:c,colorName:p,colorRange:d,showInLegend:u}=this.properties;if(e==="gradient"&&c!=null&&d!=null){const f=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,colorName:p,colorRange:d,colorDomain:f}]}else return e==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??l??r},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!u}]:[]}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{idKey:a,idName:n,colorKey:r,colorName:l,sizeKey:c,sizeName:p,labelKey:d,labelName:u,title:f,legendItemName:y,tooltip:g}=s;if(!i||!o)return;const m=o.dataSources.get(this.id)?.[e],S=i.resolveColumnById(this,"idValue",o),D=[],b=c!=null?i.resolveColumnById(this,"sizeValue",o)[e]:void 0,v=r!=null?i.resolveColumnById(this,"colorValue",o)[e]:void 0;if(c!=null&&D.push({label:p,fallbackLabel:c,value:String(b)}),r!=null&&D.push({label:l,fallbackLabel:r,value:String(v)}),d!=null&&d!==a){const T=i.resolveColumnById(this,"labelValue",o)[e];D.push({label:u,fallbackLabel:d,value:T})}const R=this.getItemBaseStyle(!1);return Object.assign(R,this.getItemStyleOverrides(String(e),e,v,b,R,!1)),g.formatTooltip(this.properties,{heading:S[e],title:f??y,symbol:this.legendItemSymbol(e),data:D},{seriesId:t,datum:m,title:f,idKey:a,idName:n,colorKey:r,colorName:l,sizeKey:c,sizeName:p,labelKey:d,labelName:u,...R})}computeFocusBounds(e){const t=ng(this,e);return t?Q2.toCanvas(this.contentGroup,t.getBBox()):void 0}};dn.className="MapLineSeries",dn.type="map-line";import{_ModuleSupport as eI}from"ag-charts-community";import{and as tI,arrayLength as iI,arrayOf as hg,callback as oI,color as sI,constant as aI,lineDashOptionsDef as nI,object as rI,positiveNumber as dg,required as ug,string as Ut,strokeOptionsDef as fg}from"ag-charts-core";var{commonSeriesOptionsDefs:gg,seriesLabelOptionsDefs:lI,tooltipOptionsDefs:cI}=eI,yg={type:ug(aI("map-line")),idKey:ug(Ut),sizeKey:Ut,colorKey:Ut,labelKey:Ut,idName:Ut,sizeName:Ut,colorName:Ut,labelName:Ut,topology:rI,topologyIdKey:Ut,legendItemName:Ut,maxStrokeWidth:dg,title:Ut,itemStyler:oI,sizeDomain:hg(dg),label:lI,tooltip:cI,...gg,...fg,...nI,highlightStyle:{...gg.highlightStyle,...fg}};yg.colorRange=tI(hg(sI),iI(1));var JF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line",moduleFactory:e=>new dn(e),tooltipDefaults:{range:"exact"},themeTemplate:{...Ms,series:{stroke:eg.SAFE_STROKE_FILL_OPERATION,colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},eg.SAFE_RANGE2_OPERATION]},strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},tooltip:{range:"exact"}}},mg={type:"series",name:"map-line",chartType:"topology",enterprise:!0,options:yg,create:e=>new dn(e)};import"ag-charts-community";import{_ModuleSupport as pI}from"ag-charts-community";import{Logger as hI}from"ag-charts-core";import{_ModuleSupport as dI}from"ag-charts-community";var{COLOR_STRING:uI,LINE_DASH:fI,OBJECT:gI,POSITIVE_NUMBER:Sg,RATIO:yI,TempValidate:po,SeriesProperties:mI,SeriesTooltip:SI}=dI,Ci=class extends mI{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new SI}};h([po(Ro,{optional:!0})],Ci.prototype,"topology",2),h([po(uI)],Ci.prototype,"stroke",2),h([po(yI)],Ci.prototype,"strokeOpacity",2),h([po(Sg)],Ci.prototype,"strokeWidth",2),h([po(fI)],Ci.prototype,"lineDash",2),h([po(Sg)],Ci.prototype,"lineDashOffset",2),h([po(gI)],Ci.prototype,"tooltip",2);var{createDatumId:bI,SeriesNodePickMode:DI,Group:xI,Selection:vI,PointerEvents:OI}=pI,un=class extends Cs{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[DI.EXACT_SHAPE_MATCH]}),this.properties=new Ci,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new xI({name:"itemGroup"})),this.datumSelection=vI.select(this.itemGroup,()=>this.nodeFactory())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[0,e,0],this.highlightGroup.zIndex=[0,e,1],!0):!1}nodeFactory(){const e=new $o;return e.renderMode=2,e.lineJoin="round",e.lineCap="round",e.pointerEvents=OI.None,e}processData(){const{topology:e}=this;this.topologyBounds=e?.features.reduce((t,i)=>{const o=i.geometry;return o==null?t:Ho(o,t)},void 0),e==null&&hI.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:e,topology:t,scale:i}=this;if(t==null)return;const o=[],s=[];return t.features.forEach((a,n)=>{const{geometry:r}=a,l=r!=null&&i!=null?Li(r,i):void 0;l!=null&&o.push({series:this,itemId:n,datum:a,datumIndex:0,index:n,projectedGeometry:l})}),{itemId:e,nodeData:o,labelData:s}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:t=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:t,datumSelection:e}),this.updateDatumNodes({datumSelection:e})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>bI(t.index))}updateDatumNodes(e){const{properties:t}=this,{datumSelection:i}=e,{stroke:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=t,r=this.getStrokeWidth(t.strokeWidth);i.each((l,c)=>{const{projectedGeometry:p}=c;if(p==null){l.visible=!1,l.projectedGeometry=void 0;return}l.visible=!0,l.projectedGeometry=p,l.stroke=o,l.strokeWidth=r,l.strokeOpacity=s,l.lineDash=a,l.lineDashOffset=n})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(e){}computeFocusBounds(e){}};un.className="MapLineBackgroundSeries",un.type="map-line-background";import"ag-charts-community";import{constant as kI,lineDashOptionsDef as RI,object as NI,required as AI,strokeOptionsDef as TI}from"ag-charts-core";var II={type:AI(kI("map-line-background")),topology:NI,...TI,...RI},sV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line-background",moduleFactory:e=>new un(e),tooltipDefaults:{range:"exact"},themeTemplate:{...Ms,series:{stroke:{$path:["./1",{$palette:"stroke"},{$palette:"secondHierarchyColors"}]},strokeWidth:1,lineDash:[0],lineDashOffset:0}}},bg={type:"series",name:"map-line-background",chartType:"topology",enterprise:!0,options:II,create:e=>new un(e)};import{_ModuleSupport as Dg}from"ag-charts-community";import{ValidationError as MI,validate as LI}from"ag-charts-core";import{_ModuleSupport as xg}from"ag-charts-community";import{Logger as CI}from"ag-charts-core";var PI=(e,t,i)=>{let o=e,s=o;for(const a of t)if(o==null||i(o.value,a)>0)o={value:a,next:o},s=o;else{for(s=s;s.next!=null&&i(s.next.value,a)<=0;)s=s.next;s.next={value:a,next:s.next}}return o};function vg(e,t,i){const o=co(e[0],void 0);if(o==null)return;const s=(o.lon0+o.lon1)/2,a=(o.lat0+o.lat1)/2,n=Math.abs(o.lon1-o.lon0),r=Math.abs(o.lat1-o.lat0),l=M2(e[0]),[c,p]=l,d=-cn(e,c,p);let u;const f=(R,T)=>{const x=Math.max(T-d,0);return R-.5*x},y=(R,T,O)=>{const{distance:x,maxDistance:A}=i(e,R,T,O),k=Math.hypot(c-R,p-T),I=Math.min(Math.max(c,R-O/2),R+O/2),N=Math.min(Math.max(p,T-O/2),T+O/2),L=Math.hypot(c-I,p-N),M=f(x,k),E=f(A,L);return{distance:x,maxDistance:A,value:M,maxValue:E,x:R,y:T,stride:O}},g=(R,T,O,x)=>{const A=y(T,O,x);A.maxDistance>=0&&R.push(A)},m=Math.min(n,r)/2;let S={value:y(s,a,m),next:null};for(;S!=null;){const R=S.value,{distance:T,value:O,maxValue:x,x:A,y:k,stride:I}=R;if(S=S.next,T>0&&(u==null||O>u.value)&&(u=R),u!=null&&x-u.value<=t)continue;const N=I/2,L=[];g(L,A-N,k-N,N),g(L,A+N,k-N,N),g(L,A-N,k+N,N),g(L,A+N,k+N,N),L.sort(Og),S=PI(S,L,Og)}if(u==null)return;const{distance:D,x:b,y:v}=u;return{x:b,y:v,distance:D}}var Og=(e,t)=>t.maxValue-e.maxValue;function bc(e,t){const i=vg(e,t,(a,n,r,l)=>{const c=-cn(a,n,r),p=c+l*Math.SQRT2;return{distance:c,maxDistance:p}});if(i==null)return;const{x:o,y:s}=i;return[o,s]}function kg(e,t){let i;switch(e.type){case"GeometryCollection":return e.geometries.flatMap(o=>kg(o,t));case"MultiPoint":return e.coordinates;case"Point":return[e.coordinates];case"MultiPolygon":{const o=pn(e);i=o!=null?bc(o,t):void 0;break}case"Polygon":{const o=e.coordinates;i=o!=null?bc(o,t):void 0;break}case"MultiLineString":{const o=hn(e);i=o!=null?ln(o)?.point:void 0;break}case"LineString":{const o=e.coordinates;i=ln(o)?.point;break}}return i!=null?[i]:[]}import{_ModuleSupport as EI}from"ag-charts-community";var{BBox:wI}=EI;function Rg(e){if(!e)return;const{range:t}=e,i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=new wI(0,0,i,o);return{series:s,axis:s}}import{_ModuleSupport as _I}from"ag-charts-community";var{FillGradientDefaults:BI,FillPatternDefaults:GI,AND:FI,ARRAY:VI,COLOR_STRING:Ng,COLOR_STRING_ARRAY:WI,FUNCTION:KI,NUMBER_ARRAY:zI,OBJECT:fn,OR:$I,COLOR_GRADIENT:HI,COLOR_PATTERN:YI,POSITIVE_NUMBER:gn,RATIO:Ag,STRING:Ze,MARKER_SHAPE:XI,LINE_DASH:UI,TempValidate:se,SeriesProperties:qI,SeriesTooltip:jI,Label:JI}=_I,Tg=class extends JI{constructor(){super(...arguments),this.placement="bottom"}};h([se(Ze)],Tg.prototype,"placement",2);var ae=class extends qI{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape="circle",this.size=6,this.fill="black",this.fillGradientDefaults=new BI,this.fillPatternDefaults=new GI,this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new Tg,this.tooltip=new jI}};h([se(Ro,{optional:!0})],ae.prototype,"topology",2),h([se(Ze,{optional:!0})],ae.prototype,"title",2),h([se(Ze,{optional:!0})],ae.prototype,"legendItemName",2),h([se(Ze,{optional:!0})],ae.prototype,"idKey",2),h([se(Ze)],ae.prototype,"topologyIdKey",2),h([se(Ze,{optional:!0})],ae.prototype,"idName",2),h([se(Ze,{optional:!0})],ae.prototype,"latitudeKey",2),h([se(Ze,{optional:!0})],ae.prototype,"latitudeName",2),h([se(Ze,{optional:!0})],ae.prototype,"longitudeKey",2),h([se(Ze,{optional:!0})],ae.prototype,"longitudeName",2),h([se(Ze,{optional:!0})],ae.prototype,"labelKey",2),h([se(Ze,{optional:!0})],ae.prototype,"labelName",2),h([se(Ze,{optional:!0})],ae.prototype,"sizeKey",2),h([se(Ze,{optional:!0})],ae.prototype,"sizeName",2),h([se(Ze,{optional:!0})],ae.prototype,"colorKey",2),h([se(Ze,{optional:!0})],ae.prototype,"colorName",2),h([se(FI(WI,VI.restrict({minLength:1})),{optional:!0})],ae.prototype,"colorRange",2),h([se(XI)],ae.prototype,"shape",2),h([se(gn)],ae.prototype,"size",2),h([se(gn,{optional:!0})],ae.prototype,"maxSize",2),h([se(zI,{optional:!0})],ae.prototype,"sizeDomain",2),h([se($I(HI,YI,Ng))],ae.prototype,"fill",2),h([se(fn)],ae.prototype,"fillGradientDefaults",2),h([se(fn)],ae.prototype,"fillPatternDefaults",2),h([se(Ag)],ae.prototype,"fillOpacity",2),h([se(Ng)],ae.prototype,"stroke",2),h([se(gn)],ae.prototype,"strokeWidth",2),h([se(Ag)],ae.prototype,"strokeOpacity",2),h([se(UI)],ae.prototype,"lineDash",2),h([se(gn)],ae.prototype,"lineDashOffset",2),h([se(KI,{optional:!0})],ae.prototype,"itemStyler",2),h([se(fn)],ae.prototype,"label",2),h([se(fn)],ae.prototype,"tooltip",2);var{CachedTextMeasurerPool:ZI,fromToMotion:QI,StateMachine:eM,getMissCount:tM,createDatumId:Ig,SeriesNodePickMode:Mg,valueProperty:ho,computeMarkerFocusBounds:iM,ColorScale:oM,LinearScale:sM,Group:aM,Selection:Dc,Text:nM,Marker:xc,applyShapeStyle:rM,getShapeStyle:Lg}=xg,yn=class extends Cs{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[Mg.EXACT_SHAPE_MATCH,Mg.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new ae,this._chartTopology=void 0,this.colorScale=new oM,this.sizeScale=new sM,this.markerGroup=this.contentGroup.appendChild(new aM({name:"markerGroup"})),this.labelSelection=Dc.select(this.labelGroup,nM,!1),this.markerSelection=Dc.select(this.markerGroup,xc,!1),this.highlightMarkerSelection=Dc.select(this.highlightNode,xc),this.animationState=new eM("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},resize:{target:"ready",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){const e=this.properties.latitudeKey!=null&&this.properties.longitudeKey!=null;return super.hasData&&(this.topology!=null||e)}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[3,e],this.highlightGroup.zIndex=[4,e],!0):!1}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}async processData(e){if(this.data==null||!this.properties.isValid())return;const{data:t,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,latitudeKey:r,longitudeKey:l,sizeKey:c,colorKey:p,labelKey:d,sizeDomain:u,colorRange:f}=this.properties,y=new Map;i?.features.forEach(x=>{const A=x.properties?.[a];A!=null&&y.set(A,x)});const g=this.sizeScale.type,m=this.colorScale.type,S=this.scale?.type,D=r!=null&&l!=null,{dataModel:b,processedData:v}=await this.requestDataModel(e,t,{props:[...n!=null?[ho(n,S,{id:"idValue",includeProperty:!1}),ho(n,S,{id:"featureValue",includeProperty:!1,processor:()=>x=>y.get(x)})]:[],...D?[ho(r,S,{id:"latValue"}),ho(l,S,{id:"lonValue"})]:[],...d?[ho(d,"band",{id:"labelValue"})]:[],...c?[ho(c,g,{id:"sizeValue"})]:[],...p?[ho(p,m,{id:"colorValue"})]:[]]}),R=n!=null?b.resolveColumnById(this,"featureValue",v):void 0,T=D?b.resolveColumnById(this,"latValue",v):void 0,O=D?b.resolveColumnById(this,"lonValue",v):void 0;if(this.topologyBounds=v.dataSources.get(this.id)?.reduce((x,A,k)=>{const N=R?.[k]?.geometry;if(N!=null&&(x=Ho(N,x)),T!=null&&O!=null){const L=O[k],M=T[k];x=Ls(x,L,M,L,M)}return x},void 0),c!=null){const x=b.resolveProcessedDataIndexById(this,"sizeValue"),A=v.domain.values[x]??[];o.domain=u??A}if(f!=null&&this.isColorScaleValid()){const x=b.resolveProcessedDataIndexById(this,"colorValue");s.domain=v.domain.values[x],s.range=f,s.update()}this.animationState.transition("updateData")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=tM(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(e,t,i,o,s,a){if(t==null)return;const{idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:p,longitudeName:d,sizeKey:u,sizeName:f,colorKey:y,colorName:g,labelKey:m,labelName:S,label:D,shape:b}=this.properties,{placement:v}=D,R=this.getLabelText(D,{value:t,datum:e,idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:p,longitudeName:d,sizeKey:u,sizeName:f,colorKey:y,colorName:g,labelKey:m,labelName:S});if(R==null)return;const{width:T,height:O}=ZI.measureText(String(R),{font:a}),x=xc.anchor(b);return{point:{x:i,y:o,size:s},label:{width:T,height:O,text:R},anchor:x,placement:v}}createNodeData(){const{id:e,dataModel:t,processedData:i,sizeScale:o,properties:s,scale:a}=this,{idKey:n,latitudeKey:r,longitudeKey:l,sizeKey:c,colorKey:p,labelKey:d,label:u}=s;if(t==null||i==null||a==null)return;const f=r!=null&&l!=null,y=n!=null?t.resolveColumnById(this,"idValue",i):void 0,g=n!=null?t.resolveColumnById(this,"featureValue",i):void 0,m=f?t.resolveColumnById(this,"latValue",i):void 0,S=f?t.resolveColumnById(this,"lonValue",i):void 0,D=d!=null?t.resolveColumnById(this,"labelValue",i):void 0,b=c!=null?t.resolveColumnById(this,"sizeValue",i):void 0,v=p!=null?t.resolveColumnById(this,"colorValue",i):void 0,R=s.maxSize??s.size;o.range=[Math.min(s.size,R),R];const T=u.getFont();let O;y!=null&&g!=null&&(O=new Map,i.dataSources.get(this.id)?.forEach((L,M)=>{const E=y[M],C=g[M]?.geometry??void 0,w=C!=null&&a!=null?Li(C,a):void 0;E!=null&&w!=null&&O.set(E,w)}));const x=[],A=[],k=[];(i.dataSources.get(this.id)??[]).forEach((L,M)=>{const E=y?.[M],C=S?.[M],w=m?.[M],G=v?.[M],P=b?.[M],B=D?.[M],_=P!=null?o.convert(P,!0):s.size,F=E!=null?O?.get(E):void 0;if(E!=null&&Li==null&&k.push(E),C!=null&&w!=null){const[V,W]=a.convert([C,w]),K=this.getLabelDatum(L,B,V,W,_,T);K&&A.push(K),x.push({series:this,itemId:r,datum:L,datumIndex:M,index:-1,idValue:E,lonValue:C,latValue:w,labelValue:B,sizeValue:P,colorValue:G,point:{x:V,y:W,size:_},midPoint:{x:V,y:W}})}else F!=null&&kg(F,1).forEach(([V,W],K)=>{const $=this.getLabelDatum(L,B,V,W,_,T);$&&A.push($),x.push({series:this,itemId:r,datum:L,datumIndex:M,index:K,idValue:E,lonValue:C,latValue:w,labelValue:B,sizeValue:P,colorValue:G,point:{x:V,y:W,size:_},midPoint:{x:V,y:W}})})});const N=10;if(k.length>N){const L=k.length-N;k.length=N,k.push(`(+${L} more)`)}return k.length>0&&CI.warnOnce("some data items do not have matches in the provided topology",k),{itemId:e,nodeData:x,labelData:A}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}checkScaleChange(){return this.previousScale===this.scale?!1:(this.previousScale=this.scale,!0)}update({seriesRect:e}){const t=this.checkResize(e),i=this.checkScaleChange(),{markerSelection:o,highlightMarkerSelection:s}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=this.ctx.highlightManager?.getActiveHighlight();a!=null&&(a.series!==this||a.datum==null)&&(a=void 0);const n=this.contextNodeData?.nodeData??[];this.markerSelection=this.updateMarkerSelection({markerData:n,markerSelection:o}),this.updateMarkerNodes({markerSelection:o,isHighlight:!1,highlightedDatum:a}),this.highlightMarkerSelection=this.updateMarkerSelection({markerData:a!=null?[a]:[],markerSelection:s}),this.updateMarkerNodes({markerSelection:s,isHighlight:!0,highlightedDatum:a}),(i||t)&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePlacedLabelData(e){this.labelSelection=this.labelSelection.update(e,t=>{t.pointerEvents=xg.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;t.each((r,{x:l,y:c,width:p,height:d,text:u})=>{r.visible=!0,r.x=l+p/2,r.y=c+d/2,r.text=u,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign="center",r.textBaseline="middle"})}updateMarkerSelection(e){const{markerData:t,markerSelection:i}=e;return i.update(t,void 0,o=>Ig([o.index,o.idValue,o.lonValue,o.latValue]))}getMarkerItemBaseStyle(e){const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return Lg({shape:t.shape,size:t.size,fill:i?.fill??t.fill,fillOpacity:i?.fillOpacity??t.fillOpacity,stroke:i?.stroke??t.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:i?.strokeOpacity??t.strokeOpacity,lineDash:i?.lineDash??t.lineDash,lineDashOffset:i?.lineDashOffset??t.lineDashOffset},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}getMarkerItemStyleOverrides(e,t,i,o,s,a){const{id:n,properties:r,colorScale:l,sizeScale:c}=this,{colorRange:p,itemStyler:d}=r;let u;if(u??(u={}),!a&&i!=null&&(u.fill=this.isColorScaleValid()?l.convert(i):p?.[0]??r.fill),o!=null&&(u.size=c.convert(o,!0)),d!=null){const f=this.cachedDatumCallback(Ig(e,a?"highlight":"node"),()=>this.callWithContext(d,{seriesId:n,datum:t,highlighted:a,...s,...u}));u??(u={}),Object.assign(u,f)}return u}updateMarkerNodes(e){const{markerSelection:t,isHighlight:i,highlightedDatum:o}=e,s=this.getMarkerItemBaseStyle(i),a=Rg(this.scale);t.each((n,r)=>{const{datumIndex:l,datum:c,point:p,colorValue:d,sizeValue:u}=r,f=this.getMarkerItemStyleOverrides(String(l),c,d,u,s,i);n.shape=f?.shape??s.shape,n.size=f?.size??s.size,rM(n,s,f,a),n.x=p.x,n.y=p.y,n.scalingCenterX=p.x,n.scalingCenterY=p.y,n.zIndex=!i&&o!=null&&c===o.datum?1:0})}isProcessedDataAnimatable(){return!0}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup()}animateMarkers(){const{animationManager:e}=this.ctx,t=w2();QI(this.id,"markers",e,[this.markerSelection,this.highlightMarkerSelection],t)}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum(e){const{x:t,y:i}=e;let o=1/0,s;return this.contextNodeData?.nodeData.forEach(a=>{const{x:n,y:r,size:l}=a.point,c=Math.max(Math.abs(n-t)-l,0),p=Math.max(Math.abs(r-i)-l,0),d=c*c+p*p;d<o&&(o=d,s=a)}),s!=null?{datum:s,distance:Math.sqrt(o)}:void 0}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:o}=this,{shape:s,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:p}=o;let{fill:d}=o;if(e!=null&&this.isColorScaleValid()){const f=t.resolveColumnById(this,"colorValue",i)[e];d=this.colorScale.convert(f)}return{marker:Lg({shape:s,fill:d,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:p},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}}getLegendData(e){const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idName:r,idKey:l,colorKey:c,colorName:p,colorRange:d,showInLegend:u}=this.properties;if(e==="gradient"&&c!=null&&d!=null){const f=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,colorName:p,colorRange:d,colorDomain:f}]}else return e==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??r??l??o},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!u}]:[]}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{idKey:a,idName:n,latitudeKey:r,latitudeName:l,longitudeKey:c,longitudeName:p,colorKey:d,colorName:u,sizeKey:f,sizeName:y,labelKey:g,labelName:m,title:S,legendItemName:D,tooltip:b}=s;if(!i||!o)return;const v=o.dataSources.get(this.id)?.[e],R=f!=null?i.resolveColumnById(this,"sizeValue",o)[e]:void 0,T=d!=null?i.resolveColumnById(this,"colorValue",o)[e]:void 0,O=[];if(R!=null&&O.push({label:y,fallbackLabel:f,value:String(R)}),T!=null&&O.push({label:u,fallbackLabel:d,value:String(T)}),g!=null&&g!==a){const k=i.resolveColumnById(this,"labelValue",o)[e];O.push({label:m,fallbackLabel:g,value:k})}let x;if(a!=null)x=i.resolveColumnById(this,"idValue",o)[e];else if(r!=null&&c!=null){const k=i.resolveColumnById(this,"latValue",o)[e],I=i.resolveColumnById(this,"lonValue",o)[e];x=`${Math.abs(k).toFixed(4)}\xB0 ${k>=0?"N":"S"}, ${Math.abs(I).toFixed(4)}\xB0 ${I>=0?"W":"E"}`}const A=this.getMarkerItemBaseStyle(!1);return Object.assign(A,this.getMarkerItemStyleOverrides(String(e),e,T,R,A,!1)),b.formatTooltip(this.properties,{heading:x,title:S??D,symbol:this.legendItemSymbol(e),data:O},{seriesId:t,datum:v,title:S,idKey:a,idName:n,latitudeKey:r,latitudeName:l,longitudeKey:c,longitudeName:p,colorKey:d,colorName:u,sizeKey:f,sizeName:y,labelKey:g,labelName:m,...A})}getFormattedMarkerStyle(e){const{datumIndex:t,colorValue:i,sizeValue:o}=e,s=this.getMarkerItemBaseStyle(!1);return Object.assign(s,this.getMarkerItemStyleOverrides(String(t),t,i,o,s,!1)),{size:s.size}}computeFocusBounds(e){return iM(this,e)}};yn.className="MapMarkerSeries",yn.type="map-marker";import{_ModuleSupport as lM}from"ag-charts-community";import{arrayOf as Cg,color as cM,constant as pM,fillOptionsDef as hM,object as dM,positiveNumber as Pg,required as uM,string as it,strokeOptionsDef as fM,union as gM}from"ag-charts-core";var{commonSeriesOptionsDefs:Eg,markerOptionsDefs:yM,seriesLabelOptionsDefs:mM,tooltipOptionsDefs:SM,without:bM}=lM,DM={type:uM(pM("map-marker")),idKey:it,latitudeKey:it,longitudeKey:it,sizeKey:it,colorKey:it,labelKey:it,idName:it,latitudeName:it,longitudeName:it,sizeName:it,colorName:it,labelName:it,topology:dM,topologyIdKey:it,legendItemName:it,colorRange:Cg(cM),title:it,maxSize:Pg,sizeDomain:Cg(Pg),label:{placement:gM("top","bottom","left","right"),...mM},tooltip:SM,...Eg,...bM(yM,["enabled"]),highlightStyle:{...Eg.highlightStyle,...hM,...fM}},uV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-marker",moduleFactory:e=>new yn(e),tooltipDefaults:{range:"exact"},themeTemplate:{...Ms,series:{shape:"circle",maxSize:30,fill:{$palette:"fill"},stroke:{$palette:"stroke"},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},Dg.SAFE_RANGE2_OPERATION]},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:Dg.FILL_PATTERN_DEFAULTS,fillOpacity:.5,label:{color:{$ref:"textColor"}}},tooltip:{range:"exact"}}},wg={type:"series",name:"map-marker",chartType:"topology",enterprise:!0,options:DM,create:e=>new yn(e),validate(e,t,i){const o=LI(e,t,i);if(o.valid?.idKey==null&&(o.valid?.latitudeKey==null||o.valid?.longitudeKey==null)){const s=n=>i?`${i}.${n}`:n,a=`Either \`${s("idKey")}\` or both \`${s("latitudeKey")}\` and \`${s("longitudeKey")}\` are required.`;o.errors.push(new MI(a,i,!0))}return o}};import{_ModuleSupport as _g}from"ag-charts-community";import{_ModuleSupport as Bg}from"ag-charts-community";import{Logger as Gg}from"ag-charts-core";function xM(e,{aspectRatio:t,precision:i}){const o=vg(e,i,(l,c,p,d)=>{const u=OM(l,c,p,t),f=u+2*d*t,y=u*Math.SQRT2,g=f*Math.SQRT2;return{distance:y,maxDistance:g}});if(o==null)return;const{x:s,y:a,distance:n}=o,r=n/Math.SQRT2;return{x:s,y:a,maxWidth:r}}function vM(e,t,i,o,s){const[a,n]=e,[r,l]=t,c=1/s,p=r-a,d=l-n,[u,f]=n<=l?e:t,[y,g]=a<=r?e:t,[m,S]=n<=l?t:e,[D,b]=a<=r?t:e;let v=1/0;if(p!==0){const k=d/p;for(let I=0;I<=1;I+=1){const N=I===0?c:-c,L=(k*a-n-N*i+o)/(k-N);if(L>=y&&L<=D){const M=Math.abs(i-L)*2;v=Math.min(v,M)}}}else for(let k=0;k<=1;k+=1){const N=(k===0?c:-c)*(a-i)+o;if(N>=f&&N<=S){const M=Math.abs(o-N)*2*s;v=Math.min(v,M)}}const R=s,T=Math.abs((u-i)/(f-o)),O=Math.abs((m-i)/(S-o));if(S<o&&O<R){const I=Math.abs(o-S)*2*s;v=Math.min(v,I)}else if(f>o&&T<R){const I=Math.abs(o-f)*2*s;v=Math.min(v,I)}const x=Math.abs((g-o)/(y-i)),A=Math.abs((b-o)/(D-i));if(D<i&&A<c){const k=Math.abs(i-D)*2;v=Math.min(v,k)}else if(y>i&&x<c){const k=Math.abs(i-y)*2;v=Math.min(v,k)}return v}function OM(e,t,i,o){let s=!1,a=1/0;for(const n of e){let r=n[n.length-1],[l,c]=r;for(const p of n){const[d,u]=p;u>i!=c>i&&t<(l-d)*(i-u)/(c-u)+d&&(s=!s);const f=vM(r,p,t,i,o);a=Math.min(a,f),r=p,l=d,c=u}}return(s?1:-1)*a}function mn(e,t,i){i>=t&&(e.maxX=Math.min(e.maxX,i-t)),i<=t&&(e.minX=Math.max(e.minX,i-t))}function kM(e,t,i,o,s,a){const n=s-a/2,r=s+a/2,[l,c]=t,[p,d]=i,u=p-l,f=d-c,[y,g]=l<=p?t:i,[m,S]=l<=p?i:t;if(u!==0){const D=f/u;for(let b=0;b<=1;b+=1){const R=((b===0?n:r)-c)/D+l;R>=y&&R<=m&&mn(e,o,R)}}else Math.max(n,Math.min(c,d))<=Math.min(r,Math.max(c,d))&&mn(e,o,l);return m<o&&S>=n&&S<=r?mn(e,o,m):y>o&&g>=n&&g<=r&&mn(e,o,y),e}function RM(e,t,i,o){const s={minX:-1/0,maxX:1/0};for(const r of e){let l=r[r.length-1];for(const c of r)kM(s,l,c,t,i,o),l=c}const{minX:a,maxX:n}=s;return Number.isFinite(a)&&Number.isFinite(n)?{x:t+(a+n)/2,width:n-a}:{x:t,width:0}}import{_ModuleSupport as NM}from"ag-charts-community";var{AND:AM,ARRAY:TM,COLOR_STRING:Fg,COLOR_STRING_ARRAY:IM,COLOR_GRADIENT:MM,COLOR_PATTERN:LM,FUNCTION:CM,LINE_DASH:PM,OR:EM,OBJECT:Sn,POSITIVE_NUMBER:vc,RATIO:Vg,STRING:yi,TempValidate:be,SeriesProperties:wM,SeriesTooltip:_M,FillGradientDefaults:BM,FillPatternDefaults:GM}=NM,ge=class extends wM{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillGradientDefaults=new BM,this.fillPatternDefaults=new GM,this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new ms,this.tooltip=new _M}};h([be(Ro,{optional:!0})],ge.prototype,"topology",2),h([be(yi,{optional:!0})],ge.prototype,"title",2),h([be(yi,{optional:!0})],ge.prototype,"legendItemName",2),h([be(yi)],ge.prototype,"idKey",2),h([be(yi,{optional:!0})],ge.prototype,"idName",2),h([be(yi)],ge.prototype,"topologyIdKey",2),h([be(yi,{optional:!0})],ge.prototype,"labelKey",2),h([be(yi,{optional:!0})],ge.prototype,"labelName",2),h([be(yi,{optional:!0})],ge.prototype,"colorKey",2),h([be(yi,{optional:!0})],ge.prototype,"colorName",2),h([be(AM(IM,TM.restrict({minLength:1})),{optional:!0})],ge.prototype,"colorRange",2),h([be(EM(MM,LM,Fg))],ge.prototype,"fill",2),h([be(Sn)],ge.prototype,"fillGradientDefaults",2),h([be(Sn)],ge.prototype,"fillPatternDefaults",2),h([be(Vg)],ge.prototype,"fillOpacity",2),h([be(Fg)],ge.prototype,"stroke",2),h([be(Vg)],ge.prototype,"strokeOpacity",2),h([be(vc)],ge.prototype,"strokeWidth",2),h([be(PM)],ge.prototype,"lineDash",2),h([be(vc)],ge.prototype,"lineDashOffset",2),h([be(vc)],ge.prototype,"padding",2),h([be(CM,{optional:!0})],ge.prototype,"itemStyler",2),h([be(Sn)],ge.prototype,"label",2),h([be(Sn)],ge.prototype,"tooltip",2);var{getMissCount:FM,createDatumId:Wg,SeriesNodePickMode:Kg,valueProperty:bn,CachedTextMeasurerPool:VM,TextUtils:zg,ColorScale:WM,Group:$g,Selection:Oc,Text:KM,PointerEvents:zM,applyShapeStyle:$M,getShapeStyle:kc}=Bg,Hg=Bg.MercatorScale.fixedScale(),Dn=class extends Cs{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[Kg.EXACT_SHAPE_MATCH,Kg.NEAREST_NODE]}),this.properties=new ge,this._chartTopology=void 0,this.colorScale=new WM,this.itemGroup=this.contentGroup.appendChild(new $g({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new $g({name:"itemLabelGroup"})),this.datumSelection=Oc.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=Oc.select(this.itemLabelGroup,KM),this.highlightDatumSelection=Oc.select(this.highlightNode,()=>this.nodeFactory()),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=zM.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[1,e],this.highlightGroup.zIndex=[2,e],!0):!1}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const e=new $o;return e.renderMode=1,e.lineJoin="round",e}async processData(e){if(this.data==null||!this.properties.isValid())return;const{data:t,topology:i,colorScale:o}=this,{topologyIdKey:s,idKey:a,colorKey:n,labelKey:r,colorRange:l}=this.properties,c=new Map;i?.features.forEach(g=>{const m=g.properties?.[s];m==null||!fc(g.geometry,1)||c.set(m,g)});const p=this.colorScale.type,d=this.scale?.type,{dataModel:u,processedData:f}=await this.requestDataModel(e,t,{props:[bn(a,d,{id:"idValue",includeProperty:!1}),bn(a,d,{id:"featureValue",includeProperty:!1,processor:()=>g=>c.get(g)}),...r?[bn(r,"band",{id:"labelValue"})]:[],...n?[bn(n,p,{id:"colorValue"})]:[]]}),y=u.resolveColumnById(this,"featureValue",f);if(this.topologyBounds=y.reduce((g,m)=>{const S=m?.geometry;return S==null?g:Ho(S,g)},void 0),l!=null&&this.isColorScaleValid()){const g=u.resolveProcessedDataIndexById(this,"colorValue");o.domain=f.domain.values[g],o.range=l,o.update()}i==null&&Gg.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:e}=this.properties;if(!e)return!1;const{dataModel:t,processedData:i}=this;if(!t||!i)return!1;const o=t.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=FM(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelLayout(e,t,i,o,s){if(t==null||o==null)return;const{idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:p,padding:d,label:u}=this.properties,f=this.getLabelText(u,{value:t,datum:e,idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:p});if(f==null)return;const y=VM.measureText(String(f),{font:i}),g=f.split(`
`).length,m=(y.width+2*d)/(g*zg.getLineHeight(u.fontSize)+2*d);if(s?.geometry===o&&s?.labelText===f&&s?.aspectRatio===m)return s;const S=Li(o,Hg),D=pn(S);if(D==null)return;const b=xM(D,{aspectRatio:m,precision:.001});if(b==null)return;const{x:v,y:R,maxWidth:T}=b;return{geometry:o,labelText:f,aspectRatio:m,x:v,y:R,maxWidth:T,fixedPolygon:D}}getLabelDatum(e,t){const{scale:i}=this;if(i==null)return;const{padding:o,label:s}=this.properties,{labelText:a,aspectRatio:n,x:r,y:l,maxWidth:c,fixedPolygon:p}=e,d={width:Math.ceil(c*t),height:Math.ceil(c*t/n),meta:r},u=gs(a,s,{padding:o},(v,R)=>{if(!R)return d;const T=RM(p,r,l,v/t);return{width:T.width*t,height:v,meta:T.x}});if(u==null)return;const[{text:f,fontSize:y,lineHeight:g,width:m},S]=u;if(f===zg.EllipsisChar)return;const D=m<d.width?r:S,b=this.scale.convert(Hg.invert([D,l]));return{x:b[0],y:b[1],text:f,fontSize:y,lineHeight:g}}createNodeData(){const{id:e,dataModel:t,processedData:i,properties:o,scale:s,previousLabelLayouts:a}=this,{idKey:n,colorKey:r,labelKey:l,label:c}=o;if(t==null||i==null)return;const p=s!=null?(s.range[1][0]-s.range[0][0])/s.bounds.width:NaN,d=t.resolveColumnById(this,"idValue",i),u=t.resolveColumnById(this,"featureValue",i),f=l!=null?t.resolveColumnById(this,"labelValue",i):void 0,y=r!=null?t.resolveColumnById(this,"colorValue",i):void 0,g=c.getFont(),m=new Map;this.previousLabelLayouts=m;const S=[],D=[],b=[];(i.dataSources.get(this.id)??[]).forEach((T,O)=>{const x=d[O],A=y?.[O],k=f?.[O],I=u[O]?.geometry??void 0;I==null&&b.push(x);const N=this.getLabelLayout(T,k,g,I,a?.get(x));N!=null&&m.set(x,N);const L=N!=null&&s!=null?this.getLabelDatum(N,p):void 0;L!=null&&D.push(L);const M=I!=null&&s!=null?Li(I,s):void 0;S.push({series:this,itemId:n,datum:T,datumIndex:O,idValue:x,colorValue:A,labelValue:k,projectedGeometry:M})});const R=10;if(b.length>R){const T=b.length-R;b.length=R,b.push(`(+${T} more)`)}return b.length>0&&Gg.warnOnce("some data items do not have matches in the provided topology",b),{itemId:e,nodeData:S,labelData:D}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e,labelSelection:t,highlightDatumSelection:i}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let o=this.ctx.highlightManager?.getActiveHighlight();o!=null&&(o.series!==this||o.datum==null)&&(o=void 0);const s=this.contextNodeData?.nodeData??[],a=this.contextNodeData?.labelData??[];this.datumSelection=this.updateDatumSelection({nodeData:s,datumSelection:e}),this.updateDatumNodes({datumSelection:e,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:a,labelSelection:t}),this.updateLabelNodes({labelSelection:t}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:o!=null?[o]:[],datumSelection:i}),this.updateDatumNodes({datumSelection:i,isHighlight:!0})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>Wg(t.idValue))}getItemBaseStyle(e){const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return kc({fill:i?.fill??t.fill,fillOpacity:i?.fillOpacity??t.fillOpacity,stroke:i?.stroke??t.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:i?.strokeOpacity??t.strokeOpacity,lineDash:i?.lineDash??t.lineDash,lineDashOffset:i?.lineDashOffset??t.lineDashOffset},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}getItemStyleOverrides(e,t,i,o,s){const{id:a,properties:n,colorScale:r}=this,{colorRange:l,itemStyler:c}=n;let p;if(!s&&i!=null&&(p??(p={}),p.fill=this.isColorScaleValid()?r.convert(i):l?.[0]??n.fill),c!=null){const d=this.cachedDatumCallback(Wg(e,s?"highlight":"node"),()=>this.callWithContext(c,{seriesId:a,datum:t,highlighted:s,...o,...p}));p??(p={}),Object.assign(p,d)}return kc(p,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}updateDatumNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getItemBaseStyle(i),s=Rg(this.scale);t.each((a,n)=>{const{datum:r,datumIndex:l,colorValue:c,projectedGeometry:p}=n;if(p==null){a.visible=!1,a.projectedGeometry=void 0;return}const d=this.getItemStyleOverrides(String(l),r,c,o,i);a.visible=!0,a.projectedGeometry=p,$M(a,o,d,s)})}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:o,fontWeight:s,fontFamily:a}=this.properties.label;t.each((n,{x:r,y:l,text:c,fontSize:p,lineHeight:d})=>{n.visible=!0,n.x=r,n.y=l,n.text=c,n.fill=i,n.fontStyle=o,n.fontWeight=s,n.fontSize=p,n.lineHeight=d,n.fontFamily=a,n.textAlign="center",n.textBaseline="middle"})}resetAnimation(){}pickNodeClosestDatum({x:e,y:t}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(e,t);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}datumMidPoint(e){const{_previousDatumMidPoint:t}=this;if(t?.datum===e)return t.point;const i=e.projectedGeometry,o=i!=null?pn(i):void 0,s=o!=null?bc(o,2):void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:e,point:a},a}legendItemSymbol(e){const{dataModel:t,processedData:i,properties:o}=this,{fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c}=o;let{fill:p}=o;if(e!=null&&this.isColorScaleValid()){const u=t.resolveColumnById(this,"colorValue",i)[e];p=this.colorScale.convert(u)}return{marker:kc({fill:p,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}}getLegendData(e){const{processedData:t,dataModel:i}=this;if(t==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idKey:r,idName:l,colorKey:c,colorName:p,colorRange:d,showInLegend:u}=this.properties;if(e==="gradient"&&c!=null&&d!=null){const f=t.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,colorName:p,colorRange:d,colorDomain:f}]}else return e==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??l??r},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!u}]:[]}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:p,legendItemName:d,title:u,tooltip:f}=s;if(!i||!o)return;const y=o.dataSources.get(this.id)?.[e],g=i.resolveColumnById(this,"idValue",o)[e],m=r!=null?i.resolveColumnById(this,"colorValue",o)[e]:void 0,S=[];if(m!=null&&S.push({label:l,fallbackLabel:r,value:String(m)}),c!=null&&c!==a){const b=i.resolveColumnById(this,"labelValue",o)[e];S.push({label:p,fallbackLabel:c,value:b})}const D=this.getItemBaseStyle(!1);return Object.assign(D,this.getItemStyleOverrides(String(e),e,m,D,!1)),f.formatTooltip(this.properties,{heading:g,title:u??d,symbol:this.legendItemSymbol(e),data:S},{seriesId:t,datum:y,title:u,idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:p,...D})}computeFocusBounds(e){return ng(this,e)}};Dn.className="MapShapeSeries",Dn.type="map-shape";import{_ModuleSupport as HM}from"ag-charts-community";import{arrayOf as YM,callback as XM,color as UM,constant as qM,fillOptionsDef as Yg,lineDashOptionsDef as jM,object as JM,positiveNumber as ZM,required as Xg,string as mi,strokeOptionsDef as Ug}from"ag-charts-core";var{commonSeriesOptionsDefs:qg,autoSizedLabelOptionsDefs:QM,tooltipOptionsDefs:eL}=HM,tL={type:Xg(qM("map-shape")),idKey:Xg(mi),colorKey:mi,labelKey:mi,idName:mi,colorName:mi,labelName:mi,topology:JM,topologyIdKey:mi,legendItemName:mi,colorRange:YM(UM),padding:ZM,itemStyler:XM,title:mi,label:QM,tooltip:eL,...qg,...Yg,...Ug,...jM,highlightStyle:{...qg.highlightStyle,...Yg,...Ug}},DV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape",moduleFactory:e=>new Dn(e),tooltipDefaults:{range:"exact"},themeTemplate:{...Ms,series:{fill:{$palette:"fill"},stroke:{$ref:"backgroundColor"},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},_g.SAFE_RANGE2_OPERATION]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:_g.FILL_PATTERN_DEFAULTS,fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{color:{$ref:"backgroundColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:"bold",overflowStrategy:"hide"}},tooltip:{range:"exact"}}},jg={type:"series",name:"map-shape",chartType:"topology",enterprise:!0,options:tL,create:e=>new Dn(e)};import{_ModuleSupport as iL}from"ag-charts-community";import{_ModuleSupport as oL}from"ag-charts-community";import{Logger as sL}from"ag-charts-core";import{_ModuleSupport as aL}from"ag-charts-community";var{FillGradientDefaults:nL,FillPatternDefaults:rL,COLOR_STRING:Jg,COLOR_GRADIENT:lL,COLOR_PATTERN:cL,OR:pL,LINE_DASH:hL,OBJECT:Rc,POSITIVE_NUMBER:Zg,RATIO:Qg,TempValidate:qt,SeriesProperties:dL,SeriesTooltip:uL}=aL,Nt=class extends dL{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillGradientDefaults=new nL,this.fillPatternDefaults=new rL,this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new uL}};h([qt(Ro,{optional:!0})],Nt.prototype,"topology",2),h([qt(pL(lL,cL,Jg))],Nt.prototype,"fill",2),h([qt(Rc)],Nt.prototype,"fillGradientDefaults",2),h([qt(Rc)],Nt.prototype,"fillPatternDefaults",2),h([qt(Qg)],Nt.prototype,"fillOpacity",2),h([qt(Jg)],Nt.prototype,"stroke",2),h([qt(Qg)],Nt.prototype,"strokeOpacity",2),h([qt(Zg)],Nt.prototype,"strokeWidth",2),h([qt(hL)],Nt.prototype,"lineDash",2),h([qt(Zg)],Nt.prototype,"lineDashOffset",2),h([qt(Rc)],Nt.prototype,"tooltip",2);var{createDatumId:fL,SeriesNodePickMode:gL,Selection:yL,Group:mL,PointerEvents:SL,getShapeStyle:bL}=oL,xn=class extends Cs{constructor(e){super({moduleCtx:e,categoryKey:void 0,useLabelLayer:!0,pickModes:[gL.EXACT_SHAPE_MATCH]}),this.properties=new Nt,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new mL({name:"itemGroup"})),this.datumSelection=yL.select(this.itemGroup,()=>this.nodeFactory())}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}getNodeData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(e){this._chartTopology=e,this.topology===e&&(this.nodeDataRefresh=!0)}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[0,e,0],this.highlightGroup.zIndex=[0,e,1],!0):!1}nodeFactory(){const e=new $o;return e.renderMode=1,e.lineJoin="round",e.pointerEvents=SL.None,e}processData(){const{topology:e}=this;this.topologyBounds=e?.features.reduce((t,i)=>{const o=i.geometry;return o==null?t:Ho(o,t)},void 0),e==null&&sL.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:e,topology:t,scale:i}=this;if(t==null)return;const o=[],s=[];return t.features.forEach((a,n)=>{const{geometry:r}=a,l=r!=null&&i!=null?Li(r,i):void 0;l!=null&&o.push({series:this,itemId:n,datum:a,datumIndex:0,index:n,projectedGeometry:l})}),{itemId:e,nodeData:o,labelData:s}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:t=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:t,datumSelection:e}),this.updateDatumNodes({datumSelection:e})}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>fL(t.index))}updateDatumNodes(e){const{properties:t}=this,{datumSelection:i}=e,{fill:o,fillOpacity:s,stroke:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}=t,c=this.getStrokeWidth(t.strokeWidth);i.each((p,d)=>{const{projectedGeometry:u}=d;if(u==null){p.visible=!1,p.projectedGeometry=void 0;return}p.visible=!0,p.projectedGeometry=u;const f=bL({fill:o,fillOpacity:s,stroke:a,strokeWidth:c,strokeOpacity:n,lineDash:r,lineDashOffset:l},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults);p.setProperties(f)})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(e){}pickFocus(){}computeFocusBounds(e){}};xn.className="MapShapeBackgroundSeries",xn.type="map-shape-background";import{_ModuleSupport as DL}from"ag-charts-community";import{constant as xL,fillOptionsDef as vL,lineDashOptionsDef as OL,object as kL,required as RL,strokeOptionsDef as NL}from"ag-charts-core";var{commonSeriesOptionsDefs:AL}=DL,TL={type:RL(xL("map-shape-background")),topology:kL,...AL,...vL,...NL,...OL},AV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape-background",moduleFactory:e=>new xn(e),tooltipDefaults:{range:"exact"},themeTemplate:{...Ms,series:{fill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$ref:"backgroundColor"},strokeWidth:1,fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:[{$mix:[{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"black",.15]},{$mix:[{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"white",.15]}],rotation:0,reverse:!1},fillPatternDefaults:{...iL.FILL_PATTERN_DEFAULTS,fill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]}}}}},ey={type:"series",name:"map-shape-background",chartType:"topology",enterprise:!0,options:TL,create:e=>new xn(e)};import{_ModuleSupport as IL}from"ag-charts-community";import{_ModuleSupport as ML}from"ag-charts-community";import{_ModuleSupport as vn}from"ag-charts-community";import{isDefined as LL}from"ag-charts-core";var{ChartAxisDirection:Si,PolarAxis:CL,diff:PL,fixNumericExtent:EL,groupAccumulativeValueProperty:ty,keyProperty:wL,normaliseGroupTo:_L,resetLabelFn:BL,seriesLabelFadeInAnimation:GL,seriesLabelFadeOutAnimation:FL,valueProperty:VL,animationValidation:WL,createDatumId:iy,SeriesNodePickMode:oy,normalizeAngle360:sy,CategoryScale:KL,motion:ay,applyShapeStyle:zL,isGradientFill:$L,getShapeStyle:Nc}=vn,HL=class extends vn.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},ny=class extends vn.PolarSeries{constructor(e,{animationResetFns:t}){super({moduleCtx:e,categoryKey:"angleValue",useLabelLayer:!0,canHaveAxes:!0,pickModes:[oy.NEAREST_NODE,oy.EXACT_SHAPE_MATCH],animationResetFns:{...t,label:BL}}),this.NodeEvent=HL,this.groupScale=new KL,this.circleCache={r:0,cx:0,cy:0}}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return[];if(e===Si.X)return t.getDomain(this,"angleValue","key",i);{const o=t.getDomain(this,"radiusValue-end","value",i),s=Number.isFinite(o[1]-o[0])?[o[0]>0?0:o[0],o[1]<0?0:o[1]]:[];return EL(s)}}async processData(e){const{angleKey:t,radiusKey:i,normalizedTo:o}=this.properties,s=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid())return;const a=this.getStackId(),n=`${a}-trailing`,r=[];LL(o)&&r.push(_L([a,n],Math.abs(o))),s&&this.processedData&&r.push(PL(this.id,this.processedData)),s&&r.push(WL());const l=this.visible?{}:{forceValue:0},c=this.axes[Si.Y]?.scale.type,p=this.axes[Si.X]?.scale.type;await this.requestDataModel(e,this.data,{props:[wL(t,p,{id:"angleValue"}),VL(i,c,{id:"radiusValue-raw",invalidValue:null,...l}),...ty(i,"normal","current",{id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:a,separateNegative:!0,...l},c),...ty(i,"trailing","current",{id:"radiusValue-start",invalidValue:null,groupId:n,separateNegative:!0,...l},c),...r],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,o=this.circleCache;return e!==o.r||t!==o.cx||i!==o.cy?(this.circleCache={r:e,cx:t,cy:i},!0):!1}isRadiusAxisReversed(){return this.axes[Si.Y]?.isReversed()}maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:t=[]}=this.createNodeData()??{};this.nodeData=t,this.nodeDataRefresh=!1}getAxisInnerRadius(){const e=this.axes[Si.Y];return e instanceof CL?this.radius*e.innerRadiusRatio:0}createNodeData(){const{processedData:e,dataModel:t,groupScale:i}=this;if(!t||!e||e.type!=="grouped"||!this.properties.isValid())return;const o=this.axes[Si.X],s=this.axes[Si.Y],a=o?.scale,n=s?.scale;if(!a||!n)return;const r=t.resolveKeysById(this,"angleValue",e),l=t.resolveColumnById(this,"radiusValue-start",e),c=t.resolveColumnById(this,"radiusValue-end",e),p=t.resolveColumnById(this,"radiusValue-raw",e),d=t.resolveProcessedDataIndexById(this,"radiusValue-range");let u=0,f=0;o instanceof Wi&&(u=o.groupPaddingInner,f=o.paddingInner);const g=(a.bandwidth??0)*(1-f),{index:m,visibleGroupCount:S}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);i.domain=Array.from({length:S}).map((C,w)=>String(w)),i.range=[-g/2,g/2],i.paddingInner=S>1?u:0;const D=this.isRadiusAxisReversed(),b=D?this.radius:this.getAxisInnerRadius(),v=D?this.getAxisInnerRadius():this.radius,R=v+b,{angleKey:T,radiusKey:O,angleName:x,radiusName:A,label:k}=this.properties,I=(C,w,G,P)=>{const B=this.getLabelText(k,{value:w,datum:C,angleKey:T,radiusKey:O,angleName:x,radiusName:A});if(B)return{x:G,y:P,text:B,textAlign:"center",textBaseline:"middle"}},N=[],L={itemId:O,nodeData:N,labelData:N};if(!this.visible)return L;const{dataSources:M}=e,E=M.get(this.id)??[];for(const{datumIndex:C,group:w}of t.forEachGroupDatum(this,e)){const G=E[C],P=r[C];if(P==null)return;const B=p[C],_=B>=0&&!Object.is(B,-0),F=l[C],V=c[C],W=w.aggregation[d][_?1:0]??0,K=_===D;if(F===void 0||V===void 0)return;let $,U;if(E.length===1)$=-.5*Math.PI,U=1.5*Math.PI;else{const pe=a.convert(P);$=sy(pe+i.convert(String(m))),U=sy($+i.bandwidth)}const Z=$+i.bandwidth/2,Q=R-n.convert(F),ee=R-n.convert(V),J=(Q+ee)/2,j=R-n.convert(0),re=R-n.convert(W),ce=Math.cos(Z)*J,X=Math.sin(Z)*J,Ge=this.properties.label.enabled?I(G,B,ce,X):void 0,Fe=this.getColumnWidth($,U);N.push({series:this,datum:G,datumIndex:C,point:{x:ce,y:X,size:0},midPoint:{x:ce,y:X},label:Ge,angleValue:P,radiusValue:B,negative:K,innerRadius:Q,outerRadius:ee,stackInnerRadius:j,stackOuterRadius:re,startAngle:$,endAngle:U,midAngle:Z,axisInnerRadius:b,axisOuterRadius:v,columnWidth:Fe,index:C})}return{itemId:O,nodeData:N,labelData:N}}getColumnWidth(e,t){return NaN}update({seriesRect:e}){const t=this.checkResize(e);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemBaseStyle(e){const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return Nc({fill:i?.fill??t.fill,fillOpacity:i?.fillOpacity??t.fillOpacity,stroke:i?.stroke??t.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:i?.strokeOpacity??t.strokeOpacity,lineDash:i?.lineDash??t.lineDash,lineDashOffset:i?.lineDashOffset??t.lineDashOffset,cornerRadius:t.cornerRadius},t.fillGradientDefaults,t.fillPatternDefaults)}getItemStyleOverrides(e,t,i,o){const{id:s,properties:a}=this,{angleKey:n,radiusKey:r,itemStyler:l,fillGradientDefaults:c,fillPatternDefaults:p}=a;if(l==null)return;const d=this.cachedDatumCallback(iy(e,o?"highlight":"node"),()=>this.callWithContext(l,{seriesId:s,datum:t,highlighted:o,angleKey:n,radiusKey:r,...i}));return Nc(d,c,p)}updateSectorSelection(e,t){let i=[];if(t){const l=this.ctx.highlightManager?.getActiveHighlight();l?.datum&&l.series===this&&i.push(l)}else i=this.nodeData;const o=this.isRadiusAxisReversed(),s=o?this.radius:this.getAxisInnerRadius(),a=o?this.getAxisInnerRadius():this.radius,n=this.getShapeFillBBox(),r=this.getItemBaseStyle(t);e.update(i,void 0,l=>this.getDatumId(l)).each((l,c)=>{const{datum:p,datumIndex:d,midPoint:u}=c,f=this.getItemStyleOverrides(String(d),p,r,t),y=f?.fill??r.fill,m=$L(y)&&y.bounds==="item"?{centerX:u?.x??0,centerY:u?.y??0}:{centerX:0,centerY:0,innerRadius:s,outerRadius:a};this.updateItemPath(l,c,t),zL(l,r,f,n,m),l.cornerRadius=f?.cornerRadius??r.cornerRadius,l.lineJoin="round"})}updateLabels(){const{label:e}=this.properties;this.labelSelection.update(this.nodeData).each((t,i)=>{e.enabled&&i.label?(t.x=i.label.x,t.y=i.label.y,t.fill=e.color,t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=i.label.text,t.textAlign=i.label.textAlign,t.textBaseline=i.label.textBaseline,t.visible=!0):t.visible=!1})}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getColumnTransitionFunctions();ay.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),GL(this,"labels",this.ctx.animationManager,e)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getColumnTransitionFunctions();ay.fromToMotion(this.id,"datums",t,[e],i),FL(this,"labels",t,this.labelSelection)}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,tooltip:p}=a,d=s[Si.X],u=s[Si.Y];if(!i||!o||!d||!u)return;const f=o.dataSources.get(this.id)?.[e],y=i.resolveKeysById(this,"angleValue",o)[e],g=i.resolveColumnById(this,"radiusValue-raw",o)[e];if(y==null)return;const m=this.getItemBaseStyle(!1);return Object.assign(m,this.getItemStyleOverrides(String(e),e,m,!1)),p.formatTooltip(this.properties,{heading:d.formatDatum(y),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:u.formatDatum(g)}]},{seriesId:t,datum:f,title:r,angleKey:n,angleName:r,radiusKey:l,radiusName:c,...m})}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.itemSelection.nodes())}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n,fillGradientDefaults:r,fillPatternDefaults:l}=this.properties,c=Nc({fill:e??"rgba(0, 0, 0, 0)",stroke:t??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n},r,l);return vn.isGradientFill(c.fill)&&(c.fill={...c.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:c}}getLegendData(e){if(!this.properties.isValid()||e!=="category")return[];const{id:t,visible:i}=this,{radiusKey:o,radiusName:s,showInLegend:a}=this.properties;return[{legendType:"category",id:t,itemId:o,seriesId:t,enabled:i,label:{text:s??o},symbol:this.legendItemSymbol(),hideInLegend:!a}]}getDatumId(e){return iy(e.angleValue)}computeLabelsBBox(){return null}};import{_ModuleSupport as YL}from"ag-charts-community";var{SeriesProperties:XL,FillGradientDefaults:UL,FillPatternDefaults:qL,SeriesTooltip:jL,TempValidate:we,COLOR_STRING:ry,NUMBER:ly,FUNCTION:JL,LINE_DASH:ZL,OBJECT:On,POSITIVE_NUMBER:Ac,RATIO:cy,STRING:Es,Label:QL,OR:eC,COLOR_GRADIENT:tC,COLOR_PATTERN:iC}=YL,Ae=class extends XL{constructor(){super(...arguments),this.fill="black",this.fillGradientDefaults=new UL,this.fillPatternDefaults=new qL,this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new QL,this.tooltip=new jL}};h([we(Es)],Ae.prototype,"angleKey",2),h([we(Es,{optional:!0})],Ae.prototype,"angleName",2),h([we(Es)],Ae.prototype,"radiusKey",2),h([we(Es,{optional:!0})],Ae.prototype,"radiusName",2),h([we(eC(tC,iC,ry))],Ae.prototype,"fill",2),h([we(On)],Ae.prototype,"fillGradientDefaults",2),h([we(On)],Ae.prototype,"fillPatternDefaults",2),h([we(cy)],Ae.prototype,"fillOpacity",2),h([we(ry)],Ae.prototype,"stroke",2),h([we(Ac)],Ae.prototype,"strokeWidth",2),h([we(cy)],Ae.prototype,"strokeOpacity",2),h([we(ZL)],Ae.prototype,"lineDash",2),h([we(Ac)],Ae.prototype,"lineDashOffset",2),h([we(Ac)],Ae.prototype,"cornerRadius",2),h([we(JL,{optional:!0})],Ae.prototype,"itemStyler",2),h([we(ly)],Ae.prototype,"rotation",2),h([we(Es,{optional:!0})],Ae.prototype,"stackGroup",2),h([we(ly,{optional:!0})],Ae.prototype,"normalizedTo",2),h([we(On)],Ae.prototype,"label",2),h([we(On)],Ae.prototype,"tooltip",2);import{_ModuleSupport as oC}from"ag-charts-community";import{_ModuleSupport as sC}from"ag-charts-community";var{motion:aC}=sC;function py(){const e={startAngle:new Map,endAngle:new Map},t=["startAngle","endAngle"],i=(n,r,l)=>{t.forEach(c=>{const p=e[c];let d=(l==="removed"||l==="updated"?n:r)[c],u=(l==="removed"?n:r)[c];isNaN(u)&&(u=n.previousDatum?.[c]??NaN);const f=d-u;Math.abs(f)>Math.PI&&(d-=Math.sign(f)*2*Math.PI),p.set(r,{from:d,to:u})})},o=(n,r)=>({startAngle:e.startAngle.get(n)[r],endAngle:e.endAngle.get(n)[r]});return{calculate:i,from:n=>o(n,"from"),to:n=>o(n,"to")}}function hy(e,t,i){if(i==="updated"){if(e.previousDatum==null||isNaN(e.previousDatum.startAngle)||isNaN(e.previousDatum.endAngle))return"added";if(isNaN(t.startAngle)||isNaN(t.endAngle))return"removed"}return i==="added"&&e.previousDatum!=null?"updated":i}function nC(e){const t=py();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=t.to(a);let c,p,d,u,f;return n==="removed"?(c=s.innerRadius,p=s.innerRadius,d=s.columnWidth,u=s.axisInnerRadius,f=s.axisOuterRadius):(c=isNaN(a.innerRadius)?e:a.innerRadius,p=isNaN(a.outerRadius)?e:a.outerRadius,d=isNaN(a.columnWidth)?s.columnWidth:a.columnWidth,u=a.axisInnerRadius,f=a.axisOuterRadius),{innerRadius:c,outerRadius:p,columnWidth:d,axisInnerRadius:u,axisOuterRadius:f,startAngle:r,endAngle:l}},fromFn:(s,a,n)=>{n=hy(s,a,n),t.calculate(s,a,n);const{startAngle:r,endAngle:l}=t.from(a);let c,p,d,u,f;n==="removed"||n==="updated"?(c=s.innerRadius,p=s.outerRadius,d=s.columnWidth,u=s.axisInnerRadius,f=s.axisOuterRadius):(c=e,p=e,d=a.columnWidth,u=a.axisInnerRadius,f=a.axisOuterRadius);const y=aC.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:p,columnWidth:d,axisInnerRadius:u,axisOuterRadius:f,startAngle:r,endAngle:l,phase:y}}}}function rC(e,{innerRadius:t,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}){return{innerRadius:t,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}}var{SectorBox:kn,motion:lC}=oC;function Tc(e){const{negative:t,innerRadius:i,outerRadius:o,stackInnerRadius:s,stackOuterRadius:a}=e;return{innerRadius:t?a:s,outerRadius:t?s:a,clipInnerRadius:t?o:i,clipOuterRadius:t?i:o}}function cC(e){const t=py();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=t.to(a);let c,p,d;if(n==="removed")c=e,p=e,d=new kn(r,l,c,p);else{let u,f;({innerRadius:c,outerRadius:p,clipInnerRadius:u,clipOuterRadius:f}=Tc(a)),isNaN(c)&&(c=e),isNaN(p)&&(p=e),isNaN(u)&&(u=e),isNaN(f)&&(f=e),d=new kn(r,l,u,f)}return{innerRadius:c,outerRadius:p,startAngle:r,endAngle:l,clipSector:d}},fromFn:(s,a,n)=>{n=hy(s,a,n),t.calculate(s,a,n);const{startAngle:r,endAngle:l}=t.from(a);let c,p,d;n==="removed"||n==="updated"?(c=s.innerRadius,p=s.outerRadius,d=s.clipSector):(c=e,p=e),d??(d=new kn(r,l,c,p));const u=lC.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:p,startAngle:r,endAngle:l,clipSector:d,phase:u}}}}function pC(e,t){const{startAngle:i,endAngle:o}=t,{innerRadius:s,outerRadius:a,clipInnerRadius:n,clipOuterRadius:r}=Tc(t),l=new kn(i,o,n,r);return{innerRadius:s,outerRadius:a,startAngle:i,endAngle:o,clipSector:l}}var{Sector:hC,SectorBox:dC,PolarZIndexMap:Ic}=ML,Rn=class extends ny{constructor(e){super(e,{animationResetFns:{item:pC}}),this.properties=new Ae}setSeriesIndex(e){return super.setSeriesIndex(e)?(this.contentGroup.zIndex=[0,Ic.FOREGROUND,e],this.highlightGroup.zIndex=[0,Ic.HIGHLIGHT,e],this.labelGroup.zIndex=[0,Ic.LABEL,e],!0):!1}getStackId(){return`nightingale-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new hC}updateItemPath(e,t,i){const{negative:o}=t;if(e.centerX=0,e.centerY=0,e.startOuterCornerRadius=o?0:this.properties.cornerRadius,e.endOuterCornerRadius=o?0:this.properties.cornerRadius,e.startInnerCornerRadius=o?this.properties.cornerRadius:0,e.endInnerCornerRadius=o?this.properties.cornerRadius:0,i){const{startAngle:s,endAngle:a}=t,{innerRadius:n,outerRadius:r,clipInnerRadius:l,clipOuterRadius:c}=Tc(t);e.innerRadius=n,e.outerRadius=r,e.startAngle=s,e.endAngle=a,e.clipSector=new dC(s,a,l,c)}}getColumnTransitionFunctions(){const e=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return cC(e)}};Rn.className="NightingaleSeries",Rn.type="nightingale";import{_ModuleSupport as uC}from"ag-charts-community";import{boolean as dy,callback as fC,constant as gC,fillOptionsDef as yC,lineDashOptionsDef as mC,number as SC,positiveNumber as bC,required as Mc,string as ws,strokeOptionsDef as DC}from"ag-charts-core";var{commonSeriesOptionsDefs:xC,seriesLabelOptionsDefs:vC,tooltipOptionsDefs:OC}=uC,kC={type:Mc(gC("nightingale")),angleKey:Mc(ws),radiusKey:Mc(ws),angleName:ws,radiusName:ws,grouped:dy,stacked:dy,stackGroup:ws,normalizedTo:SC,cornerRadius:bC,itemStyler:fC,label:vC,tooltip:OC,...xC,...yC,...DC,...mC};import{_ModuleSupport as uy}from"ag-charts-community";var{ThemeConstants:{POLAR_AXIS_TYPE:fy,POLAR_AXIS_SHAPE:RC}}=uy,gy={$path:["./shape",RC.CIRCLE,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]},NC={series:{fill:{$palette:"fill"},stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"backgroundColor"},{$palette:"stroke"}]},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:uy.FILL_PATTERN_DEFAULTS,strokeWidth:1,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},axes:{[fy.ANGLE_CATEGORY]:{shape:gy,groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[fy.RADIUS_NUMBER]:{shape:gy}}},{ThemeConstants:{POLAR_AXIS_TYPE:yy}}=IL,GV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"nightingale",moduleFactory:e=>new Rn(e),tooltipDefaults:{range:"exact"},defaultAxes:[{type:yy.ANGLE_CATEGORY},{type:yy.RADIUS_NUMBER}],themeTemplate:NC,stackable:!0,groupable:!0,stackedByDefault:!0},my={type:"series",name:"nightingale",chartType:"polar",enterprise:!0,options:kC,create:e=>new Rn(e)};import"ag-charts-community";import{_ModuleSupport as Sy}from"ag-charts-community";import{_ModuleSupport as AC}from"ag-charts-community";var{SeriesProperties:TC,FillGradientDefaults:IC,FillPatternDefaults:MC,SeriesTooltip:LC,TempValidate:Te,UNION:CC,OR:PC,ARRAY_OF:EC,COLOR_GRADIENT:wC,COLOR_STRING:_C,COLOR_STRING_ARRAY:BC,FUNCTION:GC,DIRECTION:FC,BOOLEAN:VC,LINE_DASH:WC,OBJECT:Yo,NUMBER:KC,POSITIVE_NUMBER:Nn,COLOR_PATTERN:zC,RATIO:by,STRING:Dy,Label:xy,DropShadow:$C}=AC,HC=class extends xy{},Lc=class extends xy{constructor(){super(...arguments),this.spacing=0}};h([Te(KC)],Lc.prototype,"spacing",2),h([Te(CC(["before","after"],"a placement"))],Lc.prototype,"placement",2);var Ce=class extends TC{constructor(){super(...arguments),this.fills=[],this.fillGradientDefaults=new IC,this.fillPatternDefaults=new MC,this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.direction="vertical",this.reverse=void 0,this.spacing=0,this.aspectRatio=void 0,this.shadow=new $C().set({enabled:!1}),this.label=new HC,this.stageLabel=new Lc,this.tooltip=new LC}};h([Te(Dy)],Ce.prototype,"stageKey",2),h([Te(Dy)],Ce.prototype,"valueKey",2),h([Te(EC(PC(wC,zC,_C)))],Ce.prototype,"fills",2),h([Te(Yo)],Ce.prototype,"fillGradientDefaults",2),h([Te(Yo)],Ce.prototype,"fillPatternDefaults",2),h([Te(by)],Ce.prototype,"fillOpacity",2),h([Te(BC)],Ce.prototype,"strokes",2),h([Te(Nn)],Ce.prototype,"strokeWidth",2),h([Te(by)],Ce.prototype,"strokeOpacity",2),h([Te(WC)],Ce.prototype,"lineDash",2),h([Te(Nn)],Ce.prototype,"lineDashOffset",2),h([Te(FC)],Ce.prototype,"direction",2),h([Te(VC,{optional:!0})],Ce.prototype,"reverse",2),h([Te(Nn)],Ce.prototype,"spacing",2),h([Te(Nn,{optional:!0})],Ce.prototype,"aspectRatio",2),h([Te(GC,{optional:!0})],Ce.prototype,"itemStyler",2),h([Te(Yo)],Ce.prototype,"shadow",2),h([Te(Yo)],Ce.prototype,"label",2),h([Te(Yo)],Ce.prototype,"stageLabel",2),h([Te(Yo)],Ce.prototype,"tooltip",2);function vy(e,{x:t,y:i,top:o,right:s,bottom:a,left:n}){e.x0=t-o/2,e.x1=t+o/2,e.x2=t+a/2,e.x3=t-a/2,e.y0=i-n/2,e.y1=i-s/2,e.y2=i+s/2,e.y3=i+n/2}function YC(e){return{fromFn:(s,a)=>{const{x:n,y:r}=a;let{top:l,right:c,bottom:p,left:d}=a;return e==="vertical"?(l=0,p=0):(d=0,c=0),{x:n,y:r,top:l,right:c,bottom:p,left:d}},toFn:(s,a)=>{const{x:n,y:r,top:l,right:c,bottom:p,left:d}=a;return{x:n,y:r,top:l,right:c,bottom:p,left:d}},applyFn:vy}}var{StateMachine:XC,valueProperty:Oy,SeriesNodePickMode:ky,CachedTextMeasurerPool:UC,TextUtils:qC,createDatumId:jC,BBox:Cc,Group:Pc,Selection:An,Text:Ry,PointerEvents:Ny,applyShapeStyle:JC,fromToMotion:ZC,seriesLabelFadeInAnimation:QC,getShapeStyle:Ec}=Sy,wc=class extends Sy.DataModelSeries{constructor(e){super({moduleCtx:e,categoryKey:void 0,pickModes:[ky.EXACT_SHAPE_MATCH,ky.NEAREST_NODE]}),this.properties=new Ce,this.itemGroup=this.contentGroup.appendChild(new Pc({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Pc({name:"itemLabelGroup"})),this.stageLabelGroup=this.contentGroup.appendChild(new Pc({name:"stageLabelGroup"})),this.datumSelection=An.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=An.select(this.itemLabelGroup,Ry),this.stageLabelSelection=An.select(this.stageLabelGroup,Ry),this.highlightDatumSelection=An.select(this.highlightNode,()=>this.nodeFactory()),this.animationState=new XC("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{clear:"empty",reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable()),this.itemLabelGroup.pointerEvents=Ny.None,this.stageLabelGroup.pointerEvents=Ny.None}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager?.addListener("legend-item-click",e=>this.onLegendItemClick(e)))}nodeFactory(){return new ai}getNodeData(){return this.contextNodeData?.nodeData}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}async processData(e){if(this.data==null||!this.properties.isValid())return;const{id:t,visible:i,ctx:{legendManager:o}}=this,{stageKey:s,valueKey:a}=this.properties,n="band",r="number",l=(p,d,u)=>i&&o.getItemEnabled({seriesId:t,itemId:u}),c=this.visible?{}:{forceValue:0};await this.requestDataModel(e,this.data,{props:[Oy(s,n,{id:"xValue"}),Oy(a,r,{id:"yValue",...c,validation:l,invalidValue:0})]})}createNodeData(){const{id:e,dataModel:t,processedData:i,properties:o,visible:s,ctx:{legendManager:a}}=this,{stageKey:n,valueKey:r,direction:l,reverse:c=l==="horizontal",spacing:p,aspectRatio:d,label:u,stageLabel:f}=o;if(t==null||i==null)return;const y=l==="horizontal",g=t.resolveColumnById(this,"xValue",i),m=t.resolveColumnById(this,"yValue",i),S=UC.getMeasurer({font:f.getFont()});let D,b;y?(D="center",b=f.placement==="before"?"bottom":"top"):(D=f.placement==="after"?"left":"right",b="middle");const v=f.enabled?[]:void 0;let R=0,T=0,O=0;const x=i.dataSources.get(this.id)??[];x.forEach((B,_)=>{const F=g[_],V=m[_],W=s&&a.getItemEnabled({seriesId:e,itemId:_});if(O+=V,v==null)return;const K=this.getLabelText(this.properties.stageLabel,{datum:B,value:F,stageKey:n,valueKey:r}),{width:$}=S.measureText(K),U=K.split(`
`).length*qC.getLineHeight(u.fontSize);R=Math.max(R,$),T=Math.max(T,U),v.push({x:NaN,y:NaN,text:K,textAlign:D,textBaseline:b,visible:W})});const A=this._nodeDataDependencies?.seriesRectWidth??0,k=this._nodeDataDependencies?.seriesRectHeight??0,I=p*(i.input.count-1);let N;if(y){const B=T+f.spacing;N=new Cc(0,f.placement==="before"?B:0,A,k-B)}else{const B=R+f.spacing;N=new Cc(f.placement==="after"?0:B,0,A-B,k)}if(d!=null&&d!==0){const B=l==="horizontal"?1/d:d,_=Math.min(N.width,N.height*B),F=_/B;N=new Cc(N.x+(N.width-_)/2,N.y+(N.height-F)/2,_,F)}let L,M;y?M=f.placement==="before"?N.y-f.spacing:N.y+N.height+f.spacing:L=f.placement==="after"?N.x+N.width+f.spacing:N.x-f.spacing;const E=N.width-(y?I:0),C=N.height-(y?0:I);if(E<0||C<0)return;const w=[],G=[];let P=0;return x.forEach((B,_)=>{const F=g[_],V=m[_],W=s&&a.getItemEnabled({seriesId:e,itemId:_}),K=P+V,$=(P+K)/(2*O),U=(K-P)/O,Z=y?E*$+p*_:E*.5,Q=y?C*.5:C*$+p*_,ee=N.x+Z,J=N.y+Q;if(v!=null){const pe=v[_];pe.x=L??ee,pe.y=M??J}let j,re,ce,X;if(y){const pe=E*U;j=pe,ce=pe;const Oe=(Z+pe/2)*(C/N.width),le=(Z-pe/2)*(C/N.width);re=c?N.height-Oe:Oe,X=c?N.height-le:le}else{const pe=C*U;re=pe,X=pe;const Oe=(Q-pe/2)*(E/N.height),le=(Q+pe/2)*(E/N.height);j=c?N.width-Oe:Oe,ce=c?N.width-le:le}const Ge=this.getLabelText(u,{datum:B,value:V,stageKey:n,valueKey:r}),Fe={x:ee,y:J,text:Ge,textAlign:"center",textBaseline:"middle",visible:W};G.push(Fe),w.push({series:this,itemId:r,datum:B,datumIndex:_,index:_,xValue:F,yValue:V,x:ee,y:J,top:j,right:re,bottom:ce,left:X,label:Fe,enabled:W,midPoint:{x:ee,y:J}}),P=K}),{itemId:e,nodeData:w,labelData:G,stageLabelData:v,bounds:N}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update({seriesRect:e}){this.checkResize(e);const{datumSelection:t,labelSelection:i,stageLabelSelection:o,highlightDatumSelection:s}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=this.ctx.highlightManager?.getActiveHighlight();a!=null&&(a.series!==this||a.datum==null)&&(a=void 0);const n=this.contextNodeData?.nodeData??[],r=this.contextNodeData?.labelData??[],l=this.contextNodeData?.stageLabelData??[];this.datumSelection=this.updateDatumSelection({nodeData:n,datumSelection:t}),this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:r,labelSelection:i}),this.updateLabelNodes({labelSelection:i,labelProperties:this.properties.label}),this.stageLabelSelection=this.updateStageLabelSelection({stageLabelData:l,stageLabelSelection:o}),this.updateLabelNodes({labelSelection:o,labelProperties:this.properties.stageLabel}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:a!=null?[a]:[],datumSelection:s}),this.updateDatumNodes({datumSelection:s,isHighlight:!0}),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData)}getItemBaseStyle(e){const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return Ec({fill:i?.fill,fillOpacity:i?.fillOpacity??t.fillOpacity,stroke:i?.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:i?.strokeOpacity??t.strokeOpacity,lineDash:i?.lineDash??t.lineDash,lineDashOffset:i?.lineDashOffset??t.lineDashOffset},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}getItemStyleOverrides(e,t,i,o,s){const{id:a,properties:n}=this,{fills:r,strokes:l,stageKey:c,valueKey:p,itemStyler:d}=n,u=o.fill??r[i%r.length],f=o.stroke??l[i%l.length],y={};if(s||(y.fill=u,y.stroke=f),d!=null){const g=this.cachedDatumCallback(jC(e,s?"highlight":"node"),()=>this.callWithContext(d,{seriesId:a,datum:t,stageKey:c,valueKey:p,highlighted:s,fill:u,stroke:f,...o}));Object.assign(y,g)}return Ec(y,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}updateDatumNodes(e){const{datumSelection:t,isHighlight:i}=e,{properties:o}=this,{shadow:s}=o,a=this.getItemBaseStyle(i),n=this.contextNodeData?.bounds,r=n?{series:n,axis:n}:void 0;t.each((l,c)=>{const{datumIndex:p,datum:d}=c,u=this.getItemStyleOverrides(String(p),d,p,a,i);JC(l,a,u,r),vy(l,c),l.fillShadow=s})}updateLabelSelection(e){return e.labelSelection.update(this.properties.label.enabled?e.labelData:[])}updateStageLabelSelection(e){return e.stageLabelSelection.update(e.stageLabelData)}updateLabelNodes(e){const{labelSelection:t,labelProperties:i}=e,{color:o,fontSize:s,fontStyle:a,fontWeight:n,fontFamily:r}=i;t.each((l,{visible:c,x:p,y:d,text:u,textAlign:f,textBaseline:y})=>{l.visible=c,l.x=p,l.y=d,l.text=u,l.fill=o,l.fontStyle=a,l.fontWeight=n,l.fontSize=s,l.fontFamily=r,l.textAlign=f,l.textBaseline=y})}computeFocusBounds(e){const t=this.getNodeData()?.[e.datumIndex];if(t!==void 0){for(const i of this.datumSelection)if(i.datum===t)return i.node}}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,properties:s}=this,{stageKey:a,valueKey:n,tooltip:r}=s;if(!i||!o)return;const l=o.dataSources.get(this.id)?.[e],c=i.resolveColumnById(this,"xValue",o)[e],p=i.resolveColumnById(this,"yValue",o)[e];if(c==null)return;const d=this.getLabelText(this.properties.stageLabel,{datum:o.dataSources.get(this.id)?.[e],value:p,stageKey:a,valueKey:n}),u=this.getItemBaseStyle(!1);return Object.assign(u,this.getItemStyleOverrides(String(e),e,e,u,!1)),r.formatTooltip(this.properties,{symbol:this.legendItemSymbol(e),data:[{label:String(c),value:d}]},{seriesId:t,datum:l,title:void 0,stageKey:a,valueKey:n,...u})}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(e,t){return[NaN,NaN]}pickNodeClosestDatum({x:e,y:t}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(e,t);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}legendItemSymbol(e){const{fills:t,strokes:i,strokeWidth:o,fillOpacity:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this.properties,l=t[e%t.length]??"black",c=i[e%i.length]??"black";return{marker:Ec({fill:l,fillOpacity:s,stroke:c,strokeWidth:o,strokeOpacity:a,lineDash:n,lineDashOffset:r},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}}getLegendData(e){const{processedData:t,dataModel:i,id:o,ctx:{legendManager:s},visible:a}=this;if(!i||!t||e!=="category"||!this.properties.isValid())return[];const{showInLegend:n}=this.properties,r=[],l=i.resolveColumnById(this,"xValue",t);return(t.dataSources.get(this.id)??[]).forEach((p,d)=>{const u=l[d];r.push({legendType:"category",id:o,itemId:d,seriesId:o,enabled:a&&s.getItemEnabled({seriesId:o,itemId:d}),label:{text:u},symbol:this.legendItemSymbol(d),hideInLegend:!n})}),r}animateReset(){this.ctx.animationManager.skipCurrentBatch(),this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(){const{datumSelection:e,labelSelection:t,properties:i}=this,o=YC(i.direction);ZC(this.id,"nodes",this.ctx.animationManager,[e],o),QC(this,"labels",this.ctx.animationManager,t)}};wc.className="PyramidSeries",wc.type="pyramid";import{_ModuleSupport as eP}from"ag-charts-community";import{arrayOf as Ay,boolean as tP,callback as iP,color as oP,colorUnion as sP,constant as aP,fillOptionsDef as nP,lineDashOptionsDef as rP,positiveNumber as _c,required as Bc,string as Ty,strokeOptionsDef as lP,union as Iy}from"ag-charts-core";var{commonSeriesOptionsDefs:cP,seriesLabelOptionsDefs:My,shadowOptionsDefs:pP,tooltipOptionsDefs:hP,without:Ly}=eP,dP={type:Bc(aP("pyramid")),stageKey:Bc(Ty),valueKey:Bc(Ty),direction:Iy("horizontal","vertical"),aspectRatio:_c,spacing:_c,reverse:tP,itemStyler:iP,fills:Ay(sP),strokes:Ay(oP),label:My,stageLabel:{spacing:_c,placement:Iy("before","after"),...My},tooltip:hP,shadow:pP,...cP,...Ly(nP,["fill"]),...Ly(lP,["stroke"]),...rP};import{_ModuleSupport as Cy}from"ag-charts-community";var{ThemeSymbols:{DEFAULT_SHADOW_COLOUR:uP}}=Cy,HV={series:{direction:"vertical",strokeWidth:0,spacing:2,fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:Cy.FILL_PATTERN_DEFAULTS,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}},stageLabel:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:12},shadow:{enabled:!1,color:uP,xOffset:3,yOffset:3,blur:5}}},Py={type:"series",name:"pyramid",chartType:"standalone",enterprise:!0,options:dP,create:e=>new wc(e)};import{_ModuleSupport as fP}from"ag-charts-community";import{_ModuleSupport as uo}from"ag-charts-community";var{ThemeConstants:{POLAR_AXIS_TYPE:gP}}=uo,Ey={series:{stroke:{$palette:"stroke"},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},marker:{enabled:!0,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:uo.FILL_PATTERN_DEFAULTS,fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:0}},axes:{[gP.ANGLE_CATEGORY]:{label:{spacing:10}}}},yP=uo.mergeDefaults({series:{stroke:uo.SAFE_STROKE_FILL_OPERATION,strokeWidth:2}},Ey),mP=uo.mergeDefaults({series:{fill:{$palette:"fill"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:uo.FILL_PATTERN_DEFAULTS,fillOpacity:.8,strokeWidth:2,marker:{enabled:!1,fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:uo.FILL_PATTERN_DEFAULTS}}},Ey);import{_ModuleSupport as wy}from"ag-charts-community";import{_ModuleSupport as Gc}from"ag-charts-community";import{isFiniteNumber as _y,isNumberEqual as By}from"ag-charts-core";import{_ModuleSupport as SP}from"ag-charts-community";var{Label:bP,SeriesMarker:DP,SeriesProperties:xP,SeriesTooltip:vP,TempValidate:pt,BOOLEAN:OP,COLOR_STRING:kP,NUMBER:RP,LINE_DASH:NP,OBJECT:Fc,POSITIVE_NUMBER:Gy,RATIO:AP,STRING:Tn}=SP,Qe=class extends xP{constructor(){super(...arguments),this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new DP,this.label=new bP,this.tooltip=new vP,this.connectMissingData=!1}};h([pt(Tn)],Qe.prototype,"angleKey",2),h([pt(Tn)],Qe.prototype,"radiusKey",2),h([pt(Tn,{optional:!0})],Qe.prototype,"angleName",2),h([pt(Tn,{optional:!0})],Qe.prototype,"radiusName",2),h([pt(kP)],Qe.prototype,"stroke",2),h([pt(Gy)],Qe.prototype,"strokeWidth",2),h([pt(AP)],Qe.prototype,"strokeOpacity",2),h([pt(NP)],Qe.prototype,"lineDash",2),h([pt(Gy)],Qe.prototype,"lineDashOffset",2),h([pt(RP)],Qe.prototype,"rotation",2),h([pt(Fc)],Qe.prototype,"marker",2),h([pt(Fc)],Qe.prototype,"label",2),h([pt(Fc)],Qe.prototype,"tooltip",2),h([pt(OP)],Qe.prototype,"connectMissingData",2);var{ChartAxisDirection:jt,PolarAxis:TP,SeriesNodePickMode:Fy,valueProperty:Vy,fixNumericExtent:IP,seriesLabelFadeInAnimation:MP,markerFadeInAnimation:LP,resetMarkerFn:CP,animationValidation:PP,computeMarkerFocusBounds:EP,extent:wP,BBox:_P,Group:BP,Path:GP,PointerEvents:FP,Selection:Wy,Text:VP,Marker:WP,mergeDefaults:KP,getShapeStyle:zP}=Gc,$P=class extends Gc.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Vc=class extends Gc.PolarSeries{constructor(e){super({moduleCtx:e,categoryKey:"angleValue",useLabelLayer:!0,pickModes:[Fy.NEAREST_NODE,Fy.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:CP},clipFocusBox:!1}),this.properties=new Qe,this.NodeEvent=$P,this.lineGroup=this.contentGroup.appendChild(new BP({name:"radar-line"})),this.lineSelection=Wy.select(this.lineGroup,GP),this.resetInvalidToZero=!1,this.circleCache={r:0,cx:0,cy:0},this.lineGroup.zIndex=0,this.itemGroup.zIndex=1}nodeFactory(){return new WP}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return[];if(e===jt.X)return t.getDomain(this,"angleValue","value",i);{const o=t.getDomain(this,"radiusValue","value",i),s=wP(o.length===0?o:[0].concat(o));return IP(s)}}async processData(e){if(!this.properties.isValid())return;const{angleKey:t,radiusKey:i}=this.properties,o=[];this.ctx.animationManager.isSkipped()||o.push(PP());const s=this.axes[jt.Y]?.scale.type,a=this.axes[jt.X]?.scale.type;await this.requestDataModel(e,this.data,{props:[Vy(t,a,{id:"angleValue"}),Vy(i,s,{id:"radiusValue",invalidValue:void 0}),...o]}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,o=this.circleCache;return e===o.r&&t===o.cx&&i===o.cy?!1:(this.circleCache={r:e,cx:t,cy:i},!0)}getAxisInnerRadius(){const e=this.axes[jt.Y];return e instanceof TP?this.radius*e.innerRadiusRatio:0}maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:t=[]}=this.createNodeData()??{};this.nodeData=t,this.nodeDataRefresh=!1}createNodeData(){const{processedData:e,dataModel:t}=this;if(!e||!t||!this.properties.isValid())return;const{angleKey:i,radiusKey:o,angleName:s,radiusName:a,marker:n,label:r}=this.properties,l=this.axes[jt.X]?.scale,c=this.axes[jt.Y]?.scale;if(!l||!c)return;const p=t.resolveColumnById(this,"angleValue",e),d=t.resolveColumnById(this,"radiusValue",e),u=this.getAxisInnerRadius(),y=(e.dataSources.get(this.id)??[]).map((g,m)=>{const S=p[m],D=d[m],b=l.convert(S),v=this.radius+u-c.convert(D),R=Math.cos(b),T=Math.sin(b),O=R*v,x=T*v;let A;if(r.enabled){const k=this.getLabelText(r,{value:D,datum:g,angleKey:i,radiusKey:o,angleName:s,radiusName:a});if(k){let I="right";By(R,0)?I="center":R>0&&(I="left");let N="bottom";By(T,0)?N="middle":T>0&&(N="top"),A={x:O+R*n.size,y:x+T*n.size,text:k,textAlign:I,textBaseline:N}}}return{series:this,datum:g,datumIndex:m,index:m,point:{x:O,y:x,size:n.size},midPoint:{x:O,y:x},label:A,angleValue:S,radiusValue:D,missing:!_y(b)||!_y(v)}});return{itemId:o,nodeData:y,labelData:y}}update({seriesRect:e}){const t=this.checkResize(e),i=!this.ctx.animationManager.isSkipped(),{series:o}=this.ctx.highlightManager?.getActiveHighlight()??{};this.highlightGroup.visible=(i||this.visible)&&o===this,this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updatePathSelections(),this.updateMarkerSelection(),this.updateMarkers(this.itemSelection,!1),this.updateMarkers(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePathSelections(){const e=this.visible?[!0]:[];this.lineSelection.update(e)}updateMarkerSelection(){this.properties.marker.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=Wy.select(this.itemGroup,()=>this.nodeFactory(),!1)),this.itemSelection.update(this.properties.marker.enabled?this.nodeData:[])}getMarkerFill(e){return e?.fill??this.properties.marker.fill}getDatumStylerProperties(e){const{id:t,properties:i}=this,{angleKey:o,radiusKey:s}=i;return{seriesId:t,datum:e,angleKey:o,radiusKey:s}}updateMarkers(e,t){const{visible:i}=this,{marker:o,stroke:s,strokeWidth:a,strokeOpacity:n,highlightStyle:r}=this.properties;let l=[];if(i&&o.shape&&o.enabled)if(t){const d=this.ctx.highlightManager?.getActiveHighlight();d?.datum&&(l=[d])}else l=this.nodeData;const c=KP(t&&r.item,o.getStyle(),{stroke:s,strokeWidth:a,strokeOpacity:n}),p=this.getShapeFillBBox();e.update(l).each((d,u)=>{this.updateMarkerStyle(o,d,u.datum,u.point,this.getDatumStylerProperties(u),t,c,p)})}updateLabels(){const{label:e}=this.properties;this.labelSelection.update(this.nodeData).each((t,i)=>{e.enabled&&i.label?(t.x=i.label.x,t.y=i.label.y,t.fill=e.color,t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=i.label.text,t.textAlign=i.label.textAlign,t.textBaseline=i.label.textBaseline,t.visible=!0):t.visible=!1})}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,tooltip:p,marker:d}=a,u=s[jt.X],f=s[jt.Y];if(!i||!o||!u||!f)return;const y=o.dataSources.get(this.id)?.[e],g=i.resolveColumnById(this,"angleValue",o)[e],m=i.resolveColumnById(this,"radiusValue",o)[e];if(g==null)return;const S=this.getMarkerStyle(d,y,this.getDatumStylerProperties(y),!1);return p.formatTooltip(this.properties,{heading:u.formatDatum(g),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:f.formatDatum(m)}]},{seriesId:t,datum:y,title:r,angleKey:n,radiusKey:l,angleName:r,radiusName:c,...S})}legendItemSymbol(){const{stroke:e,strokeWidth:t,strokeOpacity:i,lineDash:o,marker:s}=this.properties;return{marker:zP({shape:s.shape,enabled:s.enabled||t<=0,fill:this.getMarkerFill()??s.stroke??e??"rgba(0, 0, 0, 0)",stroke:s.stroke??e??"rgba(0, 0, 0, 0)",fillOpacity:s.fillOpacity,strokeOpacity:s.strokeOpacity,strokeWidth:s.strokeWidth,lineDash:s.lineDash,lineDashOffset:s.lineDashOffset},s.fillGradientDefaults,s.fillPatternDefaults),line:{stroke:e,strokeOpacity:i,strokeWidth:t,lineDash:o}}}getLegendData(e){if(!this.properties.isValid()||e!=="category")return[];const{id:t,ctx:{legendManager:i},visible:o}=this,{radiusKey:s,radiusName:a,showInLegend:n}=this.properties;return[{legendType:"category",id:t,itemId:s,seriesId:t,enabled:o&&i.getItemEnabled({seriesId:t,itemId:s}),label:{text:a??s},symbol:this.legendItemSymbol(),hideInLegend:!n}]}pickNodeClosestDatum(e){const{nodeData:t,centerX:i,centerY:o}=this,{x:s,y:a}=e,n=this.radius;if(Math.sqrt((s-i)**2+(a-o)**2)>n+this.properties.marker.size)return;let l=1/0,c;for(const p of t){const{point:{x:d=NaN,y:u=NaN}={}}=p;if(isNaN(d)||isNaN(u))continue;const f=Math.sqrt((e.x-d-i)**2+(e.y-u-o)**2);f<l&&(l=f,c=p)}if(c){const p=Math.max(l-(c.point?.size??0),0);return{datum:c,distance:p}}}computeLabelsBBox(){const{label:e}=this.properties;this.maybeRefreshNodeData();const t=[],i=new VP;return this.nodeData.forEach(o=>{if(!e.enabled||!o.label)return;i.text=o.label.text,i.x=o.label.x,i.y=o.label.y,i.setFont(e),i.setAlign(o.label);const s=i.getBBox();t.push(s)}),t.length===0?null:_P.merge(t)}getLineNode(){return this.lineSelection?.at(0)}beforePathAnimation(){const e=this.getLineNode();e&&(e.fill=void 0,e.lineJoin="round",e.lineCap="round",e.pointerEvents=FP.None,e.stroke=this.properties.stroke,e.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),e.strokeOpacity=this.properties.strokeOpacity,e.lineDash=this.properties.lineDash,e.lineDashOffset=this.properties.lineDashOffset)}getLinePoints(){const{nodeData:e,resetInvalidToZero:t}=this,{connectMissingData:i}=this.properties;if(e.length===0)return[];const o=this.axes[jt.Y],a=this.axes[jt.X]?.isReversed(),r=o?.isReversed()&&!a?[...e].reverse():e,l=[];let c=!1,p;return r.forEach((d,u)=>{let{x:f,y}=d.point;const g=isNaN(f)||isNaN(y);g||(p??(p=d)),g&&!i&&(f=0,y=0);const m=u===0||!t&&!i&&(g||c);l.push({x:f,y,moveTo:m}),c=g}),p!==void 0&&l.push({x:p.point.x,y:p.point.y,moveTo:!1}),l}animateSinglePath(e,t,i){const{path:o}=e;o.clear(!0);const s=this.getAxisInnerRadius(),a=this.axes[jt.Y],r=a?.isReversed()?this.radius+s-a?.scale.convert(0):s;t.forEach(l=>{const{x:c,y:p,arc:d,radius:u=0,startAngle:f=0,endAngle:y=0,moveTo:g}=l,m=Math.atan2(p,c),S=r*Math.cos(m),D=r*Math.sin(m),b=i,v=S*(1-b)+c*b,R=D*(1-b)+p*b;d?o.arc(c,p,u,f,y):g?o.moveTo(v,R):o.lineTo(v,R)}),e.checkPathDirty()}animatePaths(e){const t=this.getLinePoints(),i=this.getLineNode();i&&this.animateSinglePath(i,t,e)}animateEmptyUpdateReady(){const{itemSelection:e,labelSelection:t}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:o=>this.animatePaths(o),onStop:()=>this.animatePaths(1)}),LP(this,i,"added",e),MP(this,"labels",i,t)}animateWaitingUpdateReady(e){super.animateWaitingUpdateReady(e),this.resetPaths()}animateReadyResize(e){super.animateReadyResize(e),this.resetPaths()}resetPaths(){const e=this.getLineNode();if(e){const{path:t}=e,i=this.getLinePoints();e.fill=void 0,e.stroke=this.properties.stroke,e.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),e.strokeOpacity=this.properties.strokeOpacity,e.lineDash=this.properties.lineDash,e.lineDashOffset=this.properties.lineDashOffset,t.clear(!0);for(const{x:o,y:s,moveTo:a}of i)a?t.moveTo(o,s):t.lineTo(o,s);e.checkPathDirty()}}getFormattedMarkerStyle(e){const{angleKey:t,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,e.datum,{angleKey:t,radiusKey:i},!0)}computeFocusBounds(e){return EP(this,e)}};Vc.className="RadarSeries";import{_ModuleSupport as HP}from"ag-charts-community";var{FillGradientDefaults:YP,FillPatternDefaults:XP,RATIO:UP,COLOR_STRING:qP,TempValidate:In,OR:jP,COLOR_GRADIENT:JP,COLOR_PATTERN:ZP,OBJECT:Ky}=HP,_s=class extends Qe{constructor(){super(...arguments),this.fill="black",this.fillGradientDefaults=new YP,this.fillPatternDefaults=new XP,this.fillOpacity=1}};h([In(jP(JP,ZP,qP))],_s.prototype,"fill",2),h([In(Ky)],_s.prototype,"fillGradientDefaults",2),h([In(Ky)],_s.prototype,"fillPatternDefaults",2),h([In(UP)],_s.prototype,"fillOpacity",2);var{Group:QP,Path:e1,PointerEvents:t1,Selection:i1,ChartAxisDirection:zy,applyShapeStyle:o1,getShapeFill:s1,getShapeStyle:a1}=wy,Mn=class extends Vc{constructor(e){super(e),this.properties=new _s,this.areaGroup=this.contentGroup.appendChild(new QP({name:"radar-area"})),this.areaSelection=i1.select(this.areaGroup,e1),this.resetInvalidToZero=!0,this.areaGroup.zIndex=-1}updatePathSelections(){const e=this.visible?[!0]:[];this.areaSelection.update(e),super.updatePathSelections()}getAreaNode(){return this.areaSelection.at(0)}getMarkerFill(e){return e?.fill??this.properties.marker.fill??this.properties.fill}beforePathAnimation(){super.beforePathAnimation();const e=this.getAreaNode(),{fillOpacity:t,fill:i}=this.properties,o=a1({fill:i,fillOpacity:t},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults);o1(e,o,void 0,this.getShapeFillBBox()),e.pointerEvents=t1.None,e.stroke=void 0}animatePaths(e){super.animatePaths(e),this.animateSinglePath(this.getAreaNode(),this.getAreaPoints(),e)}getAreaPoints(){const e=this.getLinePoints(),t=n=>{const r=this.axes[n];return r instanceof wy.PolarAxis?r:void 0},i=t(zy.Y),o=t(zy.X);if(!i?.isReversed())return e;const a=o?.getAxisLinePoints()?.points??[];return e.concat(...a)}resetPaths(){super.resetPaths();const e=this.getAreaNode();if(e){const{path:t}=e,i=this.getAreaPoints();e.fill=s1(this.properties.fill,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults),e.fillOpacity=this.properties.fillOpacity,e.stroke=void 0,e.lineDash=this.properties.lineDash,e.lineDashOffset=this.properties.lineDashOffset,e.lineJoin=e.lineCap="round",t.clear(!0),i.forEach(({x:o,y:s,moveTo:a,arc:n,radius:r=0,startAngle:l=0,endAngle:c=0})=>{n?t.arc(o,s,r,l,c):a?t.moveTo(o,s):t.lineTo(o,s)}),t.closePath(),e.checkPathDirty()}}};Mn.className="RadarAreaSeries",Mn.type="radar-area";import{_ModuleSupport as n1}from"ag-charts-community";import{boolean as r1,constant as l1,fillOptionsDef as c1,lineDashOptionsDef as p1,required as Wc,string as Ln,strokeOptionsDef as h1}from"ag-charts-core";var{commonSeriesOptionsDefs:d1,seriesLabelOptionsDefs:u1,markerOptionsDefs:f1,tooltipOptionsDefs:g1}=n1,y1={type:Wc(l1("radar-area")),angleKey:Wc(Ln),radiusKey:Wc(Ln),angleName:Ln,radiusName:Ln,connectMissingData:r1,marker:f1,label:u1,tooltip:g1,...d1,...c1,...h1,...p1},{ThemeConstants:{POLAR_AXIS_TYPE:$y}}=fP,tW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-area",moduleFactory:e=>new Mn(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:$y.ANGLE_CATEGORY},{type:$y.RADIUS_NUMBER}],themeTemplate:mP},Hy={type:"series",name:"radar-area",chartType:"polar",enterprise:!0,options:y1,create:e=>new Mn(e)};import{_ModuleSupport as m1}from"ag-charts-community";var Cn=class extends Vc{updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}};Cn.className="RadarLineSeries",Cn.type="radar-line";import{_ModuleSupport as S1}from"ag-charts-community";import{boolean as b1,constant as D1,lineDashOptionsDef as x1,required as Kc,string as Pn,strokeOptionsDef as v1}from"ag-charts-core";var{commonSeriesOptionsDefs:O1,seriesLabelOptionsDefs:k1,markerOptionsDefs:R1,tooltipOptionsDefs:N1}=S1,A1={type:Kc(D1("radar-line")),angleKey:Kc(Pn),radiusKey:Kc(Pn),angleName:Pn,radiusName:Pn,connectMissingData:b1,marker:R1,label:k1,tooltip:N1,...O1,...v1,...x1},{POLAR_AXIS_TYPE:Yy}=m1.ThemeConstants,aW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-line",moduleFactory:e=>new Cn(e),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Yy.ANGLE_CATEGORY},{type:Yy.RADIUS_NUMBER}],themeTemplate:yP},Xy={type:"series",name:"radar-line",chartType:"polar",enterprise:!0,options:A1,create:e=>new Cn(e)};import{_ModuleSupport as T1}from"ag-charts-community";import{_ModuleSupport as Bs}from"ag-charts-community";import{isDefined as I1}from"ag-charts-core";import{_ModuleSupport as M1}from"ag-charts-community";var{SeriesProperties:L1,FillGradientDefaults:C1,FillPatternDefaults:P1,SeriesTooltip:E1,TempValidate:_e,COLOR_STRING:Uy,NUMBER:qy,FUNCTION:w1,LINE_DASH:_1,OBJECT:En,POSITIVE_NUMBER:zc,RATIO:jy,STRING:Gs,Label:B1,COLOR_GRADIENT:G1,COLOR_PATTERN:F1,OR:V1}=M1,Pe=class extends L1{constructor(){super(...arguments),this.fill="black",this.fillGradientDefaults=new C1,this.fillPatternDefaults=new P1,this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new B1,this.tooltip=new E1}};h([_e(Gs)],Pe.prototype,"angleKey",2),h([_e(Gs)],Pe.prototype,"radiusKey",2),h([_e(Gs,{optional:!0})],Pe.prototype,"angleName",2),h([_e(Gs,{optional:!0})],Pe.prototype,"radiusName",2),h([_e(V1(G1,F1,Uy))],Pe.prototype,"fill",2),h([_e(En)],Pe.prototype,"fillGradientDefaults",2),h([_e(En)],Pe.prototype,"fillPatternDefaults",2),h([_e(jy)],Pe.prototype,"fillOpacity",2),h([_e(Uy)],Pe.prototype,"stroke",2),h([_e(zc)],Pe.prototype,"strokeWidth",2),h([_e(jy)],Pe.prototype,"strokeOpacity",2),h([_e(_1)],Pe.prototype,"lineDash",2),h([_e(zc)],Pe.prototype,"lineDashOffset",2),h([_e(zc)],Pe.prototype,"cornerRadius",2),h([_e(w1,{optional:!0})],Pe.prototype,"itemStyler",2),h([_e(qy)],Pe.prototype,"rotation",2),h([_e(Gs,{optional:!0})],Pe.prototype,"stackGroup",2),h([_e(qy,{optional:!0})],Pe.prototype,"normalizedTo",2),h([_e(En)],Pe.prototype,"label",2),h([_e(En)],Pe.prototype,"tooltip",2);import{_ModuleSupport as W1}from"ag-charts-community";var{SectorBox:Jy,motion:K1}=W1;function z1(e,t,i){if(i==="updated"){if(e.previousDatum==null||isNaN(e.previousDatum.innerRadius)||isNaN(e.previousDatum.outerRadius))return"added";if(isNaN(t.innerRadius)||isNaN(t.outerRadius))return"removed"}return i==="added"&&e.previousDatum!=null?"updated":i}function Zy(e){return{toFn:(o,s,a)=>{let n,r,l,c,p;return a==="removed"?(n=e,r=e,l=s.innerRadius,c=s.outerRadius,p=new Jy(n,r,l,c)):(n=s.startAngle,r=s.endAngle,l=isNaN(s.innerRadius)?o.innerRadius:s.innerRadius,c=isNaN(s.outerRadius)?o.outerRadius:s.outerRadius,p=s.clipSector),{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:p}},fromFn:(o,s,a)=>{a=z1(o,s,a);let n,r,l,c,p;a==="removed"||a==="updated"?(n=o.startAngle,r=o.endAngle,l=o.innerRadius,c=o.outerRadius,p=o.clipSector):(n=e,r=e,l=s.innerRadius,c=s.outerRadius),p??(p=new Jy(n,r,l,c));const d=K1.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a];return{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:p,phase:d}}}}function $1(e,t){return{centerX:0,centerY:0,innerRadius:t.innerRadius,outerRadius:t.outerRadius,startAngle:t.startAngle,endAngle:t.endAngle,clipSector:t.clipSector}}var{ChartAxisDirection:li,PolarAxis:H1,diff:Y1,groupAccumulativeValueProperty:Qy,keyProperty:X1,normaliseGroupTo:U1,valueProperty:q1,fixNumericExtent:j1,resetLabelFn:J1,seriesLabelFadeInAnimation:Z1,seriesLabelFadeOutAnimation:Q1,animationValidation:eE,angleBetween:tE,createDatumId:em,CategoryScale:iE,Sector:oE,SectorBox:sE,motion:tm,isGradientFill:aE,applyShapeStyle:nE,getShapeStyle:$c}=Bs,rE=class extends Bs.SeriesNodeEvent{constructor(e,t,i,o){super(e,t,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},wn=class extends Bs.PolarSeries{constructor(e){super({moduleCtx:e,categoryKey:"radiusValue",useLabelLayer:!0,canHaveAxes:!0,animationResetFns:{item:$1,label:J1}}),this.properties=new Pe,this.NodeEvent=rE,this.groupScale=new iE,this.circleCache={r:0,cx:0,cy:0}}get defaultShapeStyle(){const e=this.axes[li.X]?.scale;return{...this.properties.fillGradientDefaults.toJson(),rotation:Bs.toDegrees(e.range[0])+90}}nodeFactory(){return new oE}getSeriesDomain(e){const{dataModel:t,processedData:i}=this;if(!i||!t)return[];if(e===li.X){const o=t.getDomain(this,"angleValue-end","value",i),s=[o[0]>0?0:o[0],o[1]<0?0:o[1]];return j1(s)}else return t.getDomain(this,"radiusValue","key",i)}async processData(e){const{angleKey:t,radiusKey:i,normalizedTo:o}=this.properties,s=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid())return;const a=this.getStackId(),n=`${a}-trailing`,r=[];I1(o)&&r.push(U1([a,n],Math.abs(o))),s&&(this.processedData&&r.push(Y1(this.id,this.processedData)),r.push(eE()));const l=this.visible?{}:{forceValue:0},c=this.axes[li.Y]?.scale.type,p=this.axes[li.X]?.scale.type;await this.requestDataModel(e,this.data,{props:[X1(i,c,{id:"radiusValue"}),q1(t,p,{id:"angleValue-raw",invalidValue:null,...l}),...Qy(t,"normal","current",{id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:a,separateNegative:!0,...l},p),...Qy(t,"trailing","current",{id:"angleValue-start",invalidValue:null,groupId:n,separateNegative:!0,...l},p),...r],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const e=this.radius,t=this.centerX,i=this.centerY,o=this.circleCache;return e===o.r&&t===o.cx&&i===o.cy?!1:(this.circleCache={r:e,cx:t,cy:i},!0)}maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:t=[]}=this.createNodeData()??{};this.nodeData=t,this.nodeDataRefresh=!1}getAxisInnerRadius(){const e=this.axes[li.Y];return e instanceof H1?this.radius*e.innerRadiusRatio:0}createNodeData(){const{processedData:e,dataModel:t}=this;if(!t||!e||e.type!=="grouped"||!this.properties.isValid())return;const i=this.axes[li.X],o=this.axes[li.Y],s=i?.scale,a=o?.scale;if(!s||!a)return;const n=t.resolveKeysById(this,"radiusValue",e),r=t.resolveColumnById(this,"angleValue-start",e),l=t.resolveColumnById(this,"angleValue-end",e),c=t.resolveColumnById(this,"angleValue-raw",e),p=t.resolveProcessedDataIndexById(this,"angleValue-range");let d=0;o instanceof Ki&&(d=o.groupPaddingInner);const{groupScale:u}=this,{index:f,visibleGroupCount:y}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);u.domain=Array.from({length:y}).map((E,C)=>String(C)),u.range=[0,Math.abs(a.bandwidth??0)],u.paddingInner=y>1?d:0;const g=u.bandwidth>=1?u.bandwidth:u.rawBandwidth,m=i.isReversed(),S=o.isReversed(),D=S?this.radius:this.getAxisInnerRadius(),v=(S?this.getAxisInnerRadius():this.radius)+D,{angleKey:R,radiusKey:T,angleName:O,radiusName:x,label:A}=this.properties,k=(E,C,w,G)=>{const P=this.getLabelText(A,{value:C,datum:E,angleKey:R,radiusKey:T,angleName:O,radiusName:x});if(P)return{x:w,y:G,text:P,textAlign:"center",textBaseline:"middle"}},I=[],N={itemId:T,nodeData:I,labelData:I};if(!this.visible)return N;const{dataSources:L}=e,M=L.get(this.id)??[];for(const{datumIndex:E,group:C}of t.forEachGroupDatum(this,e)){const w=M[E],G=n[E];if(G==null)return;const P=c[E],B=r[E],_=l[E],F=P>=0&&!Object.is(P,-0),V=C.aggregation[p][F?1:0],W=F===m;let K=s.convert(B,!0),$=s.convert(_,!0),U=s.convert(0,!0),Z=s.convert(V,!0);W&&([U,Z]=[Z,U],[K,$]=[$,K]);const ee=v-a.convert(G)+u.convert(String(f)),J=ee+g,j=(ee+J)/2,re=K+tE(K,$)/2,ce=Math.cos(re)*j,X=Math.sin(re)*j,Ge=this.properties.label.enabled?k(w,P,ce,X):void 0,Fe=new sE(K,$,ee,J);I.push({series:this,datum:w,datumIndex:E,point:{x:ce,y:X,size:0},midPoint:{x:ce,y:X},label:Ge,angleValue:P,radiusValue:G,innerRadius:ee,outerRadius:J,startAngle:U,endAngle:Z,clipSector:Fe,reversed:W,index:E})}return N}update({seriesRect:e}){const t=this.checkResize(e);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),t&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemBaseStyle(e){const{properties:t}=this,i=e?t.highlightStyle.item:void 0;return $c({fill:i?.fill??t.fill,fillOpacity:i?.fillOpacity??t.fillOpacity,stroke:i?.stroke??t.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:i?.strokeOpacity??t.strokeOpacity,lineDash:i?.lineDash??t.lineDash,lineDashOffset:i?.lineDashOffset??t.lineDashOffset,cornerRadius:t.cornerRadius},this.defaultShapeStyle,t.fillPatternDefaults)}getItemStyleOverrides(e,t,i,o){const{id:s,properties:a}=this,{angleKey:n,radiusKey:r,itemStyler:l}=a;let c;return l!=null&&(c=this.cachedDatumCallback(em(e,o?"highlight":"node"),()=>this.callWithContext(l,{seriesId:s,datum:t,highlighted:o,angleKey:n,radiusKey:r,...i}))),$c(c,this.defaultShapeStyle,this.properties.fillPatternDefaults)}updateSectorSelection(e,t){let i=[];if(t){const a=this.ctx.highlightManager?.getActiveHighlight();a?.datum&&a.series===this&&i.push(a)}else i=this.nodeData;const o=this.getItemBaseStyle(t),s=this.getShapeFillBBox();e.update(i,void 0,a=>this.getDatumId(a)).each((a,n)=>{const{datum:r,datumIndex:l}=n,c=this.getItemStyleOverrides(String(l),r,o,t),p=c?.cornerRadius??o.cornerRadius,d=c?.fill??o.fill,u=Bs.isGradientFill(d)&&d.bounds!=="item"?{centerX:0,centerY:0}:void 0;nE(a,o,c,s,u),a.lineJoin="round",a.inset=a.stroke!=null?a.strokeWidth/2:0,a.startInnerCornerRadius=r.reversed?p:0,a.startOuterCornerRadius=r.reversed?p:0,a.endInnerCornerRadius=r.reversed?0:p,a.endOuterCornerRadius=r.reversed?0:p,t&&(a.startAngle=n.startAngle,a.endAngle=n.endAngle,a.clipSector=n.clipSector,a.innerRadius=n.innerRadius,a.outerRadius=n.outerRadius)})}updateLabels(){const{label:e}=this.properties;this.labelSelection.update(this.nodeData).each((t,i)=>{e.enabled&&i.label?(t.x=i.label.x,t.y=i.label.y,t.fill=e.color,t.fontFamily=e.fontFamily,t.fontSize=e.fontSize,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.text=i.label.text,t.textAlign=i.label.textAlign,t.textBaseline=i.label.textBaseline,t.visible=!0):t.visible=!1})}getBarTransitionFunctions(){const e=this.axes[li.X]?.scale;let t=0;if(!e)return Zy(t);const i=Math.min(e.domain[0],e.domain[1]),o=Math.max(e.domain[0],e.domain[1]);return i<=0&&o>=0&&(t=e.convert(0)),Zy(t)}animateEmptyUpdateReady(){const{labelSelection:e}=this,t=this.getBarTransitionFunctions();tm.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],t),Z1(this,"labels",this.ctx.animationManager,e)}animateClearingUpdateEmpty(){const{itemSelection:e}=this,{animationManager:t}=this.ctx,i=this.getBarTransitionFunctions();tm.fromToMotion(this.id,"datums",t,[e],i),Q1(this,"labels",t,this.labelSelection)}getTooltipContent(e){const{id:t,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,tooltip:p}=a,d=s[li.X],u=s[li.Y];if(!i||!o||!d||!u)return;const f=o.dataSources.get(this.id)?.[e],y=i.resolveKeysById(this,"radiusValue",o)[e],g=i.resolveColumnById(this,"angleValue-raw",o)[e];if(y==null)return;const m=this.getItemBaseStyle(!1);return Object.assign(m,this.getItemStyleOverrides(String(e),e,m,!1)),p.formatTooltip(this.properties,{heading:u.formatDatum(y),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:n,value:d.formatDatum(g)}]},{seriesId:t,datum:f,title:r,angleKey:n,angleName:r,radiusKey:l,radiusName:c,...m})}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.itemSelection.nodes())}legendItemSymbol(){const{fill:e,stroke:t,fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n,fillPatternDefaults:r}=this.properties,l=$c({fill:e??"rgba(0, 0, 0, 0)",stroke:t??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n},this.defaultShapeStyle,r);return aE(l.fill)&&(l.fill={...l.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:l}}getLegendData(e){if(!this.properties.isValid()||e!=="category")return[];const{id:t,visible:i}=this,{angleKey:o,angleName:s,showInLegend:a}=this.properties;return[{legendType:"category",id:t,itemId:o,seriesId:t,enabled:i,label:{text:s??o},symbol:this.legendItemSymbol(),hideInLegend:!a}]}getDatumId(e){return em(e.radiusValue)}computeLabelsBBox(){return null}getStackId(){return`radialBar-stack-${this.seriesGrouping?.groupIndex??this.id}-xValues`}};wn.className="RadialBarSeries",wn.type="radial-bar";import{_ModuleSupport as lE}from"ag-charts-community";import{boolean as im,callback as cE,constant as pE,fillOptionsDef as hE,lineDashOptionsDef as dE,number as uE,positiveNumber as fE,required as Hc,string as Fs,strokeOptionsDef as gE}from"ag-charts-core";var{commonSeriesOptionsDefs:yE,seriesLabelOptionsDefs:mE,tooltipOptionsDefs:SE}=lE,bE={type:Hc(pE("radial-bar")),angleKey:Hc(Fs),radiusKey:Hc(Fs),angleName:Fs,radiusName:Fs,grouped:im,stacked:im,stackGroup:Fs,normalizedTo:uE,cornerRadius:fE,itemStyler:cE,label:mE,tooltip:SE,...yE,...hE,...gE,...dE};import{_ModuleSupport as om}from"ag-charts-community";var{ThemeConstants:{POLAR_AXIS_TYPE:DE}}=om,xE={series:{fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"conic",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:om.FILL_PATTERN_DEFAULTS,strokeWidth:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}}},axes:{[DE.RADIUS_CATEGORY]:{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},{POLAR_AXIS_TYPE:sm}=T1.ThemeConstants,fW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-bar",moduleFactory:e=>new wn(e),tooltipDefaults:{range:"exact"},defaultAxes:[{type:sm.ANGLE_NUMBER},{type:sm.RADIUS_CATEGORY}],themeTemplate:xE,stackable:!0,groupable:!0},am={type:"series",name:"radial-bar",chartType:"polar",enterprise:!0,options:bE,create:e=>new wn(e)};import{_ModuleSupport as vE}from"ag-charts-community";import{_ModuleSupport as OE}from"ag-charts-community";import{_ModuleSupport as kE}from"ag-charts-community";var{TempValidate:nm,RATIO:rm}=kE,Yc=class extends Ae{};h([nm(rm,{optional:!0})],Yc.prototype,"columnWidthRatio",2),h([nm(rm,{optional:!0})],Yc.prototype,"maxColumnWidthRatio",2);var{ChartAxisDirection:RE,PolarAxis:NE,RadialColumnShape:AE,getRadialColumnWidth:TE}=OE,_n=class extends ny{constructor(e){super(e,{animationResetFns:{item:rC}}),this.properties=new Yc}getStackId(){return`radarColumn-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new AE}getColumnTransitionFunctions(){const e=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return nC(e)}isRadiusAxisCircle(){const e=this.axes[RE.Y];return e instanceof NE?e.shape==="circle":!1}updateItemPath(e,t,i){e.isBeveled=this.isRadiusAxisCircle(),e.isRadiusAxisReversed=this.isRadiusAxisReversed(),i&&(e.innerRadius=t.innerRadius,e.outerRadius=t.outerRadius,e.startAngle=t.startAngle,e.endAngle=t.endAngle,e.columnWidth=t.columnWidth,e.axisInnerRadius=t.axisInnerRadius,e.axisOuterRadius=t.axisOuterRadius)}getColumnWidth(e,t){const{columnWidthRatio:i=.5,maxColumnWidthRatio:o=.5}=this.properties;return TE(e,t,this.radius,i,o)}};_n.className="RadialColumnSeries",_n.type="radial-column";import{_ModuleSupport as IE}from"ag-charts-community";import{boolean as lm,callback as ME,constant as LE,fillOptionsDef as CE,lineDashOptionsDef as PE,number as EE,positiveNumber as wE,ratio as cm,required as Xc,string as Vs,strokeOptionsDef as _E}from"ag-charts-core";var{commonSeriesOptionsDefs:BE,seriesLabelOptionsDefs:GE,tooltipOptionsDefs:FE}=IE,VE={type:Xc(LE("radial-column")),angleKey:Xc(Vs),radiusKey:Xc(Vs),angleName:Vs,radiusName:Vs,grouped:lm,stacked:lm,stackGroup:Vs,normalizedTo:EE,cornerRadius:wE,columnWidthRatio:cm,maxColumnWidthRatio:cm,itemStyler:ME,label:GE,tooltip:FE,...BE,...CE,..._E,...PE};import{_ModuleSupport as pm}from"ag-charts-community";var{ThemeConstants:{POLAR_AXIS_TYPE:hm,POLAR_AXIS_SHAPE:WE}}=pm,dm={$path:["./shape",WE.CIRCLE,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]},KE={series:{fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:pm.FILL_PATTERN_DEFAULTS,columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},axes:{[hm.ANGLE_CATEGORY]:{shape:dm,groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[hm.RADIUS_NUMBER]:{shape:dm,innerRadiusRatio:.5}}},{POLAR_AXIS_TYPE:um}=vE.ThemeConstants,xW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-column",moduleFactory:e=>new _n(e),tooltipDefaults:{range:"exact"},defaultAxes:[{type:um.ANGLE_CATEGORY},{type:um.RADIUS_NUMBER}],themeTemplate:KE,stackable:!0,groupable:!0},fm={type:"series",name:"radial-column",chartType:"polar",enterprise:!0,options:VE,create:e=>new _n(e)};import{_ModuleSupport as Uc}from"ag-charts-community";import{_ModuleSupport as fo}from"ag-charts-community";import{countFractionDigits as zE}from"ag-charts-core";import{_ModuleSupport as $E}from"ag-charts-community";var{SvgPath:HE,Rotatable:YE,Translatable:XE,Scalable:UE}=$E,qc=class extends YE(UE(XE(HE))){constructor(){super(...arguments),this.scalingCenterX=.5,this.scalingCenterY=.5,this.rotationCenterX=.5,this.rotationCenterY=.5}};qc.defaultPathData="M0.50245 0.53745C0.481767 0.53745 0.465 0.520683 0.465 0.5C0.465 0.479317 0.481767 0.46255 0.50245 0.46255L1 0.500012L0.50245 0.53745Z";import{_ModuleSupport as jc}from"ag-charts-community";import{Logger as qE}from"ag-charts-core";var{BaseProperties:Ws,SeriesTooltip:jE,SeriesProperties:JE,PropertiesArray:Jc,AxisLabel:ZE,TempValidate:z,BOOLEAN:gm,COLOR_STRING:bi,COLOR_STRING_ARRAY:QE,FUNCTION:ew,LINE_DASH:Bn,NUMBER:ht,NUMBER_ARRAY:tw,OBJECT_ARRAY:Zc,OBJECT:Jt,POSITIVE_NUMBER:At,RATIO:Zt,STRING:Qc,UNION:iw,AND:ym,LESS_THAN:ow,GREATER_THAN:sw,Label:aw}=jc,nw=iw(["inside","outside","middle"],"a placement"),mm=class extends aw{};h([z(ht,{optional:!0})],mm.prototype,"spacing",2);var Ue=class extends Ws{constructor(){super(...arguments),this.label=new mm}};h([z(Qc,{optional:!0})],Ue.prototype,"text",2),h([z(ht,{optional:!0})],Ue.prototype,"value",2),h([z(Ef,{optional:!0})],Ue.prototype,"shape",2),h([z(nw,{optional:!0})],Ue.prototype,"placement",2),h([z(ht,{optional:!0})],Ue.prototype,"spacing",2),h([z(At,{optional:!0})],Ue.prototype,"size",2),h([z(ht,{optional:!0})],Ue.prototype,"rotation",2),h([z(bi,{optional:!0})],Ue.prototype,"fill",2),h([z(Zt,{optional:!0})],Ue.prototype,"fillOpacity",2),h([z(bi,{optional:!0})],Ue.prototype,"stroke",2),h([z(At,{optional:!0})],Ue.prototype,"strokeWidth",2),h([z(Zt,{optional:!0})],Ue.prototype,"strokeOpacity",2),h([z(Bn,{optional:!0})],Ue.prototype,"lineDash",2),h([z(At,{optional:!0})],Ue.prototype,"lineDashOffset",2),h([z(Jt)],Ue.prototype,"label",2);var Qt=class extends Ws{constructor(){super(...arguments),this.enabled=!0,this.fills=new Jc(jc.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};h([z(gm)],Qt.prototype,"enabled",2),h([z(Zc)],Qt.prototype,"fills",2),h([z(Qa)],Qt.prototype,"fillMode",2),h([z(bi,{optional:!0})],Qt.prototype,"fill",2),h([z(Zt)],Qt.prototype,"fillOpacity",2),h([z(bi,{optional:!0})],Qt.prototype,"stroke",2),h([z(At,{optional:!0})],Qt.prototype,"strokeWidth",2),h([z(Zt)],Qt.prototype,"strokeOpacity",2),h([z(Bn)],Qt.prototype,"lineDash",2),h([z(At)],Qt.prototype,"lineDashOffset",2);var Ks=class extends Ws{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};h([z(tw,{optional:!0})],Ks.prototype,"values",2),h([z(ht,{optional:!0})],Ks.prototype,"step",2),h([z(ht)],Ks.prototype,"minSpacing",2),h([z(ht)],Ks.prototype,"maxSpacing",2);var rw=class extends ZE{},ot=class extends Ws{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new Jc(jc.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new Ks,this.label=new rw}};h([z(ym(ht,ow("max")))],ot.prototype,"min",2),h([z(ym(ht,sw("min")))],ot.prototype,"max",2),h([z(Zc)],ot.prototype,"fills",2),h([z(Qa)],ot.prototype,"fillMode",2),h([z(bi,{optional:!0})],ot.prototype,"fill",2),h([z(Zt)],ot.prototype,"fillOpacity",2),h([z(bi)],ot.prototype,"stroke",2),h([z(At)],ot.prototype,"strokeWidth",2),h([z(Zt)],ot.prototype,"strokeOpacity",2),h([z(Bn)],ot.prototype,"lineDash",2),h([z(At)],ot.prototype,"lineDashOffset",2),h([z(bi)],ot.prototype,"defaultFill",2),h([z(Jt)],ot.prototype,"interval",2),h([z(Jt)],ot.prototype,"label",2);var ei=class extends Ws{constructor(){super(...arguments),this.enabled=!0,this.spacing=0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};h([z(gm)],ei.prototype,"enabled",2),h([z(Zt,{optional:!0})],ei.prototype,"radiusRatio",2),h([z(ht)],ei.prototype,"spacing",2),h([z(bi)],ei.prototype,"fill",2),h([z(Zt)],ei.prototype,"fillOpacity",2),h([z(bi)],ei.prototype,"stroke",2),h([z(At)],ei.prototype,"strokeWidth",2),h([z(Zt)],ei.prototype,"strokeOpacity",2),h([z(Bn)],ei.prototype,"lineDash",2),h([z(At)],ei.prototype,"lineDashOffset",2);var Sm=class extends oi{};h([z(Qc,{optional:!0})],Sm.prototype,"text",2);var bm=class extends ms{};h([z(Qc,{optional:!0})],bm.prototype,"text",2);var Ie=class extends JE{constructor(){super(...arguments),this.startAngle=0,this.endAngle=0,this.segmentation=new As,this.defaultColorRange=[],this.targets=new Jc(Ue),this.defaultTarget=new Ue,this.outerRadiusRatio=1,this.innerRadiusRatio=1,this.cornerRadius=0,this.cornerMode="container",this.spacing=0,this.scale=new ot,this.bar=new Qt,this.needle=new ei,this.label=new Sm,this.secondaryLabel=new bm,this.tooltip=new jE}isValid(e){if(!super.isValid(e))return!1;const{outerRadius:t,innerRadius:i}=this;return t==null!=(i==null)?(qE.warnOnce("Either [innerRadius] and [outerRadius] must both be set, or neither can be set."),!1):!0}};h([z(ht)],Ie.prototype,"value",2),h([z(ht)],Ie.prototype,"startAngle",2),h([z(ht)],Ie.prototype,"endAngle",2),h([z(Jt)],Ie.prototype,"segmentation",2),h([z(QE)],Ie.prototype,"defaultColorRange",2),h([z(Zc)],Ie.prototype,"targets",2),h([z(Jt)],Ie.prototype,"defaultTarget",2),h([z(Zt)],Ie.prototype,"outerRadiusRatio",2),h([z(Zt)],Ie.prototype,"innerRadiusRatio",2),h([z(At,{optional:!0})],Ie.prototype,"outerRadius",2),h([z(At,{optional:!0})],Ie.prototype,"innerRadius",2),h([z(At)],Ie.prototype,"cornerRadius",2),h([z(wf)],Ie.prototype,"cornerMode",2),h([z(ht)],Ie.prototype,"spacing",2),h([z(Jt)],Ie.prototype,"scale",2),h([z(Jt)],Ie.prototype,"bar",2),h([z(Jt)],Ie.prototype,"needle",2),h([z(ew,{optional:!0})],Ie.prototype,"itemStyler",2),h([z(Jt)],Ie.prototype,"label",2),h([z(Jt)],Ie.prototype,"secondaryLabel",2),h([z(Jt)],Ie.prototype,"tooltip",2);import{_ModuleSupport as lw}from"ag-charts-community";var{SectorBox:ep}=lw;function cw(e){const{startAngle:t,endAngle:i,clipStartAngle:o,clipEndAngle:s,innerRadius:a,outerRadius:n}=e;if(!(o==null||s==null))return new ep(Math.max(o,t),Math.min(s,i),a,n)}function Dm(e,t,i){return Math.max(e,i.startAngle)<=Math.min(t,i.endAngle)}function tp(e){return e.clipStartAngle!=null&&e.clipEndAngle!=null}function ip(e,t){const{clipStartAngle:i,clipEndAngle:o,innerRadius:s,outerRadius:a}=e;return new ep(i,t?i:o,s,a)}function xm(e,t){const i=e?"initial":"update";return{node:{fromFn(a,n){const r=a.previousDatum;let{startAngle:l,endAngle:c}=r??n;const p=r!=null&&tp(r)?ip(r,e):void 0,d=tp(n)?ip(n,e):void 0;let u;return p!=null&&d!=null?u=p:p==null&&d!=null?(u=d,l=n.startAngle,c=n.endAngle):p!=null&&d==null?(u=void 0,l=n.startAngle,c=n.endAngle):e&&(c=l),{startAngle:l,endAngle:c,clipSector:u,phase:i}},toFn(a,n){const{startAngle:r,endAngle:l}=n;let c;return tp(n)&&(c=ip(n,!1)),{startAngle:r,endAngle:l,clipSector:c}},applyFn(a,n){const{startAngle:r,endAngle:l}=n;let{clipSector:c}=n;c!=null&&(c=new ep(Math.max(r,c.startAngle),Math.min(l,c.endAngle),c.innerRadius,c.outerRadius));const p=c==null||Dm(r,l,c);a.startAngle=r,a.endAngle=l,a.clipSector=c,a.visible=p}},needle:{fromFn(a){let{angle:n}=a.previousDatum??a.datum;return e&&(n=t),{rotation:n,phase:i}},toFn(a,n){const{angle:r}=n;return{rotation:r}}}}}function op(e,t){const{startAngle:i,endAngle:o}=t,s=cw(t),a=s==null||Dm(i,o,s);return{startAngle:i,endAngle:o,clipSector:s,visible:a}}function vm(e,t){const{angle:i}=t;return{rotation:i}}var pw={top:0,middle:.5,bottom:1};function hw(e,t,i,o,s){const{padding:a,textAlign:n,verticalAlign:r}=i;let l,c;if(t.each((v,R)=>{R.label==="primary"?l=R:R.label==="secondary"&&(c=R)}),l==null)return;const p=Ns(e,l,s?.label);if(p==null)return;const d=c!=null?Ns(e,c,s?.secondaryLabel):void 0,u={padding:a},f=n==="center"?2:1,y=r==="middle"?2:1,g=v=>({width:Math.sqrt(Math.max(o**2-(v/y)**2,0))*f,height:Math.min(v,y*o),meta:null});let m,S,D;if(c!=null&&d!=null){const v=Sd(p,l,d,c,u,g);m=v?.label,S=v?.secondaryLabel,D=v?.height??0}else{const v=gs(p,l,u,g);m=v?.[0],S=void 0,D=v?.[0].height??0}const b=D*pw[r];t.each((v,R)=>{let T;if(R.label==="primary"?T=m:R.label==="secondary"&&(T=S),T==null){v.visible=!1;return}v.visible=!0,v.text=T.text,v.fontSize=T.fontSize,v.lineHeight=T.lineHeight,v.textAlign=n,v.textBaseline="middle";const O=R.label==="primary"?T.height/2:D-T.height/2;v.y=R.centerY+O-b,v.x=R.centerX})}var{fromToMotion:zs,resetMotion:Om,CachedTextMeasurerPool:dw,SeriesNodePickMode:km,StateMachine:uw,createDatumId:sp,normalizeAngle360:Rm,normalizeAngle360Inclusive:ap,isBetweenAngles:Gn,sectorBox:fw,toDegrees:gw,toRadians:Fn,BBox:yw,Group:Pi,PointerEvents:Vn,Selection:Ei,Sector:mw,SectorBox:Sw,Text:Nm,Marker:bw,getColorStops:Dw}=fo,xw={inside:90,middle:0,outside:-90},vw=[{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"},{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"}],Ow=[{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"},{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"}],Wn=class extends fo.Series{constructor(e){super({moduleCtx:e,useLabelLayer:!0,pickModes:[km.EXACT_SHAPE_MATCH,km.NEAREST_NODE]}),this.centerX=0,this.centerY=0,this.radius=0,this.textAlign="center",this.verticalAlign="middle",this.properties=new Ie,this.scale=new Xp,this.scaleGroup=this.contentGroup.appendChild(new Pi({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new Pi({name:"itemGroup"})),this.itemNeedleGroup=this.contentGroup.appendChild(new Pi({name:"itemNeedleGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new Pi({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new Pi({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Pi({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new Pi({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new Pi({name:"tickGroup"})),this.scaleSelection=Ei.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=Ei.select(this.itemGroup,()=>this.nodeFactory()),this.needleSelection=Ei.select(this.itemNeedleGroup,qc),this.targetSelection=Ei.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=Ei.select(this.itemTargetLabelGroup,Nm),this.labelSelection=Ei.select(this.itemLabelGroup,Nm),this.highlightTargetSelection=Ei.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=Ei.select(this.tickGroup,fo.TransformableText),this.datumUnion=new Af,this.animationState=new uw("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=Vn.None,this.tickGroup.pointerEvents=Vn.None,this.itemNeedleGroup.pointerEvents=Vn.None,this.itemLabelGroup.pointerEvents=Vn.None}get hasData(){return this.properties.value!=null}nodeFactory(){return new mw}markerFactory(){const e=new bw;return e.size=1,e}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(e){const{min:t,max:i}=this.properties.scale;return If(e,{min:t,max:i})}layoutScale(){const{scale:e,properties:t}=this,{seriesRectWidth:i,seriesRectHeight:o}=this.nodeDataDependencies,{scale:s,outerRadius:a}=this.properties,{min:n,max:r,label:l,interval:c}=s,p=Fn(t.startAngle-90),d=Fn(t.endAngle-90),f=ap(d-p)>Math.PI,y=f||Gn(1.5*Math.PI,p,d),g=f||Gn(0*Math.PI,p,d),m=f||Gn(.5*Math.PI,p,d),S=f||Gn(1*Math.PI,p,d);let D;S&&!g?D="right":!S&&g?D="left":D="center";let b;y&&!m?b="bottom":!y&&m?b="top":b="middle";const v=fw({startAngle:p,endAngle:d,innerRadius:0,outerRadius:.5}),R=-(v.x+v.width/2)*2,T=-(v.y+v.height/2)*2,O=Math.min(i/v.width,o/v.height);e.domain=[n,r],e.range=[p,d],e.arcLength=O/2;const{maxSpacing:x,minSpacing:A}=c,{arcLength:k}=e,I=x?Math.floor(k/x):1,N=A?Math.floor(k/A):1/0,L=Math.floor(4/Math.PI*Math.abs(e.range[0]-e.range[1])),M=Math.max(I,Math.min(N,L)),E=c.values??e.ticks({nice:!1,interval:c.step,minTickCount:I,maxTickCount:N,tickCount:M}),C=E.reduce((K,$)=>Math.max(K,typeof $=="number"?zE($):0),0),w=e.tickFormatter({domain:e.domain,ticks:E,fractionDigits:C,specifier:l.format}),G=l.getFont(),P=E.map((K,$)=>{const U=l.formatter?.({value:K,index:$,domain:e.domain,boundSeries:void 0})??w(K),{width:Z,height:Q}=dw.measureText(U,{font:G});return{index:$,value:K,text:U,width:Z,height:Q}}),B=P.reduce((K,$)=>Math.max(K,$.width),0),_=P.reduce((K,$)=>Math.max(K,$.height),0),F=l.enabled?Math.max(B,_)+l.spacing:0,V=Math.max(.5*O-F,0),W=a??V;return this.centerX=i/2+R*W,this.centerY=o/2+T*W,this.radius=W,this.textAlign=D,this.verticalAlign=b,P}createConicGradient(e,t){const{scale:i}=this,{domain:o,range:s}=i,[a,n]=s,{defaultColorRange:r}=this.properties,l=Rm((a+n)/2+Math.PI),c=ap(n-a);return{type:"gradient",gradient:"conic",colorSpace:"oklch",colorStops:Dw(e,r,o,t).map(({color:d,stop:u})=>(u=Math.min(Math.max(u,0),1),u=(a+c*u-l)/(2*Math.PI),u=(u%1+1)%1,{stop:u,color:d})),rotation:gw(l)+90}}getShapeFillBBox(){const{centerX:e,centerY:t,radius:i}=this;return new yw(e-i,t-i,2*i,2*i)}getTargets(){const{properties:e}=this,t=e.defaultTarget;return Array.from(e.targets).map(i=>{const{text:o=t.text,value:s=t.value??0,shape:a=t.shape??"triangle",rotation:n=t.rotation??0,strokeWidth:r=t.strokeWidth??0,placement:l=t.placement??"middle",spacing:c=t.spacing??0,size:p=t.size??0,fill:d=t.fill??"black",fillOpacity:u=t.fillOpacity??1,stroke:f=t.stroke??"black",strokeOpacity:y=t.strokeOpacity??1,lineDash:g=t.lineDash??[0],lineDashOffset:m=t.lineDashOffset??0}=i,{enabled:S=t.label.enabled,color:D=t.label.color??"black",fontStyle:b=t.label.fontStyle??"normal",fontWeight:v=t.label.fontWeight??"normal",fontSize:R=t.label.fontSize,fontFamily:T=t.label.fontFamily,spacing:O=t.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:l,spacing:c,size:p,rotation:n,fill:d,fillOpacity:u,stroke:f,strokeWidth:r,strokeOpacity:y,lineDash:g,lineDashOffset:m,label:{enabled:S,color:D,fontStyle:b,fontWeight:v,fontSize:R,fontFamily:T,spacing:O}}})}getTargetRadius(e){const{radius:t,properties:i}=this,{innerRadiusRatio:o,outerRadiusRatio:s}=i,{placement:a,spacing:n,size:r}=e,l=t*s,c=t*o;switch(a){case"inside":return Math.max(c-n-r/2,0);case"outside":return l+n+r/2;default:return(c+l)/2}}getTargetLabel(e){const{scale:t}=this,{value:i,size:o,placement:s,label:a}=e,{spacing:n,color:r,fontStyle:l,fontWeight:c,fontSize:p,fontFamily:d}=a,u=void 0,f=t.convert(i),y=Rm(f)/(Math.PI/2)|0,g=o/2+n;let m,S,D,b;switch(s){case"outside":({textAlign:m,textBaseline:S}=vw[y]),D=g*Math.cos(f),b=g*Math.sin(f);break;case"inside":({textAlign:m,textBaseline:S}=Ow[y]),D=-g*Math.cos(f),b=-g*Math.sin(f);break;default:m="center",S="bottom",D=0,b=-g;break}return{offsetX:D,offsetY:b,fill:r,textAlign:m,textBaseline:S,fontStyle:l,fontWeight:c,fontSize:p,fontFamily:d,lineHeight:u}}createNodeData(){if(!this.properties.isValid())return;const e=this.layoutScale(),{id:t,scale:i,properties:o,radius:s,centerX:a,centerY:n}=this,{value:r,innerRadiusRatio:l,outerRadiusRatio:c,segmentation:p,cornerRadius:d,cornerMode:u,needle:f,bar:y,scale:g,label:m,secondaryLabel:S}=o,{outerRadius:D=s*c,innerRadius:b=s*l}=o,v=this.getTargets(),R=[],T=[],O=[],x=[],A=[],k=u==="item",I=i.convert(i.domain[0]),N=i.convert(r),L=Math.ceil(ap(N-I)*s);let M=p.enabled?p.interval.getSegments(i,L):void 0;const E=y.enabled?y.fill??this.createConicGradient(y.fills,y.fillMode):"rgba(0,0,0,0)",C=g.fill??(y.enabled&&g.fills.length===0?g.defaultFill:void 0)??this.createConicGradient(g.fills,g.fillMode);if(M==null&&k){const w=Math.min(...i.domain),G=Math.max(...i.domain),P={value:r,segmentStart:w,segmentEnd:G},_=Math.min(d,(D-b)/2)/((b+D)/2);R.push({series:this,itemId:"value",datum:P,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:D,innerRadius:b,startAngle:I-_,endAngle:N+_,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,fill:E}),A.push({series:this,itemId:"scale",datum:P,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:D,innerRadius:b,startAngle:i.range[0]-_,endAngle:i.range[1]+_,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,fill:C})}else{M??(M=i.domain);for(let w=0;w<M.length-1;w++){const G=M[w],P=M[w+1],B={value:r,segmentStart:G,segmentEnd:P},_=w===0,F=w===M.length-2,V=i.convert(G),W=i.convert(P);R.push({series:this,itemId:`value-${w}`,datum:B,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:D,innerRadius:b,startAngle:V,endAngle:W,clipStartAngle:I,clipEndAngle:N,startCornerRadius:k||_?d:0,endCornerRadius:k||F?d:0,fill:E}),A.push({series:this,itemId:`scale-${w}`,datum:B,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:D,innerRadius:b,startAngle:V,endAngle:W,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:k||_?d:0,endCornerRadius:k||F?d:0,fill:C})}}if(!f.enabled&&m.enabled){const{text:w,color:G,fontSize:P,minimumFontSize:B,fontStyle:_,fontWeight:F,fontFamily:V,lineHeight:W,formatter:K=$=>this.formatLabel($.value)}=m;x.push({label:"primary",centerX:a,centerY:n,text:w,value:r,fill:G,fontSize:P,minimumFontSize:B,fontStyle:_,fontWeight:F,fontFamily:V,lineHeight:W,formatter:K})}if(!f.enabled&&S.enabled){const{text:w,color:G,fontSize:P,minimumFontSize:B,fontStyle:_,fontWeight:F,fontFamily:V,lineHeight:W,formatter:K}=S;x.push({label:"secondary",centerX:a,centerY:n,text:w,value:r,fill:G,fontSize:P,minimumFontSize:B,fontStyle:_,fontWeight:F,fontFamily:V,lineHeight:W,formatter:K})}if(f.enabled){let w=f.radiusRatio!=null?s*f.radiusRatio:b;w=Math.max(w-f.spacing,0);const G=i.convert(r);O.push({centerX:a,centerY:n,radius:w,angle:G,series:this})}for(let w=0;w<v.length;w+=1){const G=v[w],{value:P,text:B,size:_,shape:F,fill:V,fillOpacity:W,stroke:K,strokeWidth:$,strokeOpacity:U,lineDash:Z,lineDashOffset:Q}=G;if(P<Math.min(...i.domain)||P>Math.max(...i.domain))continue;const ee=this.getTargetRadius(G),J=i.convert(P),j=Fn(G.rotation+xw[G.placement]);T.push({series:this,itemId:`target-${w}`,midPoint:{x:ee*Math.cos(J)+a,y:ee*Math.sin(J)+n},datum:{value:P},datumIndex:{type:1,index:w},type:1,value:P,text:B,centerX:a,centerY:n,shape:F,radius:ee,angle:J,rotation:j,size:_,fill:V,fillOpacity:W,stroke:K,strokeOpacity:U,strokeWidth:$,lineDash:Z,lineDashOffset:Q,label:this.getTargetLabel(G)})}return{itemId:t,nodeData:R,needleData:O,targetData:T,labelData:x,scaleData:A,tickData:e}}updateSelections(e){(this.nodeDataRefresh||e)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(e){if(e!=null&&e.series===this&&e.type===1)return e}update({seriesRect:e}){const{datumSelection:t,labelSelection:i,needleSelection:o,targetSelection:s,targetLabelSelection:a,scaleSelection:n,highlightTargetSelection:r,tickSelection:l}=this,c=this.checkResize(e);this.updateSelections(c),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const p=this.contextNodeData?.nodeData??[],d=this.contextNodeData?.labelData??[],u=this.contextNodeData?.needleData??[],f=this.contextNodeData?.targetData??[],y=this.contextNodeData?.scaleData??[],g=this.contextNodeData?.tickData??[],m=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:y,scaleSelection:n}),this.updateScaleNodes({scaleSelection:n}),this.needleSelection=this.updateNeedleSelection({needleData:u,needleSelection:o}),this.updateNeedleNodes({needleSelection:o}),this.targetSelection=this.updateTargetSelection({targetData:f,targetSelection:s}),this.updateTargetNodes({targetSelection:s,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:f,targetLabelSelection:a}),this.updateTargetLabelNodes({targetLabelSelection:a}),this.datumSelection=this.updateDatumSelection({nodeData:p,datumSelection:t}),this.updateDatumNodes({datumSelection:t}),this.labelSelection=this.updateLabelSelection({labelData:d,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:m!=null?[m]:[],targetSelection:r}),this.updateTargetNodes({targetSelection:r,isHighlight:!0}),this.tickSelection=this.updateTickSelection({tickData:g,tickSelection:l}),this.updateTickNodes({tickSelection:l}),c&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>sp(e.nodeData.length,t.itemId))}updateDatumNodes(e){const{datumSelection:t}=e,{ctx:i,properties:o}=this,{bar:s,segmentation:a}=o,n=a.spacing??0,{fillOpacity:r,stroke:l,strokeOpacity:c,lineDash:p,lineDashOffset:d}=s,u=this.getStrokeWidth(s.strokeWidth),f=i.animationManager.isSkipped(),y=this.getShapeFillBBox();t.each((g,m)=>{const{centerX:S,centerY:D,innerRadius:b,outerRadius:v,startCornerRadius:R,endCornerRadius:T,fill:O}=m;g.centerX=S,g.centerY=D,g.innerRadius=b,g.outerRadius=v,g.pointerEvents=this.properties.bar.enabled?fo.PointerEvents.All:fo.PointerEvents.None,g.fill=O,g.fillBBox=y,g.fillOpacity=r,g.stroke=l,g.strokeOpacity=c,g.strokeWidth=u,g.lineDash=p,g.lineDashOffset=d,g.startOuterCornerRadius=R,g.startInnerCornerRadius=R,g.endOuterCornerRadius=T,g.endInnerCornerRadius=T,g.radialEdgeInset=(n+g.strokeWidth)/2,g.concentricEdgeInset=g.strokeWidth/2,(f||g.previousDatum==null)&&g.setProperties(op(g,m))}),this.datumUnion.update(t,this.itemGroup,fo.Sector,(g,m,S)=>{g.clipSector??(g.clipSector=new Sw(NaN,NaN,NaN,NaN)),g.centerX=m.centerX,g.centerY=m.centerY,g.outerRadius=g.clipSector.outerRadius=m.outerRadius,g.innerRadius=g.clipSector.innerRadius=m.innerRadius,g.startAngle=g.clipSector.startAngle=m.startAngle,g.startInnerCornerRadius=m.startInnerCornerRadius,g.startOuterCornerRadius=m.startOuterCornerRadius,g.endAngle=S.endAngle,g.clipSector.endAngle=S.clipSector?.endAngle??S.endAngle,g.endInnerCornerRadius=S.endInnerCornerRadius,g.endOuterCornerRadius=S.endOuterCornerRadius,g.pointerEvents=fo.PointerEvents.None})}updateScaleSelection(e){return e.scaleSelection.update(e.scaleData,void 0,t=>sp(e.scaleData.length,t.itemId))}updateScaleNodes(e){const{scaleSelection:t}=e,{scale:i,segmentation:o}=this.properties,s=o.spacing??0,{fillOpacity:a,stroke:n,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:p}=i,d=this.getShapeFillBBox();t.each((u,f)=>{const{centerX:y,centerY:g,innerRadius:m,outerRadius:S,startCornerRadius:D,endCornerRadius:b,fill:v}=f;u.centerX=y,u.centerY=g,u.innerRadius=m,u.outerRadius=S,u.fill=v,u.fillBBox=d,u.fillOpacity=a,u.stroke=n,u.strokeOpacity=r,u.strokeWidth=l,u.lineDash=c,u.lineDashOffset=p,u.startOuterCornerRadius=D,u.startInnerCornerRadius=D,u.endOuterCornerRadius=b,u.endInnerCornerRadius=b,u.radialEdgeInset=(s+u.strokeWidth)/2,u.concentricEdgeInset=u.strokeWidth/2,u.setProperties(op(u,f))})}updateNeedleSelection(e){return e.needleSelection.update(e.needleData,void 0,()=>sp([]))}updateNeedleNodes(e){const{needleSelection:t}=e,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=this.properties.needle,c=this.ctx.animationManager.isSkipped();t.each((p,d)=>{const{centerX:u,centerY:f,radius:y}=d,g=y*2;p.d=qc.defaultPathData,p.fill=i,p.fillOpacity=o,p.stroke=s,p.strokeOpacity=a,p.strokeWidth=n/g,p.lineDash=r.map(m=>m/g),p.lineDashOffset=l/g,p.translationX=u,p.translationY=f,p.scalingX=g,p.scalingY=g,c&&p.setProperties(vm(p,d))})}updateTargetSelection(e){return e.targetSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetNodes(e){const{targetSelection:t,isHighlight:i}=e,o=i?this.properties.highlightStyle.item:void 0;t.each((s,a)=>{const{centerX:n,centerY:r,angle:l,radius:c,shape:p,size:d,rotation:u,fill:f,fillOpacity:y,stroke:g,strokeOpacity:m,strokeWidth:S,lineDash:D,lineDashOffset:b}=a;s.shape=p==="line"?Mf:p,s.size=d,s.fill=o?.fill??f,s.fillOpacity=o?.fillOpacity??y,s.stroke=o?.stroke??g,s.strokeOpacity=o?.strokeOpacity??m,s.strokeWidth=o?.strokeWidth??S,s.lineDash=o?.lineDash??D,s.lineDashOffset=o?.lineDashOffset??b,s.translationX=n+c*Math.cos(l),s.translationY=r+c*Math.sin(l),s.rotation=l+u})}updateTargetLabelSelection(e){return e.targetLabelSelection.update(e.targetData,void 0,t=>t.itemId)}updateTargetLabelNodes(e){const{targetLabelSelection:t}=e;t.each((i,o)=>{const{centerX:s,centerY:a,radius:n,angle:r,text:l}=o,{offsetX:c,offsetY:p,fill:d,fontStyle:u,fontWeight:f,fontSize:y,fontFamily:g,textAlign:m,textBaseline:S}=o.label;if(l==null){i.visible=!1;return}i.visible=!0,i.x=s+n*Math.cos(r)+c,i.y=a+n*Math.sin(r)+p,i.text=l,i.fill=d,i.fontStyle=u,i.fontWeight=f,i.fontSize=y,i.fontFamily=g,i.textAlign=m,i.textBaseline=S})}updateLabelSelection(e){return e.labelSelection.update(e.labelData,void 0,t=>t.label)}updateLabelNodes(e){const{labelSelection:t}=e,i=this.ctx.animationManager.isSkipped();t.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}updateTickSelection(e){return e.tickSelection.update(e.tickData,void 0,t=>t.index)}updateTickNodes(e){const{scale:t,radius:i,centerX:o,centerY:s,properties:a}=this,{enabled:n,color:r,fontFamily:l,fontSize:c,fontStyle:p,fontWeight:d,spacing:u}=a.scale.label,f=Fn(a.scale.label.rotation??0);e.tickSelection.each((y,g)=>{if(!n){y.visible=!1;return}y.visible=!0,y.text=g.text,y.fill=r,y.fontFamily=l,y.fontSize=c,y.fontStyle=p,y.fontWeight=d,y.textAlign="center",y.textBaseline="middle";const m=t.convert(g.value),{width:S,height:D}=g,b=Math.abs(i*Math.cos(m)),v=Math.abs(i*Math.sin(m)),R=Math.min(Math.max(Math.abs(i/Math.tan(m)),b-S/2),b+S/2),T=Math.min(Math.max(Math.abs(i*Math.tan(m)),v-D/2),v+D/2),O=Math.hypot(R,T),x=o+(O+u)*Math.cos(m),A=s+(O+u)*Math.sin(m);y.x=x,y.y=A,y.rotationCenterX=x,y.rotationCenterY=A,y.rotation=f})}labelsHaveExplicitText(){for(const{datum:e}of this.labelSelection)if(e.text==null)return!1;return!0}formatLabelText(e){const{labelSelection:t,radius:i,textAlign:o,verticalAlign:s}=this,{spacing:a,innerRadiusRatio:n}=this.properties;hw(this,t,{padding:a,textAlign:o,verticalAlign:s},i*n,e)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),Om([this.datumSelection],op),Om([this.needleSelection],vm),this.formatLabelText()}resetAnimation(e){e==="initial"?this.animationState.transition("reset"):e==="ready"&&this.animationState.transition("skip")}animateLabelText(e={}){const{animationManager:t}=this.ctx;let i,o,s,a;if(this.labelSelection.each((n,r)=>{n.opacity=1,r.label==="primary"?(i=n.previousDatum?.value??e.from??r.value,o=r.value):r.label==="secondary"&&(s=n.previousDatum?.value??e.from??r.value,a=r.value)}),!this.labelsHaveExplicitText())if(o==null||a==null)this.formatLabelText();else if(i===o&&s===a)this.formatLabelText({label:o,secondaryLabel:a});else{const n=`${this.id}_labels`;t.animate({id:n,groupId:"label",from:{label:i,secondaryLabel:s},to:{label:o,secondaryLabel:a},phase:e.phase??"update",onUpdate:r=>this.formatLabelText(r)})}}animateEmptyUpdateReady(){const{animationManager:e}=this.ctx,{node:t,needle:i}=xm(!0,this.scale.range[0]);zs(this.id,"node",e,[this.datumSelection],t,(o,s)=>s.itemId),zs(this.id,"needle",e,[this.needleSelection],i,()=>"needle"),zs(this.id,"label",e,[this.labelSelection],Tf,(o,s)=>s.label),this.animateLabelText({from:this.properties.scale.min,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:e}=this.ctx,{node:t,needle:i}=xm(!1,this.scale.range[0]);zs(this.id,"node",e,[this.datumSelection],t,(o,s)=>s.itemId),zs(this.id,"needle",e,[this.needleSelection],i,()=>"needle"),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(e,t){return[NaN,NaN]}getLegendData(){return[]}getTooltipContent(e){const{id:t,properties:i}=this,{tooltip:o}=i;if(!i.isValid())return;let s,a;if(e.type===0?(s=i.value,a=i.label.text):{value:s,text:a}=i.targets[e.index],s!=null)return o.formatTooltip(this.properties,{data:[{label:a,fallbackLabel:"Value",value:this.formatLabel(s)}]},{seriesId:t,title:void 0,datum:void 0,value:s})}pickNodeClosestDatum(e){return Cf(this,e)}pickFocus(e){return Pf(this,e)}getCaptionText(){const{value:e}=this.properties,t=[];return t.push(this.formatLabel(e)),this.labelSelection.each((i,o)=>{const s=Ns(this,o);s!=null&&t.push(s)}),t.join(". ")}getCategoryValue(e){}datumIndexForCategoryValue(e){}};Wn.className="RadialGaugeSeries",Wn.type="radial-gauge";import{_ModuleSupport as kw}from"ag-charts-community";import{and as Am,arrayOf as np,arrayOfDefs as Rw,boolean as $s,callback as Tm,color as Im,constant as Nw,fillOptionsDef as Kn,fontOptionsDef as Aw,greaterThan as Tw,lessThan as Iw,lineDashOptionsDef as zn,number as st,or as Mw,positiveNumber as Tt,ratio as rp,required as lp,string as cp,strokeOptionsDef as $n,union as pp}from"ag-charts-core";var{commonSeriesOptionsDefs:Lw,autoSizedLabelOptionsDefs:Mm,seriesLabelOptionsDefs:Lm,tooltipOptionsDefs:Cw,numberFormatValidator:Pw}=kw,Cm={value:lp(st),text:cp,shape:Mw(pp("circle","cross","diamond","heart","plus","pin","square","star","triangle","line"),Tm),placement:pp("inside","outside","middle"),spacing:Tt,size:Tt,rotation:st,label:{...Lm,spacing:Tt},...Kn,...$n,...zn},Hn={type:lp(Nw("radial-gauge")),value:lp(st),outerRadius:Tt,innerRadius:Tt,outerRadiusRatio:rp,innerRadiusRatio:rp,startAngle:st,endAngle:st,spacing:Tt,cornerMode:pp("container","item"),cornerRadius:Tt,scale:{min:Am(st,Iw("max")),max:Am(st,Tw("min")),label:{enabled:$s,formatter:Tm,rotation:st,spacing:Tt,minSpacing:Tt,avoidCollisions:$s,format:Pw,...Aw},interval:{values:np(st),step:st},...rn,...Kn,...$n,...zn},targets:Rw(Cm,"target options array"),segmentation:{enabled:$s,spacing:Tt,interval:{values:np(st),step:st,count:st}},bar:{enabled:$s,...rn,...Kn,...$n,...zn},needle:{enabled:$s,spacing:Tt,radiusRatio:rp,...Kn,...$n,...zn},label:{text:cp,spacing:Tt,...Mm},secondaryLabel:{text:cp,...Mm},tooltip:Cw,...Lw};Hn.defaultColorRange=np(Im),Hn.defaultTarget={...Cm,value:st,label:{...Lm,spacing:st}},Hn.scale.defaultFill=Im;var{FONT_SIZE_RATIO:Ew}=Uc,LW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"radial-gauge",moduleFactory:e=>new Wn(e),tooltipDefaults:{range:10},themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{outerRadiusRatio:1,innerRadiusRatio:.8,startAngle:270,endAngle:450,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},Uc.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["./2",Uc.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:12}},bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:2},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"outside",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},needle:{enabled:!1,fill:{$ref:"foregroundColor"},spacing:10},label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:56,minimumFontSize:18/56,fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}},secondaryLabel:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[Ew.LARGE]},minimumFontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"}}}}},Pm={type:"series",name:"radial-gauge",chartType:"gauge",enterprise:!0,options:Hn,create:e=>new Wn(e)};import{_ModuleSupport as Em}from"ag-charts-community";import{_ModuleSupport as ww}from"ag-charts-community";import{Logger as _w}from"ag-charts-core";function wm(e){e.nodes.sort((t,i)=>Math.round((t.datum.y-i.datum.y)*100)/100||-(t.datum.size-i.datum.size))}function Bw({nodes:e,size:t},{seriesRectHeight:i,nodeSpacing:o,sizeScale:s}){const a=i*t*s;let n=(i-(a+o*(e.length-1)))/2;e.forEach(({datum:r})=>{const l=i*r.size*s;r.y=n,r.height=l,n+=l+o})}function Gw(e,t){const{nodes:i}=e,{seriesRectHeight:o,nodeSpacing:s}=t;wm(e);let a=0,n=0;for(const{datum:c}of i){const p=Math.max(n-c.y,0);c.y+=p,a+=p,n=c.y+c.height+s}if(n-s<o)return a>0;let l=o;for(let c=i.length-1;c>=0;c-=1){const{datum:p}=i[c],d=p.y+p.height,u=Math.min(l-d,0);p.y+=u,a+=u,l=p.y-s}return!0}function hp(e,t,i,o,s,a,n,r){const l=(i-e)/(o-t),c=(n-s)/(r-a),p=((a-t)*(l*c)+e*c-s*l)/(c-l);return e<i?p>e&&p<Math.min(i,n):p<e&&p>Math.max(i,n)}function _m(e,t){let i=!1;const o=e.nodes.filter(a=>t(a).length===1);let s=!0;for(let a=0;s&&a<o.length;a+=1){s=!1;for(let n=0;n<o.length-1;n+=1){const{datum:r}=o[n],l=t(o[n])[0].node.datum,{datum:c}=o[n+1],p=t(o[n+1])[0].node.datum;if(!(hp(r.x,r.y,l.x,l.y,c.x,c.y,p.x,p.y)||hp(r.x,r.y+r.height/2,l.x,l.y+l.height/2,c.x,c.y+c.height/2,p.x,p.y+p.height/2)||hp(r.x,r.y+r.height,l.x,l.y+l.height,c.x,c.y+c.height,p.x,p.y+p.height)))continue;const u=o[n];o[n]=o[n+1],o[n+1]=u;const f=r.y;r.y=c.y+c.height-r.height,c.y=f,i=!0,s=!0}}return i}function Fw(e){let t=!1;return wm(e),t=_m(e,i=>i.linksBefore)||t,t=_m(e,i=>i.linksAfter)||t,t}function Vw(e){if(e.length===0)return;let t=0,i=0;for(const{node:{datum:o}}of e)t+=o.y*o.size,i+=o.size;return t/i}function Bm(e,t,i,o){return e.nodes.forEach(({datum:s,linksBefore:a,linksAfter:n})=>{const r=o===1?a:n,l=o===1?n:a,c=Vw(r);if(c!=null){const p=l.length!==0?i:1;s.y=s.y+(c-s.y)*p}}),Gw(e,t)}function Gm(e,t,i){let o=!1;for(const s of e)o=Bm(s,t,i,1)||o;return o}function Ww(e,t,i){let o=!1;for(let s=e.length-1;s>=0;s-=1)o=Bm(e[s],t,i,-1)||o;return o}function Fm(e){let t=!1;for(let i=e.length-1;i>=0;i-=1)t=Fw(e[i])||t;return t}function Kw(e,t){e.forEach(o=>{Bw(o,t)});let i=!1;for(let o=0;o<6;o+=1){const s=Gm(e,t,1);i=Ww(e,t,.5);const a=Fm(e);if(!s&&!i&&!a)break}i&&(Gm(e,t,1),Fm(e))}import{_ModuleSupport as zw}from"ag-charts-community";var{BBox:$w,Path:Hw,ScenePathChangeDetection:Xo,splitBezier:Yw}=zw;function Yn(e,t,i,o,s,a,n,r,l,c){let p,d;if(s!==i&&l!==n){const T=-(o-t)/(s-i),O=-(r-a)/(l-n);p=(n-i+T*t-O*a)/(T-O),d=T*(p-t)+i}else if(s===i&&l!==n)p=t,d=-(r-a)/(l-n)*(p-r)+l;else if(s!==i&&l===n)p=r,d=-(o-t)/(s-i)*(p-t)+i;else throw new Error("Offsetting flat bezier curve");const u=Math.hypot(i-d,t-p),f=(u+c)/u,y=Math.hypot(l-d,r-p),g=(y+c)/y,m=p+(o-p)*f,S=d+(s-d)*f,D=p+(a-p)*g,b=d+(n-d)*g,v=p+(r-p)*g,R=d+(l-d)*g;e.cubicCurveTo(m,S,D,b,v,R)}var go=class extends Hw{constructor(){super(...arguments),this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.height=0,this.inset=0}computeBBox(){const e=Math.min(this.x1,this.x2),t=Math.max(this.x1,this.x2)-e,i=Math.min(this.y1,this.y2),o=Math.max(this.y1,this.y2)-i+this.height;return new $w(e,i,t,o)}updatePath(){const{path:e,inset:t}=this;e.clear();const i=this.x1+t,o=this.x2-t,s=this.y1+t,a=this.y2+t,n=this.height-2*t;if(n<0||i>o)return;const r=i,l=s+n/2,c=(i+o)/2,p=s+n/2,d=(i+o)/2,u=a+n/2,f=o,y=a+n/2;if(e.moveTo(r,l-n/2),Math.abs(this.y2-this.y1)<1||this.x2-this.x1<this.height*Math.SQRT2)e.cubicCurveTo(c,p-n/2,d,u-n/2,f,y-n/2),e.lineTo(f,y+n/2),e.cubicCurveTo(d,u+n/2,c,p+n/2,r,l+n/2);else{const[g,m]=Yw(r,l,c,p,d,u,f,y,.5),S=(a>s?1:-1)*n/2;Yn(e,g[0].x,g[0].y,g[1].x,g[1].y,g[2].x,g[2].y,g[3].x,g[3].y,S),Yn(e,m[0].x,m[0].y,m[1].x,m[1].y,m[2].x,m[2].y,m[3].x,m[3].y,-S),e.lineTo(f,y+n/2),Yn(e,m[3].x,m[3].y,m[2].x,m[2].y,m[1].x,m[1].y,m[0].x,m[0].y,S),Yn(e,g[3].x,g[3].y,g[2].x,g[2].y,g[1].x,g[1].y,g[0].x,g[0].y,-S)}e.closePath()}};h([Xo()],go.prototype,"x1",2),h([Xo()],go.prototype,"x2",2),h([Xo()],go.prototype,"y1",2),h([Xo()],go.prototype,"y2",2),h([Xo()],go.prototype,"height",2),h([Xo()],go.prototype,"inset",2);import{_ModuleSupport as Xw}from"ag-charts-community";var{BaseProperties:Vm,FillGradientDefaults:Uw,FillPatternDefaults:qw,SeriesTooltip:jw,SeriesProperties:Jw,ARRAY:Zw,ARRAY_OF:dp,COLOR_STRING:Uo,COLOR_STRING_ARRAY:Wm,FUNCTION:Km,LINE_DASH:zm,OBJECT:qo,POSITIVE_NUMBER:yo,OR:up,COLOR_GRADIENT:fp,COLOR_PATTERN:Qw,RATIO:Xn,STRING:wi,UNION:e_,TempValidate:te,Label:t_}=Xw,i_=e_(["left","right","center","justify"],"a justification value"),$m=class extends t_{constructor(){super(...arguments),this.spacing=1}};h([te(yo)],$m.prototype,"spacing",2);var Di=class extends Vm{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};h([te(up(fp,Uo),{optional:!0})],Di.prototype,"fill",2),h([te(Xn)],Di.prototype,"fillOpacity",2),h([te(Uo,{optional:!0})],Di.prototype,"stroke",2),h([te(Xn)],Di.prototype,"strokeOpacity",2),h([te(yo)],Di.prototype,"strokeWidth",2),h([te(zm)],Di.prototype,"lineDash",2),h([te(yo)],Di.prototype,"lineDashOffset",2),h([te(Km,{optional:!0})],Di.prototype,"itemStyler",2);var It=class extends Vm{constructor(){super(...arguments),this.spacing=1,this.width=1,this.alignment="justify",this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};h([te(yo)],It.prototype,"spacing",2),h([te(yo)],It.prototype,"width",2),h([te(i_)],It.prototype,"alignment",2),h([te(up(fp,Uo),{optional:!0})],It.prototype,"fill",2),h([te(Xn)],It.prototype,"fillOpacity",2),h([te(Uo,{optional:!0})],It.prototype,"stroke",2),h([te(Xn)],It.prototype,"strokeOpacity",2),h([te(yo)],It.prototype,"strokeWidth",2),h([te(zm)],It.prototype,"lineDash",2),h([te(yo)],It.prototype,"lineDashOffset",2),h([te(Km,{optional:!0})],It.prototype,"itemStyler",2);var Be=class extends Jw{constructor(){super(...arguments),this.nodes=void 0,this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.fillGradientDefaults=new Uw,this.fillPatternDefaults=new qw,this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=[],this.strokes=[],this.label=new $m,this.link=new Di,this.node=new It,this.tooltip=new jw}};h([te(Zw,{optional:!0})],Be.prototype,"nodes",2),h([te(wi)],Be.prototype,"fromKey",2),h([te(wi)],Be.prototype,"toKey",2),h([te(wi)],Be.prototype,"idKey",2),h([te(wi,{optional:!0})],Be.prototype,"idName",2),h([te(wi,{optional:!0})],Be.prototype,"labelKey",2),h([te(wi,{optional:!0})],Be.prototype,"labelName",2),h([te(wi,{optional:!0})],Be.prototype,"sizeKey",2),h([te(wi,{optional:!0})],Be.prototype,"sizeName",2),h([te(qo)],Be.prototype,"fillGradientDefaults",2),h([te(qo)],Be.prototype,"fillPatternDefaults",2),h([te(dp(Wm))],Be.prototype,"defaultColorRange",2),h([te(dp(Uo))],Be.prototype,"defaultPatternFills",2),h([te(dp(up(fp,Uo,Qw)))],Be.prototype,"fills",2),h([te(Wm)],Be.prototype,"strokes",2),h([te(qo)],Be.prototype,"label",2),h([te(qo)],Be.prototype,"link",2),h([te(qo)],Be.prototype,"node",2),h([te(qo)],Be.prototype,"tooltip",2);var{Transformable:o_,applyShapeStyle:Hm,SeriesNodePickMode:Ym,CachedTextMeasurerPool:s_,TextWrapper:Xm,TextUtils:Um,createDatumId:Un,getShapeStyle:qn,Rect:qm,BBox:jm}=ww,jn=class extends Ru{constructor(e){super({moduleCtx:e,pickModes:[Ym.NEAREST_NODE,Ym.EXACT_SHAPE_MATCH]}),this.properties=new Be}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new go}nodeFactory(){return new qm}createNodeData(){const{id:e,_nodeDataDependencies:{seriesRectWidth:t,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:o,toKey:s,sizeKey:a,label:{spacing:n},node:{spacing:r,width:l,alignment:c}}=this.properties,{nodeGraph:p,links:d,maxPathLength:u}=this.getNodeGraph(O=>({...O,x:NaN,y:NaN,width:l,height:NaN}),O=>({...O,x1:NaN,x2:NaN,y1:NaN,y2:NaN,height:NaN}),{includeCircularReferences:!1}),f=p,y=this.isLabelEnabled()?(t-l)*(1-u/(u+1)):0,g=(t-l-2*y)/(u-1),m=[];for(let O=0;O<u;O+=1){const x=y+O*g;m.push({index:O,size:0,nodes:[],x})}f.forEach(O=>{const{datum:x,linksBefore:A,linksAfter:k,maxPathLengthBefore:I,maxPathLengthAfter:N}=O,L=Math.max(A.reduce((C,{link:w})=>C+w.size,0),k.reduce((C,{link:w})=>C+w.size,0));if(A.length===0&&k.length===0||L===0){O.columnIndex=-1;return}let M;switch(c){case"left":M=m[I];break;case"right":M=m[u-1-N];break;case"center":{if(A.length!==0)M=m[I];else if(k.length!==0){const C=k.reduce((w,G)=>Math.min(w,G.node.maxPathLengthBefore),u)-1;M=m[C]}else M=m[0];break}case"justify":{M=k.length===0?m[u-1]:m[I];break}}x.x=M.x,x.size=L;const E=this.getLabelText(this.properties.label,{datum:x.datum,value:x.label,fromKey:o,toKey:s,sizeKey:a,size:L});x.label=String(E),M.nodes.push(O),M.size+=L,O.columnIndex=M.index}),f.forEach(O=>{let x=1/0,A=0;O.linksAfter.forEach(k=>{const I=k.node,{columnIndex:N}=I;N<x?(x=N,A=I.datum.size):N===x&&(A=Math.max(A,I.datum.size))}),O.closestColumnIndex=x,O.maxSizeOfClosestNodesAfter=A});const S=m.reduce((O,{size:x,nodes:A})=>{const k=(1-(A.length-1)*(r/i))/x;return Math.min(O,k)},1/0);for(let O=m.length-1;O>=0;O-=1)m[O].nodes.sort((A,k)=>A.closestColumnIndex-k.closestColumnIndex||A.maxSizeOfClosestNodesAfter-k.maxSizeOfClosestNodesAfter||A.datum.size-k.datum.size);Kw(m,{seriesRectHeight:i,nodeSpacing:r,sizeScale:S});let D=!1;if(f.forEach(({datum:O,linksBefore:x,linksAfter:A})=>{D||(D=O.height<0);const k=O.y+O.height,I=M=>M.sort((E,C)=>{const w=E.node.datum,G=C.node.datum,P=w.y+w.height,B=G.y+G.height,_=Math.atan2(w.y-O.y,Math.abs(w.x-O.x))-Math.atan2(G.y-O.y,Math.abs(G.x-O.x)),F=Math.atan2(P-k,Math.abs(w.x-O.x))-Math.atan2(B-k,Math.abs(G.x-O.x));return _+F});let N=O.y;I(x).forEach(({link:M})=>{M.y2=N,N+=M.size*i*S});let L=O.y;I(A).forEach(({link:M})=>{M.y1=L,L+=M.size*i*S})}),D){_w.warnOnce("There was insufficient space to display the Sankey Series. Reduce the node spacing, or provide a larger container.");return}const b=[],v=[],{fontSize:R}=this.properties.label,T=this.properties.label.getFont();return m.forEach((O,x)=>{const A=x===0,k=x===m.length-1;let I=-1/0;O.nodes.sort((N,L)=>N.datum.y-L.datum.y),O.nodes.forEach(({datum:N})=>{if(N.midPoint={x:N.x+N.width/2,y:N.y+N.height/2},b.push(N),N.label==null)return;const L=A?N.x-n:N.x+N.width+n,M=N.y+N.height/2;let E;if(!A&&!k){const P=M-Um.getLineHeight(R),B=M+Um.getLineHeight(R);let _=t;f.forEach(({datum:V})=>{V.x>N.x&&Math.max(V.y,P)<=Math.min(V.y+V.height,B)&&(_=Math.min(_,V.x-n))});const F=_-N.x-2*n;E=Xm.wrapText(N.label,{maxWidth:F,maxHeight:N.height,font:this.properties.label,textWrap:"never",overflow:"hide"})}if(E==null||E===""){const P=A||k?n:n*2;E=Xm.wrapText(N.label,{maxWidth:g-P,maxHeight:N.height,font:this.properties.label,textWrap:"never"})}if(E==="")return;const{height:C}=s_.measureText(E,{font:T,textAlign:"left",textBaseline:"middle"}),w=M-C/2,G=M+C/2;w>=I&&(v.push({x:L,y:M,leading:A,text:E}),I=G)})}),d.forEach(O=>{const{fromNode:x,toNode:A,size:k}=O;O.height=i*k*S,O.x1=x.x+l,O.x2=A.x,O.midPoint={x:(O.x1+O.x2)/2,y:(O.y1+O.y2)/2+O.height/2},b.push(O)}),{itemId:e,nodeData:b,labelData:v}}updateLabelSelection(e){const t=this.isLabelEnabled()?e.labelData:[];return e.labelSelection.update(t)}updateLabelNodes(e){const{labelSelection:t}=e,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;t.each((r,{x:l,y:c,leading:p,text:d})=>{r.visible=!0,r.x=l,r.y=c,r.text=d,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign=p?"right":"left",r.textBaseline="middle"})}updateNodeSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>Un([t.type,t.id]))}getBaseNodeStyle(e){const{properties:t}=this,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=t.node,l=e?t.highlightStyle.item:void 0;return qn({fill:l?.fill??i,fillOpacity:l?.fillOpacity??o,stroke:l?.stroke??s,strokeOpacity:l?.strokeOpacity??a,strokeWidth:l?.strokeWidth??this.getStrokeWidth(t.node.strokeWidth),lineDash:l?.lineDash??n,lineDashOffset:l?.lineDashOffset??r},t.fillGradientDefaults,t.fillPatternDefaults)}getNodeStyleOverrides(e,t,i,o,s,a,n){const{id:r,properties:l}=this,{fills:c,strokes:p,defaultColorRange:d,defaultPatternFills:u}=l,{itemStyler:f}=l.node,y=a.fill??c[i%c.length],g=a.stroke??p[i%p.length],m=d[i%d.length].map(b=>({color:b})),S=u[i%u.length];let D;if(n||(D??(D={}),D.fill=y,D.stroke=g),f!=null){const b=this.cachedDatumCallback(Un(e,"node",n?"highlight":"node"),()=>{const{fillOpacity:v=1,strokeOpacity:R=1,strokeWidth:T=0,lineDash:O=[],lineDashOffset:x=0}=a;return this.callWithContext(f,{seriesId:r,datum:t,highlighted:n,label:s,size:o,fill:y,fillOpacity:v,stroke:g,strokeOpacity:R,strokeWidth:T,lineDash:O,lineDashOffset:x})});D??(D={}),Object.assign(D,b)}return qn(D,{...this.properties.fillGradientDefaults.toJson(),colorStops:m},{...this.properties.fillPatternDefaults.toJson(),fill:S,stroke:S})}updateNodeNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getBaseNodeStyle(i),s=this.getShapeFillBBox();t.each((a,n)=>{const{datumIndex:r,size:l,label:c}=n,p=this.getNodeStyleOverrides(String(r.index),n.datum,r.index,l,c,o,i);a.x=n.x,a.y=n.y,a.width=Math.max(n.width,0),a.height=Math.max(n.height,0),Hm(a,o,p,s)})}getShapeFillBBox(){const e=this._nodeDataDependencies?.seriesRectWidth??0,t=this._nodeDataDependencies?.seriesRectHeight??0,i=new jm(0,0,e,t);return{series:i,axis:i}}updateLinkSelection(e){return e.datumSelection.update(e.nodeData,void 0,t=>Un([t.type,t.index,t.fromNode.id,t.toNode.id]))}getBaseLinkStyle(e){const{properties:t}=this,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=t.link,l=e?t.highlightStyle.item:void 0;return qn({fill:l?.fill??i,fillOpacity:l?.fillOpacity??o,stroke:l?.stroke??s,strokeOpacity:l?.strokeOpacity??a,strokeWidth:l?.strokeWidth??this.getStrokeWidth(t.link.strokeWidth),lineDash:l?.lineDash??n,lineDashOffset:l?.lineDashOffset??r},t.fillGradientDefaults,t.fillPatternDefaults)}getLinkStyleOverrides(e,t,i,o,s){const{id:a,properties:n}=this,{fills:r,strokes:l,defaultColorRange:c,defaultPatternFills:p}=n,{itemStyler:d}=n.link,u=o.fill??r[i%r.length],f=o.stroke??l[i%l.length],y=c[i%c.length].map(S=>({color:S})),g=p[i%p.length];let m;if(s||(m??(m={}),m.fill=u,m.stroke=f),d!=null){const S=this.cachedDatumCallback(Un(e,"link",s?"highlight":"node"),()=>{const{fillOpacity:D=1,strokeOpacity:b=1,strokeWidth:v=0,lineDash:R=[],lineDashOffset:T=0}=o;return this.callWithContext(d,{seriesId:a,datum:t,highlighted:s,fill:u,fillOpacity:D,stroke:f,strokeOpacity:b,strokeWidth:v,lineDash:R,lineDashOffset:T})});m??(m={}),Object.assign(m,S)}return qn(m,{...this.properties.fillGradientDefaults.toJson(),colorStops:y},{...this.properties.fillPatternDefaults.toJson(),fill:g,stroke:g})}updateLinkNodes(e){const{datumSelection:t,isHighlight:i}=e,o=this.getBaseLinkStyle(i),s=this.getShapeFillBBox();t.each((a,n)=>{const{datumIndex:r}=n,l=n.fromNode.datumIndex,c=this.getLinkStyleOverrides(String(r.index),n.datum,l.index,o,i);a.x1=n.x1,a.y1=n.y1,a.x2=n.x2,a.y2=n.y2,a.height=n.height,Hm(a,o,c,s),a.inset=a.strokeWidth/2})}getTooltipContent(e){const{id:t,linksProcessedData:i,nodesProcessedData:o,properties:s}=this,{fromKey:a,toKey:n,sizeKey:r,sizeName:l,tooltip:c}=s,p=this.contextNodeData?.nodeData.find(m=>m.datumIndex.type===e.type&&m.datumIndex.index===e.index);if(p==null)return;const d=p.type===0?p.fromNode.index:p.index,u=p.type===0?`${p.fromNode.label} - ${p.toNode.label}`:p.label,f=e.type===0?i?.dataSources.get(this.id)?.[e.index]:o?.dataSources.get(this.id)?.[e.index],y=p.size;let g;if(p.type===0){const m=p.fromNode.datumIndex,S=this.getBaseLinkStyle(!1);Object.assign(S,this.getLinkStyleOverrides(String(e.index),f,m.index,S,!1)),g=S}else{const m=p.label,S=this.getBaseNodeStyle(!1);Object.assign(S,this.getNodeStyleOverrides(String(e.index),f,e.index,y,m,S,!1)),g=S}return c.formatTooltip(this.properties,{title:u,symbol:this.legendItemSymbol(p.type,d,g),data:r!=null?[{label:l,fallbackLabel:r,value:String(y)}]:[]},{seriesId:t,datum:f,title:u,fromKey:a,toKey:n,sizeKey:r,sizeName:l,size:y,...g})}computeFocusBounds(e){if(e instanceof qm){const{x:t,y:i,width:o,height:s}=e,a=new jm(t,i,o,s);return o_.toCanvas(this.contentGroup,a)}return e}};jn.className="SankeySeries",jn.type="sankey";import{_ModuleSupport as a_}from"ag-charts-community";import{arrayOf as Hs,callback as Jm,color as gp,colorUnion as n_,constant as r_,fillGradientDefaults as l_,fillOptionsDef as Zm,fillPatternDefaults as c_,lineDashOptionsDef as Qm,positiveNumber as yp,required as mp,string as Jn,strokeOptionsDef as eS,union as p_}from"ag-charts-core";var{commonSeriesOptionsDefs:h_,seriesLabelOptionsDefs:d_,tooltipOptionsDefs:u_}=a_,Ys={type:mp(r_("sankey")),fromKey:mp(Jn),toKey:mp(Jn),sizeKey:Jn,sizeName:Jn,fills:Hs(n_),strokes:Hs(gp),label:{...d_,spacing:yp},link:{itemStyler:Jm,...Zm,...eS,...Qm},node:{width:yp,spacing:yp,alignment:p_("left","center","right","justify"),itemStyler:Jm,...Zm,...eS,...Qm},tooltip:u_,...h_};Ys.fillGradientDefaults=l_,Ys.fillPatternDefaults=c_,Ys.defaultColorRange=Hs(Hs(gp)),Ys.defaultPatternFills=Hs(gp);var FW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"sankey",moduleFactory:e=>new jn(e),tooltipDefaults:{range:"exact"},themeTemplate:{seriesArea:{padding:{top:10,bottom:10}},series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:Em.FILL_PATTERN_DEFAULTS,defaultColorRange:{$palette:"gradients"},defaultPatternFills:Em.SAFE_FILLS_OPERATION,highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:10},node:{spacing:20,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0}},legend:{enabled:!1,toggleSeries:!1}}},tS={type:"series",name:"sankey",chartType:"flow-proportion",enterprise:!0,options:Ys,create:e=>new jn(e)};import{_ModuleSupport as iS}from"ag-charts-community";import{_ModuleSupport as Xs}from"ag-charts-community";import{_ModuleSupport as f_}from"ag-charts-community";var{HierarchySeriesProperties:g_,HighlightStyle:y_,SeriesTooltip:m_,TempValidate:Ee,COLOR_STRING:S_,FUNCTION:b_,NUMBER:oS,OBJECT:jo,POSITIVE_NUMBER:Sp,RATIO:Zn,STRING:Qn}=f_,_i=class extends y_{constructor(){super(...arguments),this.label=new oi,this.secondaryLabel=new oi}};h([Ee(Qn,{optional:!0})],_i.prototype,"fill",2),h([Ee(Zn,{optional:!0})],_i.prototype,"fillOpacity",2),h([Ee(S_,{optional:!0})],_i.prototype,"stroke",2),h([Ee(Sp,{optional:!0})],_i.prototype,"strokeWidth",2),h([Ee(Zn,{optional:!0})],_i.prototype,"strokeOpacity",2),h([Ee(jo)],_i.prototype,"label",2),h([Ee(jo)],_i.prototype,"secondaryLabel",2);var at=class extends g_{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlightStyle=new _i,this.label=new oi,this.secondaryLabel=new ms,this.tooltip=new m_}};h([Ee(Qn,{optional:!0})],at.prototype,"sizeName",2),h([Ee(Qn,{optional:!0})],at.prototype,"labelKey",2),h([Ee(Qn,{optional:!0})],at.prototype,"secondaryLabelKey",2),h([Ee(Zn)],at.prototype,"fillOpacity",2),h([Ee(Sp)],at.prototype,"strokeWidth",2),h([Ee(Zn)],at.prototype,"strokeOpacity",2),h([Ee(Sp)],at.prototype,"cornerRadius",2),h([Ee(oS,{optional:!0})],at.prototype,"sectorSpacing",2),h([Ee(oS,{optional:!0})],at.prototype,"padding",2),h([Ee(b_,{optional:!0})],at.prototype,"itemStyler",2),h([Ee(jo)],at.prototype,"highlightStyle",2),h([Ee(jo)],at.prototype,"label",2),h([Ee(jo)],at.prototype,"secondaryLabel",2),h([Ee(jo)],at.prototype,"tooltip",2);var{fromToMotion:D_,normalizeAngle360:x_,createDatumId:v_,Sector:bp,Group:er,ScalableGroup:O_,Selection:Dp,TransformableText:xp,BBox:sS,applyShapeStyle:k_,getShapeStyle:vp}=Xs,R_=class extends Xs.HierarchyNode{constructor(){super(...arguments),this.label=void 0,this.secondaryLabel=void 0,this.contentHeight=0,this.bbox=void 0,this.startAngle=0,this.endAngle=0}};function aS(e,t=0,i=2*Math.PI/e.sumSize){for(const o of e.children){const s=t+o.sumSize*i;o.startAngle=t,o.endAngle=s,aS(o,t,i),t=s}}var tr=class extends Xs.HierarchySeries{constructor(){super(...arguments),this.NodeClass=R_,this.properties=new at,this.scalingGroup=this.contentGroup.appendChild(new O_),this.sectorGroup=this.scalingGroup.appendChild(new er),this.sectorLabelGroup=this.scalingGroup.appendChild(new er),this.highlightSectorGroup=this.scalingGroup.appendChild(new er),this.datumSelection=Dp.select(this.sectorGroup,bp),this.labelSelection=Dp.select(this.sectorLabelGroup,er),this.highlightSelection=Dp.select(this.highlightSectorGroup,bp)}processData(){super.processData(),aS(this.rootNode)}updateSelections(){const e=this.ctx.highlightManager?.getActiveHighlight();if(this.highlightSelection.update(e!=null?[e]:[],void 0,a=>this.getDatumId(a)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{chart:t}=this;if(t==null||t.seriesRect==null)return;const o=Array.from(this.rootNode),s=a=>{a.append([new xp({tag:0}),new xp({tag:1})])};this.datumSelection.update(o,void 0,a=>this.getDatumId(a)),this.labelSelection.update(o,s,a=>this.getDatumId(a))}getItemBaseStyle(e){const{properties:t}=this,i=e?t.highlightStyle:void 0;return vp({fill:i?.fill,fillOpacity:i?.fillOpacity??t.fillOpacity,stroke:i?.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(t.strokeWidth),strokeOpacity:i?.strokeOpacity??t.strokeOpacity},t.fillGradientDefaults,t.fillPatternDefaults)}getItemStyleOverrides(e,t,i,o,s,a){const{id:n,properties:r,colorScale:l}=this,{fills:c,strokes:p,itemStyler:d}=r,u=e[0],f=s.fill??c[u%c.length],y=s.stroke??p[u%p.length],g={};if(a||(g.fill=o!=null?l.convert(o):f,g.stroke=y),d!=null){const m=this.cachedDatumCallback(v_(e.join(":"),a?"highlight":"node"),()=>this.callWithContext(d,{seriesId:n,datum:t,depth:i,highlighted:a,fill:f,stroke:y,...s}));Object.assign(g,m)}return vp(g,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}updateNodes(){const{chart:e,data:t,maxDepth:i}=this;if(e==null||t==null)return;const{width:o,height:s}=e.seriesRect,{sectorSpacing:a=0,padding:n=0,cornerRadius:r,childrenKey:l,colorKey:c,colorName:p,labelKey:d,secondaryLabelKey:u,sizeKey:f,sizeName:y}=this.properties;this.contentGroup.translationX=o/2,this.contentGroup.translationY=s/2;const g=a*.5,m=Math.min(o,s)/2,S=m/(i+1),D=-Math.PI/2,b={series:new sS(-m,-m,2*m,2*m),axis:new sS(-m,-m,2*m,2*m)};this.rootNode?.walk(A=>{const{startAngle:k,endAngle:I}=A;if(A.depth!=null){const N=(k+I)/2+D,L=(A.depth+.5)*S;A.midPoint.x=Math.cos(N)*L,A.midPoint.y=Math.sin(N)*L}}),this.rootNode?.walk(A=>{const{datum:k,depth:I,startAngle:N,endAngle:L,parent:M,sumSize:E}=A;A.label=void 0,A.secondaryLabel=void 0,A.contentHeight=0;let C;if(k!=null&&I!=null&&d!=null){const le=k[d];C=this.getLabelText(this.properties.label,{depth:I,datum:k,childrenKey:l,colorKey:c,colorName:p,labelKey:d,secondaryLabelKey:u,sizeKey:f,sizeName:y,value:le})}C===""&&(C=void 0);let w;if(k!=null&&I!=null&&u!=null){const le=k[u];w=this.getLabelText(this.properties.secondaryLabel,{depth:I,datum:k,childrenKey:l,colorKey:c,colorName:p,labelKey:d,secondaryLabelKey:u,sizeKey:f,sizeName:y,value:le})}if(w===""&&(w=void 0),I==null)return;const G=I*S+g,P=(I+1)*S-g,B=G>g?g/G:g,_=P>g?g/P:g,F=N+B,W=L+B-F,K=N+_,U=L+_-K,Z=le=>{if(I===0&&M?.sumSize===E)return{width:2*Math.sqrt(P**2-(le*.5)**2),height:le,meta:0};const ke=le,dt=2*Math.sqrt(P**2-(G+ke)**2),Pt=W<Math.PI?2*G*Math.tan(W*.5):1/0,pi=Math.min(dt,Pt),Vi=Math.PI/4;let hi,xi;return I===0?(hi=le,xi=Math.sqrt(P**2-(hi/2)**2)-le/(2*Math.tan(U*.5))):x_(W)<Vi?(hi=2*G*Math.tan(W*.5),xi=Math.sqrt(P**2-(hi/2)**2)-G):(xi=0,hi=0),pi>=xi?{width:pi,height:ke,meta:1}:{width:xi,height:hi,meta:2}},Q=al(C,this.properties.label,w,this.properties.secondaryLabel,{padding:n},Z);if(Q==null)return;const{width:ee,height:J,meta:j,label:re,secondaryLabel:ce}=Q,X=D+(N+L)/2,Ge=Math.sin(X)>=0,Fe=Math.cos(X)>=0,pe=(Ge?3:12)&(Fe?6:9);let Oe;switch(j){case 0:Oe=0;break;case 1:{const fe=P-(S-J)*.58,ke=Math.sqrt((P-n)**2-(ee/2)**2);Oe=Math.min(fe,ke);break}case 2:if(I===0){const le=J/(2*Math.tan(W*.5))+ee*.5,fe=Math.sqrt(P**2-(J*.5)**2)-ee*.5;Oe=(le+fe)*.5}else Oe=(G+P)*.5;break}if(re!=null){const{fontStyle:le="normal",fontFamily:fe,fontWeight:ke="normal",color:dt="black"}=this.properties.label;A.label={...re,fontStyle:le,fontFamily:fe,fontWeight:ke,color:dt,labelPlacement:j,circleQuarter:pe,radius:Oe,theta:X}}if(ce!=null){const{fontStyle:le="normal",fontFamily:fe,fontWeight:ke="normal",color:dt="black"}=this.properties.secondaryLabel;A.secondaryLabel={...ce,fontStyle:le,fontFamily:fe,fontWeight:ke,color:dt,labelPlacement:j,circleQuarter:pe,radius:Oe,theta:X}}A.contentHeight=Q.height});const v=(A,k,I,N)=>{const{datum:L,datumIndex:M,depth:E,colorValue:C,startAngle:w,endAngle:G}=A;if(E==null){k.visible=!1;return}k.visible=!0;const P=this.getItemStyleOverrides(M,L,E,C,I,N),B=P.fill??I.fill,_=P.strokeWidth??I.strokeWidth,F=Xs.isGradientFill(B)&&B.bounds!=="item"?b:void 0;k_(k,I,P,F),k.centerX=0,k.centerY=0,k.innerRadius=E*S,k.outerRadius=(E+1)*S,k.startAngle=w+D,k.endAngle=G+D,k.inset=g+_*.5,k.cornerRadius=r},R=this.getItemBaseStyle(!1);this.datumSelection.each((A,k)=>{v(k,A,R,!1)});const T=this.getItemBaseStyle(!0);this.highlightSelection.each((A,k)=>{v(k,A,T,!0)});const O=(A,k,I,N)=>{const{depth:L,contentHeight:M}=A,E=I===0,C=E?A.label:A.secondaryLabel;if(L==null||C==null){k.visible=!1;return}const{labelPlacement:w,circleQuarter:G,radius:P,theta:B}=C;let _;switch(N&&(_=(E?this.properties.highlightStyle.label:this.properties.highlightStyle.secondaryLabel).color),k.text=C.text,k.fontSize=C.fontSize,k.lineHeight=C.lineHeight,k.fontStyle=C.fontStyle,k.fontFamily=C.fontFamily,k.fontWeight=C.fontWeight,k.fill=_??C.color,w){case 0:k.textAlign="center",k.textBaseline="top",k.translationX=0,k.translationY=(E?0:M-C.height)-M*.5,k.rotation=0;break;case 1:{const F=(G&3)!==0,V=E===!F?P:P-(M-C.height);k.textAlign="center",k.textBaseline=F?"bottom":"top",k.translationX=Math.cos(B)*V,k.translationY=Math.sin(B)*V,k.rotation=F?B-Math.PI*.5:B+Math.PI*.5;break}case 2:{const F=(G&6)!==0,V=E===!F?(M-C.height)*.5:(C.height-M)*.5;k.textAlign="center",k.textBaseline="middle",k.translationX=Math.cos(B)*P+Math.cos(B+Math.PI/2)*V,k.translationY=Math.sin(B)*P+Math.sin(B+Math.PI/2)*V,k.rotation=F?B:B+Math.PI;break}}k.visible=!0},x=this.ctx.highlightManager?.getActiveHighlight();this.labelSelection.selectByClass(xp).forEach(A=>{const k=A.closestDatum();O(k,A,A.tag,k===x)})}getTooltipContent(e){const{id:t,properties:i}=this,{labelKey:o,secondaryLabelKey:s,childrenKey:a,sizeKey:n,sizeName:r,colorKey:l,colorName:c,tooltip:p}=i,d=e.reduce((v,R)=>v?.children[R],this.rootNode);if(d==null)return;const{datum:u,depth:f}=d;if(u==null||f==null)return;const y=[],g=n!=null?u[n]:void 0;g!=null&&y.push({label:r,fallbackLabel:n,value:g});const m=l!=null?u[l]:void 0;m!=null&&y.push({label:c,fallbackLabel:l,value:m});const S=this.getItemBaseStyle(!1);Object.assign(S,this.getItemStyleOverrides(e,u,f,m,S,!1));const D=S.fill,b=vp({shape:"square",fill:D,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0},i.fillGradientDefaults,i.fillPatternDefaults);return Xs.isGradientFill(b.fill)&&(b.fill={...b.fill,gradient:"linear",rotation:0,reverse:!1}),p.formatTooltip(i,{title:o!=null?u[o]:void 0,symbol:{marker:b},data:y},{seriesId:t,datum:u,title:void 0,depth:f,labelKey:o,secondaryLabelKey:s,childrenKey:a,sizeKey:n,sizeName:r,colorKey:l,colorName:c,...S})}createNodeData(){}pickNodeClosestDatum(e){return this.pickNodeNearestDistantObject(e,this.datumSelection.selectByClass(bp))}animateEmptyUpdateReady(){D_(this.id,"nodes",this.ctx.animationManager,[this.scalingGroup],{toFn(){return{scalingX:1,scalingY:1}},fromFn(){return{scalingX:0,scalingY:0}}})}computeFocusBounds(e){return e}};tr.className="SunburstSeries",tr.type="sunburst";import{_ModuleSupport as N_}from"ag-charts-community";import{arrayOf as Op,callback as A_,color as ir,colorUnion as T_,constant as I_,fillOptionsDef as nS,positiveNumber as or,required as M_,string as mo,strokeOptionsDef as rS}from"ag-charts-core";var{commonSeriesOptionsDefs:L_,autoSizedLabelOptionsDefs:lS,tooltipOptionsDefs:C_,without:cS}=N_,P_={type:M_(I_("sunburst")),labelKey:mo,secondaryLabelKey:mo,childrenKey:mo,sizeKey:mo,colorKey:mo,sizeName:mo,colorName:mo,fills:Op(T_),strokes:Op(ir),colorRange:Op(ir),sectorSpacing:or,cornerRadius:or,padding:or,itemStyler:A_,label:{spacing:or,...lS},secondaryLabel:lS,tooltip:C_,...L_,...cS(nS,["fill"]),...cS(rS,["stroke"]),highlightStyle:{label:{color:ir},secondaryLabel:{color:ir},...nS,...rS}},{FONT_SIZE_RATIO:pS}=iS,HW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"sunburst",moduleFactory:e=>new tr(e),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},colorRange:{$palette:"divergingColors"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:iS.FILL_PATTERN_DEFAULTS,label:{fontFamily:{$ref:"fontFamily"},fontSize:{$rem:[pS.LARGE]},minimumFontSize:{$round:[{$mul:[{$ref:"fontSize"},9/12]}]},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"},overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{fontFamily:{$ref:"fontFamily"},fontSize:{$rem:[pS.SMALLEST]},minimumFontSize:{$round:[{$mul:[{$ref:"fontSize"},7/12]}]},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"},overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlightStyle:{label:{color:{$ref:"backgroundColor"}},secondaryLabel:{color:{$ref:"backgroundColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}},gradientLegend:{enabled:!0}}},hS={type:"series",name:"sunburst",chartType:"hierarchy",enterprise:!0,options:P_,create:e=>new tr(e)};import{_ModuleSupport as dS}from"ag-charts-community";import{_ModuleSupport as Us}from"ag-charts-community";import{isNumberEqual as E_}from"ag-charts-core";import{_ModuleSupport as w_}from"ag-charts-community";var{BaseProperties:sr,HierarchySeriesProperties:__,HighlightStyle:B_,SeriesTooltip:G_,TempValidate:q,BOOLEAN:F_,COLOR_STRING:Jo,FUNCTION:V_,NUMBER:W_,OBJECT:Mt,POSITIVE_NUMBER:ci,RATIO:Bi,STRING:qs,STRING_ARRAY:uS,TEXT_ALIGN:fS,VERTICAL_ALIGN:K_,COLOR_GRADIENT:gS,COLOR_PATTERN:yS,OR:mS,Label:z_}=w_,SS=class extends z_{constructor(){super(...arguments),this.spacing=0}};h([q(W_)],SS.prototype,"spacing",2);var Lt=class extends sr{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new SS}};h([q(mS(gS,Jo,yS),{optional:!0})],Lt.prototype,"fill",2),h([q(Bi)],Lt.prototype,"fillOpacity",2),h([q(Jo,{optional:!0})],Lt.prototype,"stroke",2),h([q(ci)],Lt.prototype,"strokeWidth",2),h([q(Bi)],Lt.prototype,"strokeOpacity",2),h([q(ci)],Lt.prototype,"cornerRadius",2),h([q(fS)],Lt.prototype,"textAlign",2),h([q(ci)],Lt.prototype,"gap",2),h([q(ci)],Lt.prototype,"padding",2),h([q(F_)],Lt.prototype,"interactive",2),h([q(Mt)],Lt.prototype,"label",2);var Dt=class extends sr{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new oi,this.secondaryLabel=new ms}};h([q(mS(gS,Jo,yS),{optional:!0})],Dt.prototype,"fill",2),h([q(Bi)],Dt.prototype,"fillOpacity",2),h([q(Jo,{optional:!0})],Dt.prototype,"stroke",2),h([q(ci,{optional:!0})],Dt.prototype,"strokeWidth",2),h([q(Bi)],Dt.prototype,"strokeOpacity",2),h([q(ci)],Dt.prototype,"cornerRadius",2),h([q(fS)],Dt.prototype,"textAlign",2),h([q(K_)],Dt.prototype,"verticalAlign",2),h([q(ci)],Dt.prototype,"gap",2),h([q(ci)],Dt.prototype,"padding",2),h([q(Mt)],Dt.prototype,"label",2),h([q(Mt)],Dt.prototype,"secondaryLabel",2);var So=class extends sr{constructor(){super(...arguments),this.label=new oi}};h([q(qs,{optional:!0})],So.prototype,"fill",2),h([q(Bi,{optional:!0})],So.prototype,"fillOpacity",2),h([q(Jo,{optional:!0})],So.prototype,"stroke",2),h([q(ci,{optional:!0})],So.prototype,"strokeWidth",2),h([q(Bi,{optional:!0})],So.prototype,"strokeOpacity",2),h([q(Mt)],So.prototype,"label",2);var Gi=class extends sr{constructor(){super(...arguments),this.label=new oi,this.secondaryLabel=new ms}};h([q(qs,{optional:!0})],Gi.prototype,"fill",2),h([q(Bi,{optional:!0})],Gi.prototype,"fillOpacity",2),h([q(Jo,{optional:!0})],Gi.prototype,"stroke",2),h([q(ci,{optional:!0})],Gi.prototype,"strokeWidth",2),h([q(Bi,{optional:!0})],Gi.prototype,"strokeOpacity",2),h([q(Mt)],Gi.prototype,"label",2),h([q(Mt)],Gi.prototype,"secondaryLabel",2);var kp=class extends B_{constructor(){super(...arguments),this.group=new So,this.tile=new Gi}};h([q(Mt)],kp.prototype,"group",2),h([q(Mt)],kp.prototype,"tile",2);var ti=class extends __{constructor(){super(...arguments),this.highlightStyle=new kp,this.tooltip=new G_,this.group=new Lt,this.tile=new Dt,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}};h([q(qs,{optional:!0})],ti.prototype,"sizeName",2),h([q(qs,{optional:!0})],ti.prototype,"labelKey",2),h([q(qs,{optional:!0})],ti.prototype,"secondaryLabelKey",2),h([q(V_,{optional:!0})],ti.prototype,"itemStyler",2),h([q(Mt)],ti.prototype,"highlightStyle",2),h([q(Mt)],ti.prototype,"tooltip",2),h([q(Mt)],ti.prototype,"group",2),h([q(Mt)],ti.prototype,"tile",2),h([q(uS)],ti.prototype,"undocumentedGroupFills",2),h([q(uS)],ti.prototype,"undocumentedGroupStrokes",2);var{TextUtils:$_,TextWrapper:H_,createDatumId:bS,Rect:DS,Group:xS,BBox:Zo,Selection:Rp,Text:ar,Transformable:Y_,applyShapeStyle:X_,getShapeStyle:js}=Us,U_=class extends Us.HierarchyNode{constructor(){super(...arguments),this.labelValue=void 0,this.secondaryLabelValue=void 0,this.label=void 0,this.secondaryLabel=void 0,this.bbox=void 0,this.padding=void 0}},vS=new ar;function q_(e,t){const{fontStyle:i,fontWeight:o,fontSize:s,fontFamily:a}=t;vS.setProperties({text:e,fontStyle:i,fontWeight:o,fontSize:s,fontFamily:a,textAlign:"left",textBaseline:"top"});const{width:n,height:r}=vS.getBBox();return{width:n,height:r}}function Fi(e){return e.children.length>0?e.sumSize-e.sizeValue:e.sizeValue}var OS={left:0,center:.5,right:1},j_={top:0,middle:.5,bottom:1},jW=class extends Us.Group{distanceSquared(e,t){return this.getBBox().distanceSquared(e,t)}},nr=class extends Us.HierarchySeries{constructor(){super(...arguments),this.NodeClass=U_,this.properties=new ti,this.rectGroup=this.contentGroup.appendChild(new xS),this.datumSelection=Rp.select(this.rectGroup,DS),this.labelSelection=Rp.select(this.labelGroup,xS),this.highlightSelection=Rp.select(this.rectGroup,DS)}groupTitleHeight(e,t){const{labelValue:i}=e,{label:o}=this.properties.group,s=3;if(i!=null){if(o.fontSize>t.width/s||o.fontSize>t.height/s)return;{const{height:a}=q_(i,o);return Math.max(a,o.fontSize)}}}getNodePadding(e,t){if(e.parent==null)return{top:0,right:0,bottom:0,left:0};if(e.children.length===0){const{padding:n}=this.properties.tile;return{top:n,right:n,bottom:n,left:n}}const{label:{spacing:i},padding:o}=this.properties.group,s=this.groupTitleHeight(e,t),a=s!=null?s+i:0;return{top:o+a,right:o,bottom:o,left:o}}sortChildren({children:e}){const t=Array.from(e,(o,s)=>s).filter(o=>Fi(e[o])>0).sort((o,s)=>Fi(e[s])-Fi(e[o]));return{sortedChildrenIndices:t,childAt:o=>{const s=t[o];return e[s]}}}squarify(e,t){const{datum:i,children:o}=e;if(t.width<=0||t.height<=0){e.bbox=void 0,e.padding=void 0,e.midPoint.x=NaN,e.midPoint.y=NaN;return}const s=i!=null?this.getNodePadding(e,t):{top:0,right:0,bottom:0,left:0};e.parent==null?(e.bbox=void 0,e.padding=void 0,e.midPoint.x=NaN,e.midPoint.y=NaN):(e.bbox=t,e.padding=s,e.midPoint.x=t.x+t.width/2,e.midPoint.y=t.y);const{sortedChildrenIndices:a,childAt:n}=this.sortChildren(e),r=a.every(R=>o[R].children.length===0),l=1,c=t.width-s.left-s.right,p=t.height-s.top-s.bottom;if(c<=0||p<=0)return;const d=a.length;let u=0,f=0,y=1/0,g=a.reduce((R,T)=>R+Fi(o[T]),0);const m=new Zo(t.x+s.left,t.y+s.top,c,p),S=m.clone();let D=0;for(;D<d;){const R=Fi(n(D)),T=Fi(n(f)),O=S.width<S.height;u+=R;const x=O?S.height:S.width,A=O?S.width:S.height,k=A*T/u;let I=x*u/g;const N=Math.max(k,I)/Math.min(k,I),L=Math.abs(l-N);if(L<y){y=L,D++;continue}u-=R,I=x*u/g;let M=O?S.x:S.y;for(let E=f;E<D;E++){const C=n(E),w=Fi(C),G=O?M:S.x,P=O?S.y:M,B=A*w/u,_=O?B:I,F=O?I:B,V=new Zo(G,P,_,F);this.applyGap(m,V,r),this.squarify(C,V),g-=w,M+=B}O?(S.y+=I,S.height-=I):(S.x+=I,S.width-=I),f=D,u=0,y=1/0}const b=S.width<S.height;let v=b?S.x:S.y;for(let R=f;R<d;R++){const T=n(R),O=b?v:S.x,x=b?S.y:v,A=Fi(T)/g,k=S.width*(b?A:1),I=S.height*(b?1:A),N=new Zo(O,x,k,I);this.applyGap(m,N,r),this.squarify(T,N),v+=b?k:I}}applyGap(e,t,i){const o=i?this.properties.tile.gap*.5:this.properties.group.gap*.5,s=l=>({left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height}),a=s(e),n=s(t);["top","right","bottom","left"].forEach(l=>{E_(a[l],n[l])||t.shrink(o,l)})}createNodeData(){}getGroupBaseStyle(e){const{properties:t}=this,{group:i}=t,o=e?t.highlightStyle.group:void 0;return js({fill:o?.fill??i.fill,fillOpacity:o?.fillOpacity??i.fillOpacity,stroke:o?.stroke??i.stroke,strokeWidth:o?.strokeWidth??i.strokeWidth,strokeOpacity:o?.strokeOpacity??i.strokeOpacity},t.fillGradientDefaults,t.fillPatternDefaults)}getGroupStyleOverrides(e,t,i,o,s){const{id:a,properties:n}=this,{undocumentedGroupFills:r,undocumentedGroupStrokes:l,itemStyler:c}=n,p=o.fill??r[Math.min(i??0,r.length)],d=o.stroke??l[Math.min(i??0,l.length)],u={};if(s||(u.fill=p,u.stroke=d),c!=null){const f=this.cachedDatumCallback(bS(e.join(":"),s?"highlight":"node"),()=>this.callWithContext(c,{seriesId:a,datum:t,depth:i,highlighted:s,fill:p,stroke:d,...o}));Object.assign(u,f)}return js(u,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}getTileBaseStyle(e){const{properties:t}=this,{tile:i}=t,o=e?t.highlightStyle.tile:void 0;return js({fill:o?.fill??i.fill,fillOpacity:o?.fillOpacity??i.fillOpacity,stroke:o?.stroke??i.stroke,strokeWidth:o?.strokeWidth??i.strokeWidth,strokeOpacity:o?.strokeOpacity??i.strokeOpacity},t.fillGradientDefaults,t.fillPatternDefaults)}getTileStyleOverrides(e,t,i,o,s,a){const{id:n,properties:r,colorScale:l}=this,{fills:c,strokes:p,itemStyler:d}=r,u=e[0],f=s.fill??c[u%c.length],y=s.stroke??p[u%p.length],g={};if(a||(g.fill=o!=null?l.convert(o):f,g.stroke=y),d!=null){const m=this.cachedDatumCallback(bS(e.join(":"),a?"highlight":"node"),()=>this.callWithContext(d,{seriesId:n,datum:t,depth:i,highlighted:a,fill:f,stroke:y,...s}));Object.assign(g,m)}return js(g,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults)}updateSelections(){let e=this.ctx.highlightManager?.getActiveHighlight();if(e!=null&&!this.properties.group.interactive&&e.children.length!==0&&(e=void 0),this.highlightSelection.update(e!=null?[e]:[],void 0,s=>this.getDatumId(s)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{seriesRect:t}=this.chart??{};if(!t)return;const i=Array.from(this.rootNode),o=s=>{s.append([new ar({tag:0}),new ar({tag:1})])};this.datumSelection.update(i,void 0,s=>this.getDatumId(s)),this.labelSelection.update(i,o,s=>this.getDatumId(s))}updateNodes(){const{rootNode:e,data:t}=this,{childrenKey:i,colorKey:o,colorName:s,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l,highlightStyle:c,tile:p,group:d}=this.properties,{seriesRect:u}=this.chart??{};if(!u||!t)return;this.rootNode?.walk(O=>{const{datum:x,depth:A,children:k}=O,I=k.length===0,N=I?p.label:d.label;let L;if(x!=null&&A!=null&&a!=null){const E=x[a];L=this.getLabelText(N,{depth:A,datum:x,childrenKey:i,colorKey:o,colorName:s,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l,value:E})}L===""&&(L=void 0);let M;if(I&&x!=null&&A!=null&&n!=null){const E=x[n];M=this.getLabelText(p.secondaryLabel,{depth:A,datum:x,childrenKey:i,colorKey:o,colorName:s,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l,value:E})}M===""&&(M=void 0),O.labelValue=L,O.secondaryLabelValue=M});const{width:f,height:y}=u;this.squarify(e,new Zo(0,0,f,y)),this.rootNode?.walk(O=>{const{bbox:x,children:A,labelValue:k,secondaryLabelValue:I}=O;if(O.label=void 0,O.secondaryLabel=void 0,x!=null)if(A.length===0){const N={width:x.width,height:x.height,meta:null},L=al(k,this.properties.tile.label,I,this.properties.tile.secondaryLabel,{padding:p.padding},()=>N);if(L==null)return;const{height:M,label:E,secondaryLabel:C}=L,{textAlign:w,verticalAlign:G,padding:P}=p,B=OS[w]??.5,_=x.x+P+(x.width-2*P)*B,F=j_[G]??.5,V=x.y+P+M*.5+(x.height-2*P-M)*F;if(E!=null){const{fontStyle:W="normal",fontFamily:K,fontWeight:$="normal",color:U="black"}=this.properties.tile.label;O.label={text:E.text,fontSize:E.fontSize,lineHeight:E.lineHeight,fontStyle:W,fontFamily:K,fontWeight:$,color:U,textAlign:w,verticalAlign:"middle",x:_,y:V-(M-E.height)*.5}}if(C!=null){const{fontStyle:W="normal",fontFamily:K,fontWeight:$="normal",color:U="black"}=this.properties.tile.secondaryLabel;O.secondaryLabel={text:C.text,fontSize:C.fontSize,lineHeight:C.fontSize,fontStyle:W,fontFamily:K,fontWeight:$,color:U,textAlign:w,verticalAlign:"middle",x:_,y:V+(M-C.height)*.5}}}else{if(k==null)return;{const{padding:N,textAlign:L}=d,M=this.groupTitleHeight(O,x);if(M==null)return;const E=x.width-2*N,C=H_.wrapText(k,{maxWidth:x.width-2*N,font:d.label,textWrap:"never"}),w=OS[L]??.5,{fontStyle:G="normal",fontFamily:P,fontWeight:B="normal",color:_="black"}=this.properties.group.label;O.label={text:C,fontSize:d.label.fontSize,lineHeight:$_.getLineHeight(d.label.fontSize),fontStyle:G,fontFamily:P,fontWeight:B,color:_,textAlign:L,verticalAlign:"middle",x:x.x+N+E*w,y:x.y+N+M*.5}}}});const g={series:new Zo(0,0,f,y),axis:new Zo(0,0,f,y)},m=(O,x,A,k,I)=>{const{bbox:N}=O;if(N==null){x.visible=!1;return}const{datum:L,depth:M=-1,datumIndex:E,colorValue:C}=O,w=O.children.length===0,G=w?k:A,P=w?this.getTileStyleOverrides(E,L,M,C,G,I):this.getGroupStyleOverrides(E,L,M,G,I);x.crisp=!0,X_(x,G,P,g),x.cornerRadius=w?p.cornerRadius:d.cornerRadius,x.zIndex=[0,M,I?1:0];const B=O.parent?.children.every(V=>V.children.length===0),_=O.parent!=null?O.parent.bbox:void 0,F=O.parent!=null?O.parent.padding:void 0;B===!0&&_!=null&&F!=null?(x.clipBBox=N,x.x=_.x+F.left,x.y=_.y+F.top,x.width=_.width-(F.left+F.right),x.height=_.height-(F.top+F.bottom)):(x.clipBBox=void 0,x.x=N.x,x.y=N.y,x.width=N.width,x.height=N.height),x.visible=!0},S=this.getGroupBaseStyle(!1),D=this.getTileBaseStyle(!1);this.datumSelection.each((O,x)=>m(x,O,S,D,!1));const b=this.getGroupBaseStyle(!0),v=this.getTileBaseStyle(!0);this.highlightSelection.each((O,x)=>{m(x,O,b,v,!0)});const R=(O,x,A,k)=>{const I=O.children.length===0,N=A===0?O.label:O.secondaryLabel;if(N==null){x.visible=!1;return}let L;if(k){const{tile:M,group:E}=c;L=M.secondaryLabel.color,I?A===0&&(L=M.label.color):L=E.label.color}x.text=N.text,x.fontSize=N.fontSize,x.lineHeight=N.lineHeight,x.fontStyle=N.fontStyle,x.fontFamily=N.fontFamily,x.fontWeight=N.fontWeight,x.fill=L??N.color,x.textAlign=N.textAlign,x.textBaseline=N.verticalAlign,x.x=N.x,x.y=N.y,x.visible=!0,x.zIndex=1},T=this.ctx.highlightManager?.getActiveHighlight();this.labelSelection.selectByClass(ar).forEach(O=>{const x=O.closestDatum();R(x,O,O.tag,x===T)})}pickNodesExactShape(e){const t=super.pickNodesExactShape(e);return t.sort((i,o)=>o.datumIndex.length-i.datumIndex.length),t}pickNodeClosestDatum(e){const t=this.pickNodesExactShape(e);return t.length!==0?{datum:t[0],distance:0}:this.pickNodeNearestDistantObject(e,this.datumSelection.nodes())}getTooltipContent(e){const{id:t,properties:i}=this,{labelKey:o,secondaryLabelKey:s,childrenKey:a,sizeKey:n,sizeName:r,colorKey:l,colorName:c,tooltip:p}=i,d=e.reduce((O,x)=>O?.children[x],this.rootNode);if(d==null)return;const{datum:u,depth:f,children:y}=d;if(u==null||f==null)return;const g=y.length===0,m=[],S=n!=null?u[n]:void 0;S!=null&&m.push({label:r,fallbackLabel:n,value:S});const D=l!=null?u[l]:void 0;D!=null&&m.push({label:c,fallbackLabel:l,value:D});let b;g?(b=this.getTileBaseStyle(!1),Object.assign(b,this.getTileStyleOverrides(e,u,f,D,b,!1))):(b=this.getGroupBaseStyle(!1),Object.assign(b,this.getGroupStyleOverrides(e,u,f,b,!1)));const v=b.fill,R=js({shape:"square",fill:v,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults);Us.isGradientFill(R.fill)&&(R.fill={...R.fill,gradient:"linear",rotation:0,reverse:!1});const T=g?{marker:R}:void 0;return p.formatTooltip(this.properties,{title:o!=null?u[o]:void 0,symbol:T,data:m},{seriesId:t,datum:u,title:void 0,depth:f,labelKey:o,secondaryLabelKey:s,childrenKey:a,sizeKey:n,sizeName:r,colorKey:l,colorName:c,...b})}computeFocusBounds(e){return Y_.toCanvas(this.contentGroup,e.getBBox())}};nr.className="TreemapSeries",nr.type="treemap";import{_ModuleSupport as J_}from"ag-charts-community";import{arrayOf as Js,boolean as Z_,callback as Q_,color as bo,colorUnion as eB,constant as tB,fillGradientDefaults as iB,fillOptionsDef as rr,fillPatternDefaults as oB,positiveNumber as Ct,required as sB,string as Do,strokeOptionsDef as lr,union as xo}from"ag-charts-core";var{commonSeriesOptionsDefs:aB,seriesLabelOptionsDefs:Np,tooltipOptionsDefs:nB}=J_,Zs={type:sB(tB("treemap")),labelKey:Do,secondaryLabelKey:Do,childrenKey:Do,sizeKey:Do,colorKey:Do,sizeName:Do,colorName:Do,fills:Js(eB),strokes:Js(bo),colorRange:Js(bo),itemStyler:Q_,group:{gap:Ct,padding:Ct,cornerRadius:Ct,textAlign:xo("left","center","right"),interactive:Z_,label:{...Np,spacing:Ct},...rr,...lr},tile:{gap:Ct,padding:Ct,cornerRadius:Ct,textAlign:xo("left","center","right"),verticalAlign:xo("top","middle","bottom"),label:{...Np,spacing:Ct,lineHeight:Ct,minimumFontSize:Ct,wrapping:xo("never","always","hyphenate","on-space"),overflowStrategy:xo("ellipsis","hide")},secondaryLabel:{...Np,lineHeight:Ct,minimumFontSize:Ct,wrapping:xo("never","always","hyphenate","on-space"),overflowStrategy:xo("ellipsis","hide")},...rr,...lr},tooltip:nB,...aB,highlightStyle:{group:{label:{color:bo},...rr,...lr},tile:{label:{color:bo},secondaryLabel:{color:bo},...rr,...lr}}};Zs.fillGradientDefaults=iB,Zs.fillPatternDefaults=oB,Zs.undocumentedGroupFills=Js(bo),Zs.undocumentedGroupStrokes=Js(bo);var{FONT_SIZE_RATIO:kS}=dS,QW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"treemap",moduleFactory:e=>new nr(e),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},colorRange:{$palette:"divergingColors"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:dS.FILL_PATTERN_DEFAULTS,undocumentedGroupFills:{$palette:"hierarchyColors"},undocumentedGroupStrokes:{$palette:"secondHierarchyColors"},group:{label:{enabled:!0,color:{$ref:"textColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left"},tile:{label:{enabled:!0,color:{$ref:"backgroundColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.5]},minimumFontSize:{$rem:[kS.SMALLER]},fontFamily:{$ref:"fontFamily"},wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{enabled:!0,color:{$ref:"backgroundColor"},fontStyle:void 0,fontWeight:void 0,fontSize:{$ref:"fontSize"},minimumFontSize:{$rem:[kS.SMALLER]},fontFamily:{$ref:"fontFamily"},wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:0,padding:3,gap:1},highlightStyle:{group:{label:{color:{$ref:"textColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2},tile:{label:{color:{$ref:"backgroundColor"}},secondaryLabel:{color:{$ref:"backgroundColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},gradientLegend:{enabled:!0}}},RS={type:"series",name:"treemap",chartType:"hierarchy",enterprise:!0,options:Zs,create:e=>new nr(e)},rB=wS.ModuleRegistry,NS=[ch,Fr,ol,af,Rf,ll,pl,Sl,Ol,Pl],AS=[ph,hh,dh,uh,my,Hy,Xy,am,fm],TS=[fh,Bu,tS],IS=[gh,Qf,Pm],MS=[yh,hS,RS],LS=[mh,Py],CS=[Rh,mg,bg,wg,jg,ey],lB=[...NS,...AS,...TS,...IS,...MS,...LS,...CS,JN,ZN,QN];export{NS as AllCartesianEnterpriseModules,lB as AllEnterpriseModules,TS as AllFlowProportionEnterpriseModules,IS as AllGaugeEnterpriseModules,MS as AllHierarchyEnterpriseModules,AS as AllPolarEnterpriseModules,LS as AllStandaloneEnterpriseModules,CS as AllTopologyEnterpriseModules,hh as AngleCategoryAxisModule,ph as AngleNumberAxisModule,Fr as BoxPlotSeriesModule,ol as CandlestickSeriesModule,Bu as ChordSeriesModule,af as ConeFunnelSeriesModule,fh as FlowProportionChartModule,Rf as FunnelSeriesModule,gh as GaugeChartModule,ll as HeatmapSeriesModule,yh as HierarchyChartModule,Qf as LinearGaugeSeriesModule,bg as MapLineBackgroundSeriesModule,mg as MapLineSeriesModule,wg as MapMarkerSeriesModule,ey as MapShapeBackgroundSeriesModule,jg as MapShapeSeriesModule,rB as ModuleRegistry,my as NightingaleSeriesModule,pl as OhlcSeriesModule,ch as OrdinalTimeAxisModule,Py as PyramidSeriesModule,Hy as RadarAreaSeriesModule,Xy as RadarLineSeriesModule,am as RadialBarSeriesModule,fm as RadialColumnSeriesModule,Pm as RadialGaugeSeriesModule,uh as RadiusCategoryAxisModule,dh as RadiusNumberAxisModule,Sl as RangeAreaSeriesModule,Ol as RangeBarSeriesModule,tS as SankeySeriesModule,mh as StandaloneChartModule,hS as SunburstSeriesModule,Rh as TopologyChartModule,RS as TreemapSeriesModule,Pl as WaterfallSeriesModule};
